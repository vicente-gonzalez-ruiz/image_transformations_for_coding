<!DOCTYPE html> 
<html> 
<head> <title>Image transformations for compression</title> 
<meta charset="UTF-8" /> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<link rel="stylesheet" type="text/css" href="index.css" /> 
<script type="text/javascript" 
src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" 
></script> 
<style type="text/css"> 
.MathJax_MathML {text-indent: 0;} 
</style> 
</head><body 
>
   <div class="maketitle">
                                                                  

                                                                  
                                                                  

                                                                  

<h2 class="titleHead">Image transformations for compression</h2>
 <div class="author" ><span 
class="ecrm-1200">Vicente Gonz</span><span 
class="ecrm-1200">á</span><span 
class="ecrm-1200">lez Ruiz</span></div><br />
<div class="date" ><span 
class="ecrm-1200">January 2, 2020</span></div>
   </div>
   <h3 class="likesectionHead"><a 
 id="x1-1000"></a>Contents</h3>
   <div class="tableofcontents">
   <span class="sectionToc" >1 <a 
href="#x1-20001" id="QQ2-1-2">Insights</a></span>
<br />   <span class="sectionToc" >2 <a 
href="#x1-30002" id="QQ2-1-3">Basic coding steps</a></span>
<br />    <span class="subsectionToc" >2.1 <a 
href="#x1-40002.1" id="QQ2-1-4">Encoder</a></span>
<br />    <span class="subsectionToc" >2.2 <a 
href="#x1-50002.2" id="QQ2-1-5">Decoder</a></span>
<br />   <span class="sectionToc" >3 <a 
href="#x1-60003" id="QQ2-1-6">Splitting</a></span>
<br />   <span class="sectionToc" >4 <a 
href="#x1-70004" id="QQ2-1-7">Transform of a block</a></span>
<br />   <span class="sectionToc" >5 <a 
href="#x1-80005" id="QQ2-1-8">A color transform</a></span>
<br />    <span class="subsectionToc" >5.1 <a 
href="#x1-90005.1" id="QQ2-1-9">Luminance and chrominance</a></span>
<br />    <span class="subsectionToc" >5.2 <a 
href="#x1-100005.2" id="QQ2-1-10">Spectral (color) redundancy</a></span>
<br />   <span class="sectionToc" >6 <a 
href="#x1-110006" id="QQ2-1-11">Chrominance subsampling</a></span>
<br />   <span class="sectionToc" >7 <a 
href="#x1-120007" id="QQ2-1-12">Orthogonal transform</a></span>
<br />    <span class="subsectionToc" >7.1 <a 
href="#x1-130007.1" id="QQ2-1-13">Orthonormal transform</a></span>
<br />   <span class="sectionToc" >8 <a 
href="#x1-140008" id="QQ2-1-14">Signal energy</a></span>
<br />    <span class="subsectionToc" >8.1 <a 
href="#x1-150008.1" id="QQ2-1-15">Energy conservation</a></span>
<br />    <span class="subsectionToc" >8.2 <a 
href="#x1-160008.2" id="QQ2-1-16">Proof</a></span>
<br />   <span class="sectionToc" >9 <a 
href="#x1-170009" id="QQ2-1-17">Expected value</a></span>
<br />   <span class="sectionToc" >10 <a 
href="#x1-1800010" id="QQ2-1-18">Variance</a></span>
<br />    <span class="subsectionToc" >10.1 <a 
href="#x1-1900010.1" id="QQ2-1-19">Covariance</a></span>
<br />   <span class="sectionToc" >11 <a 
href="#x1-2000011" id="QQ2-1-20">Covariance matrix</a></span>
<br />   <span class="sectionToc" >12 <a 
href="#x1-2100012" id="QQ2-1-21">Covariance matrix of a block-based transform</a></span>
<br />   <span class="sectionToc" >13 <a 
href="#x1-2200013" id="QQ2-1-22">Correlation</a></span>
<br />   <span class="sectionToc" >14 <a 
href="#x1-2300014" id="QQ2-1-23">Autocorrelation</a></span>
<br />   <span class="sectionToc" >15 <a 
href="#x1-2400015" id="QQ2-1-24">Autocorrelation matrix</a></span>
<br />   <span class="sectionToc" >16 <a 
href="#x1-2500016" id="QQ2-1-25">Eigenvalue and eigenvector</a></span>
<br />   <span class="sectionToc" >17 <a 
href="#x1-2600017" id="QQ2-1-26">Coding gain</a></span>
                                                                  

                                                                  
<br />   <span class="sectionToc" >18 <a 
href="#x1-2700018" id="QQ2-1-27">Karhunen-Loéve transform (KLT)</a></span>
<br />   <span class="sectionToc" >19 <a 
href="#x1-2800019" id="QQ2-1-28">Discrete cosine transform (DCT))</a></span>
<br />     <span class="subsubsectionToc" >19.0.1 <a 
href="#x1-2900019.0.1" id="QQ2-1-29">Deﬁnition</a></span>
<br />    <span class="subsectionToc" >19.1 <a 
href="#x1-3000019.1" id="QQ2-1-30">Properties fo DCT</a></span>
<br />   <span class="sectionToc" >20 <a 
href="#x1-3100020" id="QQ2-1-31">Dyadic discrete wavelet transform (DWT)</a></span>
<br />   <span class="sectionToc" >21 <a 
href="#x1-3200021" id="QQ2-1-32">Filters bank implementation</a></span>
<br />   <span class="sectionToc" >22 <a 
href="#x1-3300022" id="QQ2-1-33">Lifting implementation [6]</a></span>
<br />   <span class="sectionToc" >23 <a 
href="#x1-3400023" id="QQ2-1-34"><!--l. 35--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>T</mi></math>-levels
1D-DWT</a></span>
<br />   <span class="sectionToc" >24 <a 
href="#x1-3500024" id="QQ2-1-35">2D-DWT</a></span>
<br />   <span class="sectionToc" >25 <a 
href="#x1-3600025" id="QQ2-1-36">Haar ﬁlters [3]</a></span>
<br />   <span class="sectionToc" >26 <a 
href="#x1-3700026" id="QQ2-1-37">Linear (5/3) ﬁlters [6]</a></span>
<br />   <span class="sectionToc" >27 <a 
href="#x1-3800027" id="QQ2-1-38">Quantization in the transform domain</a></span>
<br />   <span class="sectionToc" >28 <a 
href="#x1-3900028" id="QQ2-1-39">Bit-planes progression</a></span>
<br />    <span class="subsectionToc" >28.1 <a 
href="#x1-4000028.1" id="QQ2-1-40">Bit allocation (bit-rate control)</a></span>
<br />   <span class="sectionToc" >29 <a 
href="#x1-4100029" id="QQ2-1-41">Bit allocation based on minimizing the quantization error</a></span>
<br />   <span class="sectionToc" >30 <a 
href="#x1-4200030" id="QQ2-1-42">Bit allocation based on minimizing the variance of the quantization error</a></span>
<br />   <span class="sectionToc" >31 <a 
href="#x1-4300031" id="QQ2-1-43">Encoding</a></span>
<br />   <span class="sectionToc" >32 <a 
href="#x1-4400032" id="QQ2-1-44">Code-stream orderings and scalabilities</a></span>
<br />   <span class="sectionToc" ><a 
href="#Q1-1-46">References</a></span>
   </div>
<!--l. 8--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">1   </span> <a 
 id="x1-20001"></a>Insights</h3>
     <ul class="itemize1">
     <li class="itemize">Signals can be represented at least in two diﬀerent domains: the signal
     domain (for example, time in the case of sound of space in the case of
     image) and the frequency domain (in general, in a transform domain).
     </li>
     <li class="itemize">Transform coding is based on the idea that, in the transform domain,
     most of the energy of the signal can be compacted in a small number of
     (transform) coeﬃcients.
     </li>
     <li class="itemize">This property can be interesting for increasing the coding eﬃciency.</li></ul>
<!--l. 23--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">2   </span> <a 
 id="x1-30002"></a>Basic coding steps</h3>
                                                                  

                                                                  
<!--l. 24--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.1   </span> <a 
 id="x1-40002.1"></a>Encoder</h4>
<!--l. 25--><p class="noindent" >
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-4002x1">Split <!--l. 28--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>s</mi></mrow></math>
     into blocks of <!--l. 28--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>B</mi></mrow></math>
     samples, if required.
     </li>
     <li 
  class="enumerate" id="x1-4004x2">Transform each block.
     </li>
     <li 
  class="enumerate" id="x1-4006x3">(Optional) Quantize the coeﬃcients.
     </li>
     <li 
  class="enumerate" id="x1-4008x4">Lossless   encode   the   quantized   coeﬃcients,   performing   a   minimal
     bit-allocation.</li></ol>
<!--l. 38--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.2   </span> <a 
 id="x1-50002.2"></a>Decoder</h4>
<!--l. 39--><p class="noindent" >
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-5002x1">Decode the coeﬃcients of each block.
     </li>
     <li 
  class="enumerate" id="x1-5004x2">(Optional) “Dequantize” the coeﬃcients of each block.
     </li>
     <li 
  class="enumerate" id="x1-5006x3">Inverse-transform each block.
     </li>
     <li 
  class="enumerate" id="x1-5008x4">Join the blocks, if required.</li></ol>
<!--l. 51--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">3   </span> <a 
 id="x1-60003"></a>Splitting</h3>
<!--l. 52--><p class="noindent" >
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-6002x1">Divide <!--l. 55--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>s</mi> <mo 
class="MathClass-rel">=</mo> <msubsup><mrow 
><mrow ><mo 
class="MathClass-open">{</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">}</mo></mrow></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>N</mi><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></msubsup 
></mrow></math>
     into <!--l. 55--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mrow ><mo 
class="MathClass-open">⌈</mo><mrow><mi 
>N</mi><mo 
class="MathClass-bin">∕</mo><mi 
>B</mi></mrow><mo 
class="MathClass-close">⌉</mo></mrow></mrow></math>
     blocks <!--l. 56--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mrow ><mo 
class="MathClass-open">{</mo><mrow><msub><mrow 
><mi 
>c</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-rel">⋯</mo><mspace width="0.3em" class="thinspace"/><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>c</mi></mrow><mrow 
><mrow ><mo 
class="MathClass-open">⌈</mo><mrow><mi 
>N</mi><mo 
class="MathClass-bin">∕</mo><mi 
>B</mi></mrow><mo 
class="MathClass-close">⌉</mo></mrow></mrow></msub 
></mrow><mo 
class="MathClass-close">}</mo></mrow></mrow></math>
     of <!--l. 56--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>B</mi></mrow></math>
     samples.</li></ol>
                                                                  

                                                                  
<!--l. 59--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">4   </span> <a 
 id="x1-70004"></a>Transform of a block</h3>
     <ul class="itemize1">
     <li class="itemize">In the forward transform the samples of the block are correlated with (the
     block is compared to) a set of basis functions
     <table class="equation"><tr><td> <a 
 id="x1-7001r1"></a>
     <!--l. 65--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                              <msubsup><mrow 
><mrow ><mo 
class="MathClass-open">{</mo><mrow><msub><mrow 
><mi 
>C</mi></mrow><mrow 
><mi 
>u</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">}</mo></mrow></mrow><mrow 
><mi 
>u</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>B</mi><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></msubsup 
> <mo 
class="MathClass-rel">=</mo><munderover accentunder="false" accent="false"><mrow  
><mo mathsize="big" 
> ∑</mo>
  </mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>B</mi><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></munderover 
><msub><mrow 
><mi 
>a</mi></mrow><mrow 
>
<mi 
>u</mi><mo 
class="MathClass-punc">,</mo><mi 
>n</mi></mrow></msub 
><msub><mrow 
><mi 
>c</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo>
                                                                                        <mstyle 
   id="x1-7002r0"  class="label" ></mstyle><!--endlabel-->
</math></td><td class="eq-no">(forward_transform)<a 
 id="x1-7003r0"></a></td></tr></table>
     </li>
     <li class="itemize">The backward (inverse) transform restores the original samples
     <table class="equation"><tr><td> <a 
 id="x1-7004r1"></a>
     <!--l. 72--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                              <msubsup><mrow 
><mrow ><mo 
class="MathClass-open">{</mo><mrow><msub><mrow 
><mi 
>c</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">}</mo></mrow></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>B</mi><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></msubsup 
> <mo 
class="MathClass-rel">=</mo><munderover accentunder="false" accent="false"><mrow  
><mo mathsize="big" 
> ∑</mo>
  </mrow><mrow 
><mi 
>u</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>B</mi><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></munderover 
><msub><mrow 
><mi 
>b</mi></mrow><mrow 
>
<mi 
>n</mi><mo 
class="MathClass-punc">,</mo><mi 
>u</mi></mrow></msub 
><msub><mrow 
><mi 
>C</mi></mrow><mrow 
><mi 
>u</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo>
                                                                                        <mstyle 
   id="x1-7005r0"  class="label" ></mstyle><!--endlabel-->
</math></td><td class="eq-no">(inverse_transform)<a 
 id="x1-7006r0"></a></td></tr></table>
     </li>
     <li class="itemize">These equations can be written in matrix form as
     <table class="equation"><tr><td> <a 
 id="x1-7007r1"></a>
                                                                  

                                                                  
     <!--l. 79--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                               <mi 
>C</mi> <mo 
class="MathClass-rel">=</mo> <mi 
>A</mi><mi 
>c</mi>
                                                                                        <mstyle 
   id="x1-7008r0"  class="label" ></mstyle><!--endlabel-->
</math></td><td class="eq-no">(forward_transform_matrix_form)<a 
 id="x1-7009r0"></a></td></tr></table>
     <table class="equation"><tr><td> <a 
 id="x1-7010r1"></a>
     <!--l. 84--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                              <mi 
>c</mi> <mo 
class="MathClass-rel">=</mo> <mi 
>B</mi><mi 
>C</mi><mo 
class="MathClass-punc">,</mo>
                                                                                        <mstyle 
   id="x1-7011r0"  class="label" ></mstyle><!--endlabel-->
</math></td><td class="eq-no">(inverse_transform_matrix_form)<a 
 id="x1-7012r0"></a></td></tr></table>
     <!--l. 89--><p class="noindent" >where <!--l. 89--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>A</mi></mrow></math>
     and <!--l. 89--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>B</mi></mrow></math>
     are matrices, being </p><table class="equation"><tr><td> <a 
 id="x1-7013r1"></a>
     <!--l. 90--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
 <mtable  align="axis" style=""  
equalrows="false" equalcolumns="false" class="array"> <mtr><mtd 
class="array"  columnalign="left">  <msub><mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>A</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mrow 
><mi 
>u</mi><mo 
class="MathClass-punc">,</mo><mi 
>n</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>a</mi></mrow><mrow 
><mi 
>u</mi><mo 
class="MathClass-punc">,</mo><mi 
>n</mi></mrow></msub 
>  </mtd>
</mtr>  <mtr><mtd 
class="array"  columnalign="left">  <msub><mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>B</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-punc">,</mo><mi 
>u</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-punc">,</mo><mi 
>u</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo> </mtd></mtr><!--l--></mtable>
</math></td><td class="eq-no">(1)</td></tr></table>
     </li>
     <li class="itemize">In transform coding, <!--l. 98--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>A</mi></mrow></math>
     and <!--l. 98--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>B</mi></mrow></math> must be inverses
     of each other (<!--l. 99--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>B</mi> <mo 
class="MathClass-rel">=</mo> <msup><mrow 
><mi 
>A</mi></mrow><mrow 
><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></msup 
></mrow></math>),
     i.e.
     <table class="equation"><tr><td> <a 
 id="x1-7014r2"></a>
                                                                  

                                                                  
     <!--l. 101--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                          <mi 
>A</mi><mi 
>B</mi> <mo 
class="MathClass-rel">=</mo> <mi 
>B</mi><mi 
>A</mi> <mo 
class="MathClass-rel">=</mo> <mi 
>I</mi><mo 
class="MathClass-punc">,</mo>
</math></td><td class="eq-no">(2)</td></tr></table>
     <!--l. 105--><p class="noindent" >where <!--l. 105--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>I</mi></mrow></math>
     is the identity matrix.</p></li></ul>
<!--l. 108--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">5   </span> <a 
 id="x1-80005"></a>A color transform</h3>
<!--l. 109--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.1   </span> <a 
 id="x1-90005.1"></a>Luminance and chrominance</h4>
     <ul class="itemize1">
     <li class="itemize"><a 
href="https://en.wikipedia.org/wiki/Chrominance" >Chrominance</a> (or chroma) is the signal used in video systems to convey the
     color information of the picture or a video. It was deﬁned to add the color
     signal to the black and white one in analog TV. Thus, the same signal,
     composed by two diﬀerent subsignals: Y and UV that can be isolated by
     ﬁltering, was compatible with both, black and white (which only used Y)
     and color ones (that used <a 
href="https://en.wikipedia.org/wiki/YUV" >YUV</a>).</li></ul>
   <table class="equation"><tr><td> <a 
 id="x1-9001r3"></a>
<!--l. 123--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
<mfenced separators="" 
open="("  close=")" ><mrow> <mtable  align="axis" style=""  
equalrows="false" equalcolumns="false" class="array"> <mtr><mtd 
class="array"  columnalign="center">  <mstyle 
class="text"><mtext  >Y</mtext></mstyle>  </mtd></mtr><mtr><mtd 
class="array"  columnalign="center"><mstyle 
class="text"><mtext  >U</mtext></mstyle></mtd>
</mtr>  <mtr><mtd 
class="array"  columnalign="center">  <mstyle 
class="text"><mtext  >V</mtext></mstyle>  </mtd></mtr><!--c--></mtable>                                                             </mrow></mfenced> <mo 
class="MathClass-rel">=</mo> <mfenced separators="" 
open="("  close=")" ><mrow> <mtable  align="axis" style=""  
equalrows="false" columnlines="none none" equalcolumns="false" class="array"> <mtr><mtd 
class="array"  columnalign="right">        <mn>0</mn><mo 
class="MathClass-punc">,</mo><mn>2</mn><mn>9</mn><mn>9</mn> </mtd><mtd 
class="array"  columnalign="right">        <mn>0</mn><mo 
class="MathClass-punc">,</mo><mn>5</mn><mn>8</mn><mn>7</mn> </mtd><mtd 
class="array"  columnalign="right">        <mn>0</mn><mo 
class="MathClass-punc">,</mo><mn>1</mn><mn>4</mn><mn>4</mn> </mtd>
</mtr>  <mtr><mtd 
class="array"  columnalign="right">   <mo 
class="MathClass-bin">−</mo> <mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>4</mn><mn>7</mn><mn>1</mn><mn>3</mn> </mtd><mtd 
class="array"  columnalign="right">   <mo 
class="MathClass-bin">−</mo> <mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>2</mn><mn>8</mn><mn>8</mn><mn>8</mn><mn>6</mn> </mtd><mtd 
class="array"  columnalign="right">        <mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>4</mn><mn>3</mn><mn>6</mn> </mtd></mtr>  <mtr><mtd 
class="array"  columnalign="right">  <mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>6</mn><mn>1</mn><mn>5</mn> </mtd> <mtd 
class="array"  columnalign="right">  <mo 
class="MathClass-bin">−</mo> <mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>5</mn><mn>1</mn><mn>4</mn><mn>9</mn><mn>9</mn> </mtd> <mtd 
class="array"  columnalign="right">  <mo 
class="MathClass-bin">−</mo> <mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>0</mn><mn>0</mn><mn>0</mn><mn>1</mn></mtd>
</mtr>    <!--rrr--></mtable>                                                                                                   </mrow></mfenced> <mfenced separators="" 
open="("  close=")" ><mrow> <mtable  align="axis" style=""  
equalrows="false" equalcolumns="false" class="array"> <mtr><mtd 
class="array"  columnalign="center">  <mstyle 
class="text"><mtext  >R</mtext></mstyle>  </mtd></mtr>  <mtr><mtd 
class="array"  columnalign="center">  <mstyle 
class="text"><mtext  >G</mtext></mstyle></mtd>
</mtr>  <mtr><mtd 
class="array"  columnalign="center">  <mstyle 
class="text"><mtext  >B</mtext></mstyle>  </mtd></mtr> <!--c--></mtable>                                                                                                </mrow></mfenced>
</math></td><td class="eq-no">(3)</td></tr></table>
   <table class="equation"><tr><td> <a 
 id="x1-9002r4"></a>
                                                                  

                                                                  
<!--l. 147--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
<mfenced separators="" 
open="("  close=")" ><mrow> <mtable  align="axis" style=""  
equalrows="false" equalcolumns="false" class="array"> <mtr><mtd 
class="array"  columnalign="center">  <mstyle 
class="text"><mtext  >R</mtext></mstyle>  </mtd></mtr><mtr><mtd 
class="array"  columnalign="center"><mstyle 
class="text"><mtext  >G</mtext></mstyle></mtd>
</mtr>  <mtr><mtd 
class="array"  columnalign="center">  <mstyle 
class="text"><mtext  >B</mtext></mstyle>  </mtd></mtr><!--c--></mtable>                                                             </mrow></mfenced> <mo 
class="MathClass-rel">=</mo> <mfenced separators="" 
open="("  close=")" ><mrow> <mtable  align="axis" style=""  
equalrows="false" columnlines="none none" equalcolumns="false" class="array"> <mtr><mtd 
class="array"  columnalign="right">  <mn>1</mn> </mtd><mtd 
class="array"  columnalign="right">             <mn>0</mn> </mtd><mtd 
class="array"  columnalign="right">     <mn>1</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>3</mn><mn>9</mn><mn>8</mn><mn>3</mn> </mtd></mtr>  <mtr><mtd 
class="array"  columnalign="right">  <mn>1</mn> </mtd> <mtd 
class="array"  columnalign="right">  <mo 
class="MathClass-bin">−</mo> <mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>3</mn><mn>9</mn><mn>4</mn><mn>6</mn><mn>5</mn> </mtd> <mtd 
class="array"  columnalign="right">  <mo 
class="MathClass-bin">−</mo> <mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>5</mn><mn>8</mn><mn>0</mn><mn>6</mn><mn>0</mn></mtd>
</mtr>  <mtr><mtd 
class="array"  columnalign="right">  <mn>1</mn> </mtd><mtd 
class="array"  columnalign="right">     <mn>2</mn><mo 
class="MathClass-punc">.</mo><mn>0</mn><mn>3</mn><mn>2</mn><mn>1</mn><mn>1</mn> </mtd><mtd 
class="array"  columnalign="right">             <mn>0</mn> </mtd></mtr> <!--rrr--></mtable>                                                                </mrow></mfenced> <mfenced separators="" 
open="("  close=")" ><mrow> <mtable  align="axis" style=""  
equalrows="false" equalcolumns="false" class="array"> <mtr><mtd 
class="array"  columnalign="center"> <mstyle 
class="text"><mtext  >Y</mtext></mstyle>  </mtd></mtr>  <mtr><mtd 
class="array"  columnalign="center">  <mstyle 
class="text"><mtext  >U</mtext></mstyle></mtd>
</mtr>  <mtr><mtd 
class="array"  columnalign="center">  <mstyle 
class="text"><mtext  >V</mtext></mstyle>  </mtd></mtr> <!--c--></mtable>                                                                                                </mrow></mfenced>
</math></td><td class="eq-no">(4)</td></tr></table>
     <ul class="itemize1">
     <li class="itemize">Later, in digital video, the YUV color domain was called the <a 
href="https://en.wikipedia.org/wiki/YCbCr" >YCrCb color
     domain</a>.
     </li>
     <li class="itemize">Used, for example, in <a 
href="https://en.wikipedia.org/wiki/JPEG" >JPEG</a>.</li></ul>
<!--l. 179--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.2   </span> <a 
 id="x1-100005.2"></a>Spectral (color) redundancy</h4>
     <ul class="itemize1">
     <li class="itemize"><a 
href="https://en.wikipedia.org/wiki/RGB_color_model" ><!--l. 184--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mstyle 
class="text"><mtext  >RGB</mtext></mstyle></mrow></math>
     domain</a> is more redundant than the <a 
href="https://en.wikipedia.org/wiki/YUV" ><!--l. 185--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mstyle 
class="text"><mtext  >YUV</mtext></mstyle></mrow></math>
     domain</a>:</li></ul>
<!--l. 190--><p class="noindent" ><a 
href="https://nbviewer.jupyter.org/github/vicente-gonzalez-ruiz/image_transformations_for_coding/blob/master/color_redundancy.ipynb" >Color redundancy <span class="cite">[<a 
href="#Xbarr__image">1</a>, <a 
href="#Xgouillart__scikit">2</a>, <a 
href="#Xsolem__programming">4</a>]</span></a>.
</p><!--l. 192--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">6   </span> <a 
 id="x1-110006"></a>Chrominance subsampling</h3>
<!--l. 194--><p class="noindent" ><a 
href="https://en.wikipedia.org/wiki/Chroma_subsampling" >The human visual system is more sensitive to the luma (Y) than to the chroma (UV)</a>.
This means than the chroma can be subsampled without a signiﬁcant loss of quality
in the images.
</p><!--l. 198--><p class="indent" >   <div style="text-align:center;"> <img width=600 src="graphics/color_subsampling.svg" /> </div> 
</p><!--l. 201--><p class="indent" >   <a 
href="https://nbviewer.jupyter.org/github/vicente-gonzalez-ruiz/image_transformations_for_coding/blob/master/chroma_subsampling.ipynb" >Chroma subsampling</a>.
                                                                  

                                                                  
</p><!--l. 203--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">7   </span> <a 
 id="x1-120007"></a>Orthogonal transform</h3>
     <ul class="itemize1">
     <li class="itemize">The rows of <!--l. 207--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>A</mi></mrow></math>
     (<!--l. 207--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>a</mi></mrow><mrow 
><mi 
>k</mi><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-bin">∗</mo></mrow></msub 
></mrow></math>)
     are refered to as the <span 
class="ecti-1000">basis vectors </span>of the transform, and should form an
     <span 
class="ecti-1000">orthogonal </span>basis set in order to provide maximum energy compactation.
     The rows can be also seen as the coeﬃcients of <!--l. 210--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>B</mi></mrow></math>
     ﬁlters, being the ﬁrst one (<!--l. 211--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>i</mi> <mo 
class="MathClass-rel">=</mo> <mn>0</mn></mrow></math>)
     the “low-pass”  one, which will produce the DC coeﬃcient, and the rest
     (<!--l. 212--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>i</mi> <mo 
class="MathClass-rel">≥</mo> <mn>1</mn></mrow></math>)
     the “high-pass” ﬁlters, which will generate the AC (Alternating Current)
     coeﬀs. These <!--l. 213--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>B</mi></mrow></math>
     ﬁlters form a ﬁlter-bank where the overlapping between the frequency
     response of the ﬁlters should be as small as possible if we want maximum
     energy compaction.</li></ul>
<!--l. 219--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">7.1   </span> <a 
 id="x1-130007.1"></a>Orthonormal transform</h4>
     <ul class="itemize1">
     <li class="itemize">If  the  basis  vectors  of  a  orthogonal  transform  are  unit  vectors,  the
     transform is said orthonormal.
     </li>
     <li class="itemize">For orthonormal transforms, it holds that
     <table class="equation"><tr><td> <a 
 id="x1-13001r5"></a>
     <!--l. 227--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                             <msup><mrow 
><mi 
>A</mi></mrow><mrow 
><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></msup 
> <mo 
class="MathClass-rel">=</mo> <msup><mrow 
><mi 
>A</mi></mrow><mrow 
><mi 
>T</mi></mrow></msup 
><mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">(5)</td></tr></table>
                                                                  

                                                                  
     <!--l. 231--><p class="noindent" >Therefore, the pair of transforms refered by Eqs. (forward_transform_matrix_form)
     and (inverse_transform_matrix_form) can be written as
</p>
     <table class="equation"><tr><td> <a 
 id="x1-13002r6"></a>
     <!--l. 235--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
 <mtable  align="axis" style=""  
equalrows="false" equalcolumns="false" class="array"> <mtr><mtd 
class="array"  columnalign="left">  <mi 
>C</mi> <mo 
class="MathClass-rel">=</mo> <mi 
>A</mi><mi 
>c</mi>   </mtd>
</mtr>  <mtr><mtd 
class="array"  columnalign="left"> <mi 
>c</mi> <mo 
class="MathClass-rel">=</mo> <msup><mrow 
><mi 
>A</mi></mrow><mrow 
><mi 
>T</mi></mrow></msup 
><mi 
>C</mi><mo 
class="MathClass-punc">.</mo> </mtd></mtr><!--l--></mtable>
</math></td><td class="eq-no">(6)</td></tr></table>
     </li></ul>
<!--l. 243--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">8   </span> <a 
 id="x1-140008"></a>Signal energy</h3>
   <table class="equation"><tr><td> <a 
 id="x1-14001r7"></a>
<!--l. 244--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                       <mo 
class="MathClass-rel">|</mo><mo 
class="MathClass-rel">|</mo><mi 
>s</mi><mo 
class="MathClass-rel">|</mo><msup><mrow 
><mo 
class="MathClass-rel">|</mo></mrow><mrow 
><mn>2</mn></mrow></msup 
> <mo 
class="MathClass-rel">=</mo><munderover accentunder="false" accent="false"><mrow  
><mo mathsize="big" 
> ∑</mo>
  </mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>B</mi><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></munderover 
><msubsup><mrow 
><mi 
>s</mi></mrow><mrow 
>
<mi 
>n</mi></mrow><mrow 
><mn>2</mn></mrow></msubsup 
><mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">(7)</td></tr></table>
<!--l. 248--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">8.1   </span> <a 
 id="x1-150008.1"></a>Energy conservation</h4>
                                                                  

                                                                  
     <ul class="itemize1">
     <li class="itemize">if <!--l. 251--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>A</mi></mrow></math>
     is orthonormal (also called <span 
class="ecti-1000">unitary</span>), the energy of the transformed signal
     is the equal to the original one:
     <table class="equation"><tr><td> <a 
 id="x1-15001r8"></a>
     <!--l. 254--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                           <mo 
class="MathClass-rel">|</mo><mo 
class="MathClass-rel">|</mo><mi 
>C</mi><mo 
class="MathClass-rel">|</mo><msup><mrow 
><mo 
class="MathClass-rel">|</mo></mrow><mrow 
><mn>2</mn></mrow></msup 
> <mo 
class="MathClass-rel">=</mo> <mo 
class="MathClass-rel">|</mo><mo 
class="MathClass-rel">|</mo><mi 
>c</mi><mo 
class="MathClass-rel">|</mo><msup><mrow 
><mo 
class="MathClass-rel">|</mo></mrow><mrow 
><mn>2</mn></mrow></msup 
><mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">(8)</td></tr></table>
     </li></ul>
<!--l. 259--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">8.2   </span> <a 
 id="x1-160008.2"></a>Proof</h4>
   <table class="equation"><tr><td> <a 
 id="x1-16001r9"></a>
<!--l. 260--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
        <mo 
class="MathClass-rel">|</mo><mo 
class="MathClass-rel">|</mo><mi 
>C</mi><mo 
class="MathClass-rel">|</mo><msup><mrow 
><mo 
class="MathClass-rel">|</mo></mrow><mrow 
><mn>2</mn></mrow></msup 
> <mo 
class="MathClass-rel">=</mo> <msup><mrow 
><mi 
>C</mi></mrow><mrow 
><mi 
>T</mi></mrow></msup 
><mi 
>C</mi> <mo 
class="MathClass-rel">=</mo> <msup><mrow 
><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>A</mi><mi 
>c</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow><mrow 
><mi 
>T</mi></mrow></msup 
><mi 
>A</mi><mi 
>c</mi> <mo 
class="MathClass-rel">=</mo> <msup><mrow 
><mi 
>c</mi></mrow><mrow 
><mi 
>T</mi></mrow></msup 
><msup><mrow 
><mi 
>A</mi></mrow><mrow 
><mi 
>T</mi></mrow></msup 
><mi 
>A</mi><mi 
>c</mi> <mo 
class="MathClass-rel">=</mo> <msup><mrow 
><mi 
>c</mi></mrow><mrow 
><mi 
>T</mi></mrow></msup 
><mi 
>I</mi><mi 
>c</mi> <mo 
class="MathClass-rel">=</mo> <msup><mrow 
><mi 
>c</mi></mrow><mrow 
><mi 
>T</mi></mrow></msup 
><mi 
>c</mi> <mo 
class="MathClass-rel">=</mo> <mo 
class="MathClass-rel">|</mo><mo 
class="MathClass-rel">|</mo><mi 
>c</mi><mo 
class="MathClass-rel">|</mo><msup><mrow 
><mo 
class="MathClass-rel">|</mo></mrow><mrow 
><mn>2</mn></mrow></msup 
><mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">(9)</td></tr></table>
<!--l. 264--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">9   </span> <a 
 id="x1-170009"></a><a 
href="https://en.wikipedia.org/wiki/Expected_value" >Expected value</a></h3>
                                                                  

                                                                  
<!--l. 265--><p class="noindent" >The expected value <!--l. 265--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mo class="qopname">E</mo><!--nolimits--><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>X</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow></math>
of a random variable <!--l. 265--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>X</mi></mrow></math>,
intuitively, is the long-run average value of repetitions of the experiment it represents.
Let <!--l. 267--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>X</mi></mrow></math>
be a random variable with a ﬁnite number of ﬁnite outcomes
<!--l. 268--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
></mrow></math>,
<!--l. 268--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
></mrow></math>,
<!--l. 268--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mo 
class="MathClass-rel">⋯</mo></mrow></math>,
<!--l. 268--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
></mrow></math> occurring with
probabilities <!--l. 269--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
></mrow></math>,
<!--l. 269--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
></mrow></math>,
<!--l. 269--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mo 
class="MathClass-rel">⋯</mo></mrow></math>,
<!--l. 269--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>k</mi></mrow></msub 
></mrow></math>,
respectively. The expected value (or <span 
class="ecti-1000">expectation</span>) of
<!--l. 270--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>X</mi></mrow></math> is
deﬁned as
</p>
   <table class="equation"><tr><td> <a 
 id="x1-17001r10"></a>
<!--l. 273--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                        <mo class="qopname">E</mo><!--nolimits--><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>X</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo><munderover accentunder="false" accent="false"><mrow  
><mo mathsize="big" 
> ∑</mo>
  </mrow><mrow 
><mi 
>i</mi><mo 
class="MathClass-rel">=</mo><mn>1</mn></mrow><mrow 
><mi 
>n</mi></mrow></munderover 
><msub><mrow 
><mi 
>X</mi></mrow><mrow 
>
<mi 
>i</mi></mrow></msub 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">(10)</td></tr></table>
<!--l. 277--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">10   </span> <a 
 id="x1-1800010"></a><a 
href="https://en.wikipedia.org/wiki/Variance" >Variance</a></h3>
<!--l. 278--><p class="noindent" >The variance of a random variable <!--l. 278--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>X</mi></mrow></math>
is the expected value of the squared deviation from the mean of
<!--l. 279--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>X</mi></mrow></math>:
</p>
   <table class="equation"><tr><td> <a 
 id="x1-18001r11"></a>
                                                                  

                                                                  
<!--l. 281--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
<msub><mrow 
><mi 
>σ</mi></mrow><mrow 
><mi 
>X</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo><mo class="qopname"> Var</mo><!--nolimits--><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>X</mi></mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-rel">=</mo><mo class="qopname"> E</mo><!--nolimits--> <mfenced separators="" 
open="["  close="]" ><mrow><msup><mrow 
><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>X</mi> <mo 
class="MathClass-bin">−</mo><mo class="qopname"> E</mo><!--nolimits--><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>X</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow><mrow 
><mn>2</mn></mrow></msup 
></mrow></mfenced> <mo 
class="MathClass-rel">=</mo><mo class="qopname"> E</mo><!--nolimits--> <mfenced separators="" 
open="["  close="]" ><mrow><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>X</mi> <mo 
class="MathClass-bin">−</mo><mo class="qopname"> E</mo><!--nolimits--><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>X</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>X</mi> <mo 
class="MathClass-bin">−</mo><mo class="qopname"> E</mo><!--nolimits--><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>X</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow></mfenced> <mo 
class="MathClass-rel">=</mo><mo class="qopname"> E</mo><!--nolimits--> <mfenced separators="" 
open="["  close="]" ><mrow><msup><mrow 
><mi 
>X</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
></mrow></mfenced> <mo 
class="MathClass-bin">−</mo><mo class="qopname"> E</mo><!--nolimits--><msup><mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>X</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mrow 
><mn>2</mn></mrow></msup 
><mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">(11)</td></tr></table>
<!--l. 285--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">10.1   </span> <a 
 id="x1-1900010.1"></a><a 
href="https://en.wikipedia.org/wiki/Covariance" >Covariance</a></h4>
<!--l. 286--><p class="noindent" >The covariance <!--l. 286--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mo class="qopname">cov</mo><!--nolimits--><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>X</mi><mo 
class="MathClass-punc">,</mo><mi 
>Y</mi> </mrow><mo 
class="MathClass-close">)</mo></mrow></mrow></math>
is a measure of the joint variability of two random variables
<!--l. 287--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>X</mi></mrow></math>,
<!--l. 287--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>Y</mi> </mrow></math>,
deﬁned as:
</p>
   <table class="equation"><tr><td> <a 
 id="x1-19001r12"></a>
<!--l. 289--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                 <mo class="qopname">cov</mo><!--nolimits--><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>X</mi><mo 
class="MathClass-punc">,</mo><mi 
>Y</mi> </mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-rel">=</mo><mo class="qopname"> E</mo><!--nolimits--><mstyle mathsize="1.19em"><mfenced separators="" 
open="["  close="" ><mrow></mrow></mfenced></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>X</mi> <mo 
class="MathClass-bin">−</mo><mo class="qopname"> E</mo><!--nolimits--><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>X</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>Y</mi> <mo 
class="MathClass-bin">−</mo><mo class="qopname"> E</mo><!--nolimits--><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Y</mi> </mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow><mstyle mathsize="1.19em"><mfenced separators="" 
open="]"  close="" ><mrow></mrow></mfenced></mstyle><mo 
class="MathClass-punc">,</mo>
</math></td><td class="eq-no">(12)</td></tr></table>
<!--l. 294--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">11   </span> <a 
 id="x1-2000011"></a><a 
href="https://en.wikipedia.org/wiki/Covariance_matrix" >Covariance matrix</a></h3>
<!--l. 295--><p class="noindent" >A covariance matrix <!--l. 295--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>Σ</mi></mrow><mrow 
><mi 
>Z</mi></mrow></msub 
></mrow></math> is a
matrix whose element in the <!--l. 295--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>i</mi></mrow></math>,
<!--l. 296--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>j</mi></mrow></math> position is the covariance
between the <!--l. 296--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>i</mi></mrow></math>-th and
<!--l. 296--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>j</mi></mrow></math>-th elements of a random
vector <!--l. 297--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>Z</mi></mrow></math> (a collection
of random variables <!--l. 298--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>Z</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></mrow></math>):
</p>
   <table class="equation"><tr><td> <a 
 id="x1-20001r13"></a>
                                                                  

                                                                  
<!--l. 300--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation"><msub><mrow 
>
<mi 
>Σ</mi></mrow><mrow 
><mi 
>Z</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo>  <mfenced separators="" 
open="["  close="]" ><mrow><mtable  align="axis" style=""  
equalrows="false" columnlines="none none none none none none none none none" equalcolumns="false" class="array"><mtr><mtd 
class="array"  columnalign="center">  <mo class="qopname">E</mo><!--nolimits--><mrow ><mo 
class="MathClass-open">[</mo><mrow><mrow ><mo 
class="MathClass-open">(</mo><mrow><msub><mrow 
><mi 
>Z</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-bin">−</mo> <msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
></mrow><mo 
class="MathClass-close">)</mo></mrow><mrow ><mo 
class="MathClass-open">(</mo><mrow><msub><mrow 
><mi 
>Z</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-bin">−</mo> <msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow><mo 
class="MathClass-close">]</mo></mrow>  </mtd><mtd 
class="array"  columnalign="center">  <mo class="qopname">E</mo><!--nolimits--><mrow ><mo 
class="MathClass-open">[</mo><mrow><mrow ><mo 
class="MathClass-open">(</mo><mrow><msub><mrow 
><mi 
>Z</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-bin">−</mo> <msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
></mrow><mo 
class="MathClass-close">)</mo></mrow><mrow ><mo 
class="MathClass-open">(</mo><mrow><msub><mrow 
><mi 
>Z</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
> <mo 
class="MathClass-bin">−</mo> <msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow><mo 
class="MathClass-close">]</mo></mrow>  </mtd><mtd 
class="array"  columnalign="center"> <mo 
class="MathClass-rel">⋯</mo> </mtd><mtd 
class="array"  columnalign="center">  <mo class="qopname">E</mo><!--nolimits--><mrow ><mo 
class="MathClass-open">[</mo><mrow><mrow ><mo 
class="MathClass-open">(</mo><mrow><msub><mrow 
><mi 
>Z</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-bin">−</mo> <msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
></mrow><mo 
class="MathClass-close">)</mo></mrow><mrow ><mo 
class="MathClass-open">(</mo><mrow><msub><mrow 
><mi 
>Z</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
> <mo 
class="MathClass-bin">−</mo> <msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow><mo 
class="MathClass-close">]</mo></mrow>  </mtd></mtr> <mtr><mtd 
class="array"  columnalign="center"> </mtd>
</mtr><mtr><mtd 
class="array"  columnalign="center">  <mo class="qopname">E</mo><!--nolimits--><mrow ><mo 
class="MathClass-open">[</mo><mrow><mrow ><mo 
class="MathClass-open">(</mo><mrow><msub><mrow 
><mi 
>Z</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
> <mo 
class="MathClass-bin">−</mo> <msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
></mrow><mo 
class="MathClass-close">)</mo></mrow><mrow ><mo 
class="MathClass-open">(</mo><mrow><msub><mrow 
><mi 
>Z</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-bin">−</mo> <msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow><mo 
class="MathClass-close">]</mo></mrow>  </mtd><mtd 
class="array"  columnalign="center">  <mo class="qopname">E</mo><!--nolimits--><mrow ><mo 
class="MathClass-open">[</mo><mrow><mrow ><mo 
class="MathClass-open">(</mo><mrow><msub><mrow 
><mi 
>Z</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
> <mo 
class="MathClass-bin">−</mo> <msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
></mrow><mo 
class="MathClass-close">)</mo></mrow><mrow ><mo 
class="MathClass-open">(</mo><mrow><msub><mrow 
><mi 
>Z</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
> <mo 
class="MathClass-bin">−</mo> <msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow><mo 
class="MathClass-close">]</mo></mrow>  </mtd><mtd 
class="array"  columnalign="center"> <mo 
class="MathClass-rel">⋯</mo> </mtd><mtd 
class="array"  columnalign="center">  <mo class="qopname">E</mo><!--nolimits--><mrow ><mo 
class="MathClass-open">[</mo><mrow><mrow ><mo 
class="MathClass-open">(</mo><mrow><msub><mrow 
><mi 
>Z</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
> <mo 
class="MathClass-bin">−</mo> <msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
></mrow><mo 
class="MathClass-close">)</mo></mrow><mrow ><mo 
class="MathClass-open">(</mo><mrow><msub><mrow 
><mi 
>Z</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
> <mo 
class="MathClass-bin">−</mo> <msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow><mo 
class="MathClass-close">]</mo></mrow>  </mtd></mtr> <mtr><mtd 
class="array"  columnalign="center"> </mtd></mtr> <mtr><mtd 
class="array"  columnalign="center"> <mo 
class="MathClass-op">⋮</mo> </mtd> <mtd 
class="array"  columnalign="center"> <mo 
class="MathClass-op">⋮</mo> </mtd> <mtd 
class="array"  columnalign="center"> <mo 
class="MathClass-rel">⋱</mo> </mtd> <mtd 
class="array"  columnalign="center"> <mo 
class="MathClass-op">⋮</mo></mtd></mtr> <mtr><mtd 
class="array"  columnalign="center"> </mtd>
</mtr><mtr><mtd 
class="array"  columnalign="center"> <mo class="qopname">E</mo><!--nolimits--><mrow ><mo 
class="MathClass-open">[</mo><mrow><mrow ><mo 
class="MathClass-open">(</mo><mrow><msub><mrow 
><mi 
>Z</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
> <mo 
class="MathClass-bin">−</mo> <msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">)</mo></mrow><mrow ><mo 
class="MathClass-open">(</mo><mrow><msub><mrow 
><mi 
>Z</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-bin">−</mo> <msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow><mo 
class="MathClass-close">]</mo></mrow> </mtd><mtd 
class="array"  columnalign="center"> <mo class="qopname">E</mo><!--nolimits--><mrow ><mo 
class="MathClass-open">[</mo><mrow><mrow ><mo 
class="MathClass-open">(</mo><mrow><msub><mrow 
><mi 
>Z</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
> <mo 
class="MathClass-bin">−</mo> <msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">)</mo></mrow><mrow ><mo 
class="MathClass-open">(</mo><mrow><msub><mrow 
><mi 
>Z</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
> <mo 
class="MathClass-bin">−</mo> <msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow><mo 
class="MathClass-close">]</mo></mrow> </mtd><mtd 
class="array"  columnalign="center"> <mo 
class="MathClass-rel">⋯</mo> </mtd><mtd 
class="array"  columnalign="center"> <mo class="qopname">E</mo><!--nolimits--><mrow ><mo 
class="MathClass-open">[</mo><mrow><mrow ><mo 
class="MathClass-open">(</mo><mrow><msub><mrow 
><mi 
>Z</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
> <mo 
class="MathClass-bin">−</mo> <msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">)</mo></mrow><mrow ><mo 
class="MathClass-open">(</mo><mrow><msub><mrow 
><mi 
>Z</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
> <mo 
class="MathClass-bin">−</mo> <msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow><mo 
class="MathClass-close">]</mo></mrow> </mtd></mtr> <!--*\c@MaxMatrixCols c--></mtable>  </mrow></mfenced><mo 
class="MathClass-rel">=</mo><mo class="qopname"> E</mo><!--nolimits--> <mfenced separators="" 
open="["  close="]" ><mrow><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>Z</mi> <mo 
class="MathClass-bin">−</mo><mo class="qopname"> E</mo><!--nolimits--><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Z</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow><msup><mrow 
><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>Z</mi> <mo 
class="MathClass-bin">−</mo><mo class="qopname"> E</mo><!--nolimits--><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Z</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow><mrow 
><mi 
>T</mi></mrow></msup 
></mrow></mfenced> <mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">(13)</td></tr></table>
<!--l. 313--><p class="indent" >   where </p><table class="equation"><tr><td> <a 
 id="x1-20002r14"></a>
<!--l. 313--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                            <msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo><mo class="qopname"> E</mo><!--nolimits--><mrow ><mo 
class="MathClass-open">(</mo><mrow><msub><mrow 
><mi 
>Z</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">)</mo></mrow><mo 
class="MathClass-punc">,</mo>
</math></td><td class="eq-no">(14)</td></tr></table>
<!--l. 315--><p class="indent" >   is the expected value of the <!--l. 315--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>i</mi></mrow></math>-th
entry in the vector <!--l. 316--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>Z</mi></mrow></math>.
</p><!--l. 318--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">12   </span> <a 
 id="x1-2100012"></a>Covariance matrix of a block-based transform</h3>
   <table class="equation"><tr><td> <a 
 id="x1-21001r15"></a>
<!--l. 319--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation"><msub><mrow 
>
<mi 
>Σ</mi></mrow><mrow 
><mi 
>S</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo><mo class="qopname"> E</mo><!--nolimits--> <mfenced separators="" 
open="["  close="]" ><mrow><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>S</mi> <mo 
class="MathClass-bin">−</mo><mo class="qopname"> E</mo><!--nolimits--><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>S</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow><msup><mrow 
><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>S</mi> <mo 
class="MathClass-bin">−</mo><mo class="qopname"> E</mo><!--nolimits--><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>S</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow><mrow 
><mi 
>T</mi></mrow></msup 
></mrow></mfenced> <mo 
class="MathClass-rel">=</mo><mo class="qopname"> E</mo><!--nolimits--> <mfenced separators="" 
open="["  close="]" ><mrow><mi 
>A</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>s</mi> <mo 
class="MathClass-bin">−</mo><mo class="qopname"> E</mo><!--nolimits--><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>s</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow><msup><mrow 
><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>s</mi> <mo 
class="MathClass-bin">−</mo><mo class="qopname"> E</mo><!--nolimits--><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>s</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow><mrow 
><mi 
>T</mi></mrow></msup 
><msup><mrow 
><mi 
>A</mi></mrow><mrow 
><mi 
>T</mi></mrow></msup 
></mrow></mfenced> <mo 
class="MathClass-rel">=</mo> <mi 
>A</mi><mo class="qopname">E</mo><!--nolimits--> <mfenced separators="" 
open="["  close="]" ><mrow><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>s</mi> <mo 
class="MathClass-bin">−</mo><mo class="qopname"> E</mo><!--nolimits--><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>s</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow><msup><mrow 
><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>s</mi> <mo 
class="MathClass-bin">−</mo><mo class="qopname"> E</mo><!--nolimits--><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>s</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow><mrow 
><mi 
>T</mi></mrow></msup 
></mrow></mfenced> <msup><mrow 
><mi 
>A</mi></mrow><mrow 
><mi 
>T</mi></mrow></msup 
> <mo 
class="MathClass-rel">=</mo> <mi 
>A</mi><msub><mrow 
><mi 
>Σ</mi></mrow><mrow 
>
<mi 
>s</mi></mrow></msub 
><msup><mrow 
><mi 
>A</mi></mrow><mrow 
><mi 
>T</mi></mrow></msup 
><mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">(15)</td></tr></table>
                                                                  

                                                                  
<!--l. 334--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">13   </span> <a 
 id="x1-2200013"></a><a 
href="https://en.wikipedia.org/wiki/Correlation_and_dependence" >Correlation</a></h3>
<!--l. 335--><p class="noindent" >The most familiar measure of dependence between two random variables
<!--l. 336--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>X</mi></mrow></math> and
<!--l. 336--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>Y</mi> </mrow></math> is the
Pearson product-moment correlation coeﬃcient, or “Pearson’s correlation
coeﬃcient”, commonly called simply “the correlation coeﬃcient”. It is obtained by
dividing the covariance of the two variables by the product of their standard
deviations.
</p>
   <table class="equation"><tr><td> <a 
 id="x1-22001r16"></a>
<!--l. 341--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
         <msub><mrow 
><mi 
>ρ</mi></mrow><mrow 
><mi 
>X</mi><mo 
class="MathClass-punc">,</mo><mi 
>Y</mi> </mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mi mathvariant="normal">corr</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>X</mi><mo 
class="MathClass-punc">,</mo><mi 
>Y</mi> </mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-rel">=</mo><mfrac><mrow> <mi mathvariant="normal">cov</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>X</mi><mo 
class="MathClass-punc">,</mo><mi 
>Y</mi> </mrow><mo 
class="MathClass-close">)</mo></mrow></mrow> 
   <mrow><msub><mrow 
><mi 
>σ</mi></mrow><mrow 
><mi 
>X</mi></mrow></msub 
><msub><mrow 
><mi 
>σ</mi></mrow><mrow 
><mi 
>Y</mi> </mrow></msub 
></mrow></mfrac>    <mo 
class="MathClass-rel">=</mo><mfrac><mrow> <mo class="qopname">E</mo><!--nolimits--><mrow ><mo 
class="MathClass-open">[</mo><mrow><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>X</mi> <mo 
class="MathClass-bin">−</mo> <msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mi 
>X</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">)</mo></mrow><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>Y</mi> <mo 
class="MathClass-bin">−</mo> <msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mi 
>Y</mi> </mrow></msub 
></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow> 
          <mrow><msub><mrow 
><mi 
>σ</mi></mrow><mrow 
><mi 
>X</mi></mrow></msub 
><msub><mrow 
><mi 
>σ</mi></mrow><mrow 
><mi 
>Y</mi> </mrow></msub 
></mrow></mfrac>
</math></td><td class="eq-no">(16)</td></tr></table>
<!--l. 345--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">14   </span> <a 
 id="x1-2300014"></a><a 
href="https://en.wikipedia.org/wiki/Autocorrelation" >Autocorrelation</a></h3>
<!--l. 346--><p class="noindent" >Autocorrelation, also known as serial correlation, is the correlation of a signal
<!--l. 347--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>s</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>t</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow></math>
with a delayed copy of itself as a function of delay
<!--l. 348--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>s</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>t</mi> <mo 
class="MathClass-bin">+</mo> <mi 
>τ</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow></math>.
</p>
   <table class="equation"><tr><td> <a 
 id="x1-23001r17"></a>
                                                                  

                                                                  
<!--l. 350--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
              <msub><mrow 
><mi 
>ρ</mi></mrow><mrow 
><mi 
>s</mi></mrow></msub 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>τ</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>ρ</mi></mrow><mrow 
><mi 
>s</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>t</mi></mrow><mo 
class="MathClass-close">]</mo></mrow><mo 
class="MathClass-punc">,</mo><mi 
>s</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>t</mi><mo 
class="MathClass-bin">+</mo><mi 
>τ</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow></msub 
> <mo 
class="MathClass-rel">=</mo><mfrac><mrow> <mo class="qopname">E</mo><!--nolimits--><mrow ><mo 
class="MathClass-open">[</mo><mrow><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>s</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>t</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-bin">−</mo> <mi 
>μ</mi></mrow><mo 
class="MathClass-close">)</mo></mrow><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>s</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>t</mi> <mo 
class="MathClass-bin">+</mo> <mi 
>τ</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-bin">−</mo> <mi 
>μ</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow> 
               <mrow><msup><mrow 
><mi 
>σ</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
></mrow></mfrac>
</math></td><td class="eq-no">(17)</td></tr></table>
<!--l. 354--><p class="indent" >   where <!--l. 354--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>μ</mi> <mo 
class="MathClass-rel">=</mo><mo class="qopname"> E</mo><!--nolimits--><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>s</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>t</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-rel">=</mo><mo class="qopname"> E</mo><!--nolimits--><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>s</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>t</mi> <mo 
class="MathClass-bin">+</mo> <mi 
>τ</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow></math>
and <!--l. 355--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>σ</mi> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>σ</mi></mrow><mrow 
><mi 
>s</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>t</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>σ</mi></mrow><mrow 
><mi 
>s</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>t</mi><mo 
class="MathClass-bin">+</mo><mi 
>τ</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow></msub 
></mrow></math>.
</p><!--l. 357--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">15   </span> <a 
 id="x1-2400015"></a>Autocorrelation matrix</h3>
<!--l. 358--><p class="noindent" >The autocorrelation matrix of a random process
<!--l. 358--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>X</mi></mrow></math> is the
matrix <!--l. 359--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>R</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow></math>
deﬁned by
</p>
   <table class="equation"><tr><td> <a 
 id="x1-24001r18"></a>
<!--l. 361--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                         <msub><mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>R</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mrow 
><mi 
>i</mi><mo 
class="MathClass-punc">,</mo><mi 
>j</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>ρ</mi></mrow><mrow 
><mi 
>X</mi></mrow></msub 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><mo 
class="MathClass-rel">|</mo><mi 
>i</mi> <mo 
class="MathClass-bin">−</mo> <mi 
>j</mi><mo 
class="MathClass-rel">|</mo></mrow><mo 
class="MathClass-close">]</mo></mrow><mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">(18)</td></tr></table>
<!--l. 365--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">16   </span> <a 
 id="x1-2500016"></a><a 
href="https://en.wikipedia.org/wiki/Eigenvalues_and_eigenvectors" >Eigenvalue and eigenvector</a></h3>
<!--l. 366--><p class="noindent" >In linear algebra, an eigenvector or characteristic vector
<!--l. 367--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mover class="overrightarrow"><mrow 
><mi 
>v</mi></mrow><mo 
class="MathClass-op">⃗</mo></mover></mrow></math> of a linear
transformation <!--l. 367--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>T</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow></math>
is a non-zero vector that changes by only a scalar factor
<!--l. 368--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>λ</mi></mrow></math>
(known as the eigenvalue, characteristic value, or characteristic root of
<!--l. 370--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mover class="overrightarrow"><mrow 
><mi 
>v</mi></mrow><mo 
class="MathClass-op">⃗</mo></mover></mrow></math>)
when that linear transformation is applied to it:
</p>
                                                                  

                                                                  
   <table class="equation"><tr><td> <a 
 id="x1-25001r19"></a>
<!--l. 373--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                            <mi 
>T</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mover class="overrightarrow"><mrow 
><mi 
>v</mi></mrow><mo 
class="MathClass-op">⃗</mo></mover></mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mi 
>λ</mi><mover class="overrightarrow"><mrow 
><mi 
>v</mi></mrow><mo 
class="MathClass-op">⃗</mo></mover><mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">(19)</td></tr></table>
<!--l. 377--><p class="indent" >   When <!--l. 377--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>T</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow></math> can be
expressed by a matrix <!--l. 377--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>X</mi></mrow></math>,
we get
</p>
   <table class="equation"><tr><td> <a 
 id="x1-25002r20"></a>
<!--l. 379--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                            <mi 
>A</mi><mover class="overrightarrow"><mrow 
><mi 
>v</mi></mrow><mo 
class="MathClass-op">⃗</mo></mover> <mo 
class="MathClass-rel">=</mo> <mi 
>λ</mi><mover class="overrightarrow"><mrow 
><mi 
>v</mi></mrow><mo 
class="MathClass-op">⃗</mo></mover><mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">(20)</td></tr></table>
<!--l. 383--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">17   </span> <a 
 id="x1-2600017"></a>Coding gain</h3>
     <ul class="itemize1">
     <li class="itemize">The coding gain measures the compaction level of the transform, which is
     deﬁned as
     <table class="equation"><tr><td> <a 
 id="x1-26001r21"></a>
                                                                  

                                                                  
     <!--l. 389--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                    <mi 
>G</mi> <mo 
class="MathClass-rel">=</mo> <mfrac><mrow 
> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mi 
>B</mi></mrow></mfrac><munderover accentunder="false" accent="false"><mrow  
><mo mathsize="big" 
> ∑</mo>
  </mrow><mrow 
><mi 
>u</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>B</mi><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></munderover 
><msubsup><mrow 
><mi 
>σ</mi></mrow><mrow 
><msub><mrow 
>
<mi 
>C</mi></mrow><mrow 
><mi 
>u</mi></mrow></msub 
></mrow><mrow 
><mn>2</mn></mrow></msubsup 
></mrow> 
<mrow 
><mroot><mrow 
><munderover accentunder="false" accent="false"><mrow  
><mo mathsize="big" 
> ∏</mo>
  </mrow><mrow 
><mi 
>u</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>B</mi><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></munderover 
><msubsup><mrow 
><mi 
>σ</mi></mrow><mrow 
><msub><mrow 
>
<mi 
>C</mi></mrow><mrow 
><mi 
>u</mi></mrow></msub 
></mrow><mrow 
><mn>2</mn></mrow></msubsup 
></mrow><mrow 
><mi 
>B</mi></mrow></mroot></mrow></mfrac> <mo 
class="MathClass-punc">,</mo>
</math></td><td class="eq-no">(21)</td></tr></table>
     <!--l. 393--><p class="noindent" >where <!--l. 393--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msubsup><mrow 
><mi 
>σ</mi></mrow><mrow 
><msub><mrow 
><mi 
>C</mi></mrow><mrow 
><mi 
>u</mi></mrow></msub 
></mrow><mrow 
><mn>2</mn></mrow></msubsup 
></mrow></math> is the
     variance of coeﬀ <!--l. 393--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>C</mi></mrow><mrow 
><mi 
>u</mi></mrow></msub 
></mrow></math>.</p></li></ul>
<!--l. 396--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">18   </span> <a 
 id="x1-2700018"></a>Karhunen-Loéve transform (KLT)</h3>
     <ul class="itemize1">
     <li class="itemize">For the KLT, the rows of <!--l. 399--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>A</mi></mrow></math>
     (the basis of the forward transform) are the eigenvectors of the (unnormalized)
     autocorrelation matrix <!--l. 401--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>R</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow></math>
     of the signal <!--l. 401--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>s</mi></mrow></math>,
     where
     <table class="equation"><tr><td> <a 
 id="x1-27001r22"></a>
     <!--l. 403--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                      <msub><mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>R</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mrow 
><mi 
>i</mi><mo 
class="MathClass-punc">,</mo><mi 
>j</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo><mo class="qopname"> E</mo><!--nolimits--><mstyle mathsize="1.19em"><mfenced separators="" 
open="("  close="" ><mrow></mrow></mfenced></mstyle><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-bin">+</mo><mo 
class="MathClass-rel">|</mo><mi 
>i</mi><mo 
class="MathClass-bin">−</mo><mi 
>j</mi><mo 
class="MathClass-rel">|</mo></mrow></msub 
><mstyle mathsize="1.19em"><mfenced separators="" 
open=")"  close="" ><mrow></mrow></mfenced></mstyle><mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">(22)</td></tr></table>
     </li>
     <li class="itemize">It can be proven that KLT minimizes
     <!--l. 408--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mroot><mrow 
><msubsup><mrow 
><mo 
class="MathClass-op"> ∏</mo>
  <!--nolimits--></mrow><mrow 
><mi 
>u</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>B</mi><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></msubsup 
><msubsup><mrow 
><mi 
>σ</mi></mrow><mrow 
><msub><mrow 
><mi 
>C</mi></mrow><mrow 
><mi 
>u</mi></mrow></msub 
></mrow><mrow 
><mn>2</mn></mrow></msubsup 
></mrow><mrow 
><mi 
>B</mi></mrow></mroot></mrow></math>,
     and therefore, it provides the maximum coding gain.
     Unfortunately, the basis fuctions of the KLT depends on
     <!--l. 410--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>s</mi></mrow></math>. If
                                                                  

                                                                  
     <!--l. 410--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>S</mi></mrow></math>
     is non-<a 
href="https://en.wikipedia.org/wiki/Stationary_process" >stationary</a>, the autocorrelation matrix (or the basis) must be sent to the
     decoder (to run the inverse transform) as side information. However, if
     <!--l. 414--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>B</mi> <mo 
class="MathClass-rel">=</mo> <mn>2</mn></mrow></math>,
     the KLT is
     <table class="equation"><tr><td> <a 
 id="x1-27002r23"></a>
     <!--l. 416--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation"><msub><mrow 
>
<mi 
>A</mi></mrow><mrow 
><mstyle 
class="text"><mtext  >2-KLT</mtext></mstyle></mrow></msub 
> <mo 
class="MathClass-rel">=</mo>  <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><msqrt><mrow><mn>2</mn></mrow></msqrt></mrow></mfrac> <mfenced separators="" 
open="["  close="]" ><mrow> <mtable  align="axis" style=""  
equalrows="false" columnlines="none" equalcolumns="false" class="array"> <mtr><mtd 
class="array"  columnalign="center"> <mn>1</mn> </mtd><mtd 
class="array"  columnalign="center">   <mn>1</mn>   </mtd></mtr>  <mtr><mtd 
class="array"  columnalign="center">  <mn>1</mn> </mtd> <mtd 
class="array"  columnalign="center">  <mo 
class="MathClass-bin">−</mo> <mn>1</mn></mtd></mtr><!--cc--></mtable>                                                                                         </mrow></mfenced>
</math></td><td class="eq-no">(23)</td></tr></table>
     <!--l. 426--><p class="noindent" >for all signals.</p></li></ul>
<!--l. 429--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">19   </span> <a 
 id="x1-2800019"></a>Discrete cosine transform (DCT))</h3>
<!--l. 431--><p class="noindent" ><a 
 id="definition"></a>
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">19.0.1   </span> <a 
 id="x1-2900019.0.1"></a>Deﬁnition</h5>
     <ul class="itemize1">
     <li class="itemize">The forward (direct) transform is
     <table class="equation"><tr><td> <a 
 id="x1-29001r24"></a>
                                                                  

                                                                  
     <!--l. 437--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                      <msub><mrow 
><mi 
>S</mi></mrow><mrow 
><mi 
>u</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo>  <mfrac><mrow 
><msqrt><mrow><mn>2</mn></mrow></msqrt></mrow> 
<mrow 
><msqrt><mrow><mi 
>N</mi></mrow></msqrt></mrow></mfrac><mi 
>K</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>u</mi></mrow><mo 
class="MathClass-close">)</mo></mrow><munderover accentunder="false" accent="false"><mrow  
><mo mathsize="big" 
>∑</mo>
  </mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>N</mi><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></munderover 
><msub><mrow 
><mi 
>s</mi></mrow><mrow 
>
<mi 
>n</mi></mrow></msub 
><mo class="qopname"> cos</mo><!--nolimits--> <mfrac><mrow 
><mrow ><mo 
class="MathClass-open">(</mo><mrow><mn>2</mn><mi 
>n</mi> <mo 
class="MathClass-bin">+</mo> <mn>1</mn></mrow><mo 
class="MathClass-close">)</mo></mrow><mi 
>π</mi><mi 
>u</mi></mrow> 
     <mrow 
><mn>2</mn><mi 
>n</mi></mrow></mfrac>     <mo 
class="MathClass-punc">,</mo>
</math></td><td class="eq-no">(24)</td></tr></table>
     <!--l. 442--><p class="noindent" >and the backward (inverse) transform is
</p>
     <table class="equation"><tr><td> <a 
 id="x1-29002r25"></a>
     <!--l. 444--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                      <msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo>  <mfrac><mrow 
><msqrt><mrow><mn>2</mn></mrow></msqrt></mrow> 
<mrow 
><msqrt><mrow><mi 
>N</mi></mrow></msqrt></mrow></mfrac><munderover accentunder="false" accent="false"><mrow  
><mo mathsize="big" 
>∑</mo>
  </mrow><mrow 
><mi 
>u</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>N</mi><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></munderover 
><mi 
>K</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>u</mi></mrow><mo 
class="MathClass-close">)</mo></mrow><msub><mrow 
><mi 
>S</mi></mrow><mrow 
>
<mi 
>u</mi></mrow></msub 
><mo class="qopname"> cos</mo><!--nolimits--> <mfrac><mrow 
><mrow ><mo 
class="MathClass-open">(</mo><mrow><mn>2</mn><mi 
>n</mi> <mo 
class="MathClass-bin">+</mo> <mn>1</mn></mrow><mo 
class="MathClass-close">)</mo></mrow><mi 
>π</mi><mi 
>u</mi></mrow> 
     <mrow 
><mn>2</mn><mi 
>n</mi></mrow></mfrac>     <mo 
class="MathClass-punc">,</mo>
</math></td><td class="eq-no">(25)</td></tr></table>
     <!--l. 449--><p class="noindent" >where <!--l. 449--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>N</mi></mrow></math> is the number
     of pixels, and <!--l. 449--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
></mrow></math>
     denotes the <!--l. 449--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi></mrow></math>-th
     pixel of the image <!--l. 450--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>s</mi></mrow></math>,
     and
</p>
     <table class="equation"><tr><td> <a 
 id="x1-29003r26"></a>
     <!--l. 452--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
<mi 
>K</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>u</mi></mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mfenced separators="" 
open="{"  close="" ><mrow> <mtable  align="axis" style=""  
equalrows="false" columnlines="none" equalcolumns="false" class="array"> <mtr><mtd 
class="array"  columnalign="left">   <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><msqrt><mrow><mn>2</mn></mrow></msqrt></mrow></mfrac>  </mtd><mtd 
class="array"  columnalign="left">  <mstyle 
class="text"><mtext  >si</mtext></mstyle><mspace width="0.33em" class="nbsp" /><mi 
>u</mi> <mo 
class="MathClass-rel">=</mo> <mn>0</mn>  </mtd>
</mtr>  <mtr><mtd 
class="array"  columnalign="left">  <mn>1</mn>    </mtd><mtd 
class="array"  columnalign="left">  <mstyle 
class="text"><mtext  >if</mtext></mstyle><mspace width="0.33em" class="nbsp" /><mi 
>u</mi> <mo 
class="MathClass-rel">&#x003E;</mo> <mn>0</mn><mo 
class="MathClass-punc">.</mo> </mtd></mtr><!--ll--></mtable>                                                                     </mrow></mfenced>
</math></td><td class="eq-no">(26)</td></tr></table>
     </li></ul>
                                                                  

                                                                  
<!--l. 463--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">19.1   </span> <a 
 id="x1-3000019.1"></a>Properties fo DCT</h4>
<!--l. 464--><p class="noindent" >
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-30002x1"><span 
class="ecbx-1000">Separable</span>: the <!--l. 467--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>D</mi></mrow></math>-dimensional
     DCT can be computed using the <!--l. 468--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>1</mn></mrow></math>D
     DCT in each possible dimension.
     </li>
     <li 
  class="enumerate" id="x1-30004x2">In general, <span 
class="ecbx-1000">high energy compaction</span>: a small number of DCT coeﬃcients
     can reconstruct with a reasonable accuracy the original signal.
     </li>
     <li 
  class="enumerate" id="x1-30006x3"><span 
class="ecbx-1000">Unitary</span>: the energy of the DCT coeﬃcients is proportional to the energy
     of the samples.
     </li>
     <li 
  class="enumerate" id="x1-30008x4"><span 
class="ecbx-1000">Orthonormality</span>: DCT basis are orthonormal (orthogonal + unitary)
     and therefore, DCT coeﬃcients are uncorrelated.</li></ol>
<!--l. 482--><p class="noindent" ><a 
href="https://nbviewer.jupyter.org/github/vicente-gonzalez-ruiz/image_transformations_for_coding/blob/master/DCT.ipynb" >DCT</a>.
</p><!--l. 484--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">20   </span> <a 
 id="x1-3100020"></a>Dyadic discrete wavelet transform (DWT)</h3>
<!--l. 485--><p class="noindent" >Key features:
</p><!--l. 487--><p class="indent" >
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-31002x1"><span 
class="ecbx-1000">High spectral compaction</span>, specially when transient signals are present.
     </li>
     <li 
  class="enumerate" id="x1-31004x2"><span 
class="ecbx-1000">Multiresolution representation</span>: it is easy to recover a reduced version
     of the original image if only a sub-set of the coeﬃcients is proccesed.</li></ol>
<!--l. 498--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">21   </span> <a 
 id="x1-3200021"></a>Filters bank implementation</h3>
<!--l. 499--><p class="noindent" >Where: </p><table class="equation"><tr><td> <a 
 id="x1-32001r27"></a>
                                                                  

                                                                  
<!--l. 499--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                   <mi 
>s</mi> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">(</mo><mrow><msup><mrow 
><mi 
>↑</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>L</mi></mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-bin">∗</mo><msub><mrow 
><mstyle 
class="text"><mtext  >s</mtext></mstyle></mrow><mrow 
>
<mi 
>L</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-bin">+</mo> <mrow ><mo 
class="MathClass-open">(</mo><mrow><msup><mrow 
><mi 
>↑</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>H</mi></mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-bin">∗</mo><msub><mrow 
><mstyle 
class="text"><mtext  >s</mtext></mstyle></mrow><mrow 
>
<mi 
>H</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">)</mo></mrow>
</math></td><td class="eq-no">(27)</td></tr></table>
<!--l. 501--><p class="indent" >   and </p><table class="equation"><tr><td> <a 
 id="x1-32002r28"></a>
<!--l. 501--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
 <mtable  align="axis" style=""  
equalrows="false" columnlines="none none" equalcolumns="false" class="array"> <mtr><mtd 
class="array"  columnalign="right">  <mi 
>L</mi> </mtd><mtd 
class="array"  columnalign="center">  <mo 
class="MathClass-rel">=</mo> </mtd><mtd 
class="array"  columnalign="left">  <msup><mrow 
><mi 
>↓</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>s</mi> <mo 
class="MathClass-bin">∗</mo><msub><mrow 
><mstyle 
class="text"><mtext  >a</mtext></mstyle></mrow><mrow 
><mi 
>L</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">)</mo></mrow>   </mtd>
</mtr>  <mtr><mtd 
class="array"  columnalign="right">  <mi 
>H</mi> </mtd><mtd 
class="array"  columnalign="center">  <mo 
class="MathClass-rel">=</mo> </mtd><mtd 
class="array"  columnalign="left">  <msup><mrow 
><mi 
>↓</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>s</mi> <mo 
class="MathClass-bin">∗</mo><msub><mrow 
><mstyle 
class="text"><mtext  >a</mtext></mstyle></mrow><mrow 
><mi 
>H</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">)</mo></mrow><mo 
class="MathClass-punc">.</mo> </mtd></mtr><!--rcl--></mtable>
</math></td><td class="eq-no">(28)</td></tr></table>
<!--l. 508--><p class="indent" >   Comments:
</p><!--l. 510--><p class="indent" >
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-32004x1"><!--l. 512--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mstyle 
class="text"><mtext  >a</mtext></mstyle></mrow><mrow 
><mi 
>L</mi></mrow></msub 
></mrow></math>
     and <!--l. 512--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mstyle 
class="text"><mtext  >a</mtext></mstyle></mrow><mrow 
><mi 
>H</mi></mrow></msub 
></mrow></math>
     are the transfer function (the transfer function of a ﬁlter is the response
     of that ﬁlter to the unitary impulse function (Dirac’s delta)) of a low-pass
     ﬁlter  and  high-pass  ﬁlter,  respectively,  that  have  been  designed  to  be
     complementary (ideally, in <!--l. 516--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>L</mi></mrow></math>
     we only found the frequencies of <!--l. 517--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>s</mi></mrow></math>
     that are not in <!--l. 517--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>H</mi></mrow></math>,
     and viceversa). When this is true, it is said the we are using a perfect-reconstruction
     quadrature-mirror ﬁlter-bank and the DWT is <span 
class="ecti-1000">biorthogonal</span>.
     </li>
     <li 
  class="enumerate" id="x1-32006x2">In the wavelet theory, <!--l. 521--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mstyle 
class="text"><mtext  >s</mtext></mstyle></mrow><mrow 
><mi 
>L</mi></mrow></msub 
></mrow></math>
     is named the <span 
class="ecti-1000">scale function </span>and <!--l. 522--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mstyle 
class="text"><mtext  >s</mtext></mstyle></mrow><mrow 
><mi 
>H</mi></mrow></msub 
></mrow></math>
     the <span 
class="ecti-1000">mother function </span>or <span 
class="ecti-1000">wavelet basis function</span>. The coeﬃcients of <!--l. 523--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>L</mi></mrow></math>
     are also known as the <span 
class="ecti-1000">scale coeﬃents </span>and the coeﬀcientes of <!--l. 524--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>H</mi></mrow></math>
     the <span 
class="ecti-1000">wavelet coeﬃcients</span> <span class="cite">[<a 
href="#Xsovic2012signal">5</a>]</span>.
     </li>
     <li 
  class="enumerate" id="x1-32008x3"><!--l. 527--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msup><mrow 
><mi 
>↓</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
><mrow ><mo 
class="MathClass-open">(</mo><mrow><mo 
class="MathClass-bin">⋅</mo></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow></math>
     and <!--l. 527--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msup><mrow 
><mi 
>↑</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
><mrow ><mo 
class="MathClass-open">(</mo><mrow><mo 
class="MathClass-bin">⋅</mo></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow></math>
     donote the subsampling and oversampling operations:</li></ol>
   <table class="equation"><tr><td> <a 
 id="x1-32009r29"></a>
                                                                  

                                                                  
<!--l. 531--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                           <msub><mrow 
><mrow ><mo 
class="MathClass-open">(</mo><mrow><msup><mrow 
><mi 
>↓</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>s</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow><mrow 
>
<mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi></mrow></msub 
>
</math></td><td class="eq-no">(29)</td></tr></table>
<!--l. 535--><p class="indent" >   and
</p>
   <table class="equation"><tr><td> <a 
 id="x1-32010r30"></a>
<!--l. 537--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation"><msub><mrow 
>
<mrow ><mo 
class="MathClass-open">(</mo><mrow><msup><mrow 
><mi 
>↑</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>s</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow><mrow 
>
<mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mfenced separators="" 
open="{"  close="" ><mrow> <mtable  align="axis" style=""  
equalrows="false" columnlines="none" equalcolumns="false" class="array"> <mtr><mtd 
class="array"  columnalign="left">  <msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>i</mi><mo 
class="MathClass-bin">∕</mo><mn>2</mn></mrow></msub 
>  </mtd><mtd 
class="array"  columnalign="left">  <mstyle 
class="text"><mtext  >if </mtext><mstyle 
class="math"><mi 
>i</mi></mstyle><mtext  > if even</mtext></mstyle>  </mtd>
</mtr>  <mtr><mtd 
class="array"  columnalign="left">  <mn>0</mn>     </mtd><mtd 
class="array"  columnalign="left">  <mstyle 
class="text"><mtext  >otherwise</mtext></mstyle><mo 
class="MathClass-punc">.</mo> </mtd></mtr> <!--ll--></mtable>                                                                  </mrow></mfenced>
</math></td><td class="eq-no">(30)</td></tr></table>
<!--l. 547--><p class="indent" >   where <!--l. 547--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></mrow></math>
if the <!--l. 547--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>i</mi></mrow></math>-th
sample of <!--l. 547--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>s</mi></mrow></math>.
</p><!--l. 549--><p class="indent" >
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-32012x4"><!--l. 552--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mo 
class="MathClass-bin">∗</mo></mrow></math>
     is the convolution operator.
     </li>
     <li 
  class="enumerate" id="x1-32014x5">Notice that half of the ﬁltered samples are wasted.</li></ol>
<!--l. 557--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">22   </span> <a 
 id="x1-3300022"></a>Lifting implementation <span class="cite">[<a 
href="#Xsweldens1997building">6</a>]</span></h3>
<!--l. 558--><p class="noindent" ><div style="text-align:center;"> <img width=1000 src="graphics/lifting.svg" /> </div> 
</p><!--l. 560--><p class="indent" >   Comments:
</p><!--l. 562--><p class="indent" >
                                                                  

                                                                  
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-33002x1"><table class="equation"><tr><td> <a 
 id="x1-33003r31"></a>
     <!--l. 565--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                     <msub><mrow 
><mi 
>H</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi><mo 
class="MathClass-bin">+</mo><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-bin">−</mo><mi 
mathvariant="bold-script">𝒫</mi><msub><mrow 
><mrow ><mo 
class="MathClass-open">(</mo><mrow><mrow ><mo 
class="MathClass-open">{</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">}</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow><mrow 
><mi 
>i</mi></mrow></msub 
>
                                                                                                          <mstyle 
   id="x1-33004r30"  class="label" ></mstyle><!--endlabel-->
</math></td><td class="eq-no">(PredictionStep)<a 
 id="x1-33005r30"></a></td></tr></table>
     </li></ol>
   <table class="equation"><tr><td> <a 
 id="x1-33006r31"></a>
<!--l. 572--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                         <msub><mrow 
><mi 
>L</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mrow ><mo 
class="MathClass-open">{</mo><mrow><mi 
mathvariant="bold-script">𝒰</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>H</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow><mo 
class="MathClass-close">}</mo></mrow></mrow><mrow 
><mi 
>i</mi></mrow></msub 
>
                                                                  <mstyle 
   id="x1-33007r30"  class="label" ></mstyle><!--endlabel-->
</math></td><td class="eq-no">(UpdateStep)<a 
 id="x1-33008r30"></a></td></tr></table>
<!--l. 578--><p class="indent" >
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-33010x2">Subsampled signals <!--l. 582--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mrow ><mo 
class="MathClass-open">{</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">}</mo></mrow></mrow></math>
     and <!--l. 582--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mrow ><mo 
class="MathClass-open">{</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi><mo 
class="MathClass-bin">+</mo><mn>1</mn></mrow></msub 
></mrow><mo 
class="MathClass-close">}</mo></mrow></mrow></math>
     can been computed by using</li></ol>
   <table class="equation-star"><tr><td>
                                                                  

                                                                  
<!--l. 586--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                        <mrow ><mo 
class="MathClass-open">{</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi><mo 
class="MathClass-bin">+</mo><mn>1</mn></mrow></msub 
></mrow><mo 
class="MathClass-close">}</mo></mrow> <mo 
class="MathClass-rel">=</mo><msup><mrow 
><mi 
>↓</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
><mrow ><mo 
class="MathClass-open">(</mo><mrow><msup><mrow 
><mi 
>Z</mi></mrow><mrow 
><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></msup 
><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>s</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow>
</math></td></tr></table>
<!--l. 590--><p class="indent" >   and
</p>
   <table class="equation-star"><tr><td>
<!--l. 592--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                           <mrow ><mo 
class="MathClass-open">{</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">}</mo></mrow> <mo 
class="MathClass-rel">=</mo><msup><mrow 
><mi 
>↓</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>s</mi></mrow><mo 
class="MathClass-close">)</mo></mrow><mo 
class="MathClass-punc">,</mo>
</math></td></tr></table>
<!--l. 596--><p class="indent" >   where <!--l. 596--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msup><mrow 
><mi 
>Z</mi></mrow><mrow 
><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></msup 
></mrow></math>
represents the one sample delay function.
</p><!--l. 598--><p class="indent" >
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-33012x3"><!--l. 602--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>H</mi></mrow></math>
     has tipically less energy and variance and entropy than <!--l. 603--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mrow ><mo 
class="MathClass-open">{</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi><mo 
class="MathClass-bin">+</mo><mn>1</mn></mrow></msub 
></mrow><mo 
class="MathClass-close">}</mo></mrow></mrow></math>.
     </li>
     <li 
  class="enumerate" id="x1-33014x4"><!--l. 605--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>L</mi></mrow></math>
     has less aliasing than <!--l. 605--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mrow ><mo 
class="MathClass-open">{</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">}</mo></mrow></mrow></math>
     (notice that <!--l. 605--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>L</mi></mrow></math>
     has not been low-pass ﬁltered before subsampling it).</li></ol>
<!--l. 609--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">23   </span> <a 
 id="x1-3400023"></a><!--l. 609--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>T</mi></math>-levels
1D-DWT</h3>
<!--l. 610--><p class="noindent" ><div style="text-align:center;"> <img width=1000 src="graphics/n_levels_dwt1d.svg" /> </div> 
                                                                  

                                                                  
</p><!--l. 612--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">24   </span> <a 
 id="x1-3500024"></a>2D-DWT</h3>
     <ul class="itemize1">
     <li class="itemize">The one-dimensional (1D) DWT is a separable transform. Therefore, the
     2D DWT can be computed applying the DWT to all the rows of an image
     and next, to all the columns, or viceversa.</li></ul>
<!--l. 621--><p class="noindent" ><div style="text-align:center;"> <img width=800 src="graphics/2D-DWT.svg" /> </div> 
</p>
     <ul class="itemize1">
     <li class="itemize">The contribution of a coeﬃcient of a subband <!--l. 626--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>b</mi></mrow></math>
     is determined by the DWT basis fuction <!--l. 627--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msup><mrow 
><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>H</mi></mrow></msub 
></mrow><mrow 
><mi 
>b</mi></mrow></msup 
></mrow></math>
     asociated  to  that  coeﬃcient,  which  can  be  empirically  determined  by
     applying the inverse DWT to the Dirac Impulse function localized in that
     coeﬃcient (notice that <!--l. 630--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msup><mrow 
><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>H</mi></mrow></msub 
></mrow><mrow 
><mi 
>b</mi></mrow></msup 
></mrow></math>
     does  not  depend  on  the  coeﬃcient  because  we  are  supposing  that  all
     the coeﬃcients of a subband have the same contribution, the same basis
     fuction) <span class="cite">[<span 
class="ecbx-1000">?</span>]</span>. Therefore, the L<!--l. 633--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mrow 
></mrow><mrow 
><mn>2</mn></mrow></msub 
></mrow></math>-norm
     for the subband <!--l. 634--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>b</mi></mrow></math>
     is computed as the energy of a basis function of that subband as</li></ul>
   <table class="equation"><tr><td> <a 
 id="x1-35001r31"></a>
<!--l. 638--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                        <mi 
>E</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><msup><mrow 
><msub><mrow 
><mstyle 
class="text"><mtext  >s</mtext></mstyle></mrow><mrow 
><mi 
>H</mi></mrow></msub 
></mrow><mrow 
><mi 
>b</mi></mrow></msup 
></mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-rel">=</mo><munder class="msub"><mrow 
><mo mathsize="big" 
> ∑</mo>
   </mrow><mrow 
><mi 
>i</mi></mrow></munder 
><msup><mrow 
><mo 
class="MathClass-rel">|</mo><msubsup><mrow 
><msub><mrow 
><mstyle 
class="text"><mtext  >s</mtext></mstyle></mrow><mrow 
><mi 
>H</mi></mrow></msub 
></mrow><mrow 
><mi 
>i</mi></mrow><mrow 
><mi 
>b</mi></mrow></msubsup 
><mo 
class="MathClass-rel">|</mo></mrow><mrow 
><mn>2</mn></mrow></msup 
><mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">(31)</td></tr></table>
<!--l. 642--><p class="indent" >   In  the  case  of  the  5/3-DWT,  the
L<!--l. 642--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mrow 
></mrow><mrow 
><mn>2</mn></mrow></msub 
></mrow></math>-norms
of the DWT subbands are: <div style="text-align:center;"> <img width=400 src="graphics/factores_5_3_L2_norm.svg" /> </div> 
</p><!--l. 645--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">25   </span> <a 
 id="x1-3600025"></a>Haar ﬁlters <span class="cite">[<a 
href="#Xhaar1910theorie">3</a>]</span></h3>
                                                                  

                                                                  
<!--l. 646--><p class="noindent" >The <!--l. 646--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>i</mi></mrow></math>-th
sample of the low-frequency subband is computed (using a ﬁlter plus subsampling)
as
</p>
   <table class="equation"><tr><td> <a 
 id="x1-36001r32"></a>
<!--l. 649--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                          <msub><mrow 
><mi 
>L</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mfrac><mrow 
><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi><mo 
class="MathClass-bin">+</mo><mn>1</mn></mrow></msub 
></mrow> 
        <mrow 
><mn>2</mn></mrow></mfrac>       <mo 
class="MathClass-punc">,</mo>
                                                                  <mstyle 
   id="x1-36002r31"  class="label" ></mstyle><!--endlabel-->
</math></td><td class="eq-no">(HaarL)<a 
 id="x1-36003r31"></a></td></tr></table>
<!--l. 655--><p class="indent" >   and the <!--l. 655--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>i</mi></mrow></math>-th
sample of the high-frequency subband as
</p>
   <table class="equation"><tr><td> <a 
 id="x1-36004r32"></a>
<!--l. 657--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                          <msub><mrow 
><mi 
>H</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi><mo 
class="MathClass-bin">+</mo><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-bin">−</mo> <msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo>
                                                                  <mstyle 
   id="x1-36005r31"  class="label" ></mstyle><!--endlabel-->
</math></td><td class="eq-no">(HaarH)<a 
 id="x1-36006r31"></a></td></tr></table>
<!--l. 663--><p class="indent" >   If Lifting is used,
</p>
   <table class="equation"><tr><td> <a 
 id="x1-36007r32"></a>
                                                                  

                                                                  
<!--l. 665--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                           <msub><mrow 
><mi 
>L</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-bin">+</mo> <mfrac><mrow 
><msub><mrow 
><mi 
>H</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></mrow> 
 <mrow 
><mn>2</mn></mrow></mfrac> <mo 
class="MathClass-punc">.</mo>
                                                                  <mstyle 
   id="x1-36008r31"  class="label" ></mstyle><!--endlabel-->
</math></td><td class="eq-no">(HaarLLifted)<a 
 id="x1-36009r31"></a></td></tr></table>
<!--l. 671--><p class="indent" >   Notice that <!--l. 671--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>H</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mn>0</mn></mrow></math>
if <!--l. 671--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi><mo 
class="MathClass-bin">+</mo><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi></mrow></msub 
></mrow></math>,
therefore, the Haar transform is good to encode constant signals. The notation X/Y
indicates the length (taps or number of coeﬃcients) of the low-pass and the
high-pass (convolution) ﬁlters of the ﬁlter bank implementation (not Lifting),
respectively.
</p><!--l. 678--><p class="indent" >   <a 
href="https://nbviewer.jupyter.org/github/vicente-gonzalez-ruiz/image_transformations_for_coding/blob/master/Haar_2d_basis.ipynb" >Haar basis</a>.
</p><!--l. 680--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">26   </span> <a 
 id="x1-3700026"></a>Linear (5/3) ﬁlters <span class="cite">[<a 
href="#Xsweldens1997building">6</a>]</span></h3>
<!--l. 681--><p class="noindent" >The <!--l. 681--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>i</mi></math>-th
sample of the low-frequency subband (using a ﬁlter-bank implementation)
is
</p>
   <table class="equation"><tr><td> <a 
 id="x1-37001r32"></a>
<!--l. 683--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
            <msub><mrow 
><mi 
>L</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mo 
class="MathClass-bin">−</mo><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>8</mn></mrow></mfrac><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi><mo 
class="MathClass-bin">−</mo><mn>2</mn></mrow></msub 
> <mo 
class="MathClass-bin">+</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>4</mn></mrow></mfrac><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-bin">+</mo> <mfrac><mrow 
><mn>3</mn></mrow> 
<mrow 
><mn>4</mn></mrow></mfrac><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-bin">+</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>4</mn></mrow></mfrac><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi><mo 
class="MathClass-bin">+</mo><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-bin">−</mo><mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>8</mn></mrow></mfrac><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi><mo 
class="MathClass-bin">+</mo><mn>2</mn></mrow></msub 
>
                                                                  <mstyle 
   id="x1-37002r31"  class="label" ></mstyle><!--endlabel-->
</math></td><td class="eq-no">(5/3L)<a 
 id="x1-37003r31"></a></td></tr></table>
<!--l. 690--><p class="indent" >   and the <!--l. 690--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>i</mi></math>-th
sample of the high-frequency signal is computed by
</p>
   <table class="equation"><tr><td> <a 
 id="x1-37004r32"></a>
                                                                  

                                                                  
<!--l. 692--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                      <msub><mrow 
><mi 
>H</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi><mo 
class="MathClass-bin">+</mo><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-bin">−</mo><mfrac><mrow 
><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi><mo 
class="MathClass-bin">+</mo><mn>2</mn></mrow></msub 
></mrow> 
        <mrow 
><mn>2</mn></mrow></mfrac>       <mo 
class="MathClass-punc">,</mo>
                                                                  <mstyle 
   id="x1-37005r31"  class="label" ></mstyle><!--endlabel-->
</math></td><td class="eq-no">(5/3H)<a 
 id="x1-37006r31"></a></td></tr></table>
<!--l. 698--><p class="indent" >   that, if we use Lifting, it can be also computed using less operations
by
</p>
   <table class="equation"><tr><td> <a 
 id="x1-37007r32"></a>
<!--l. 700--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                       <msub><mrow 
><mi 
>L</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-bin">+</mo> <mfrac><mrow 
><msub><mrow 
><mi 
>H</mi></mrow><mrow 
><mi 
>i</mi><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>H</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></mrow> 
      <mrow 
><mn>4</mn></mrow></mfrac>       <mo 
class="MathClass-punc">.</mo>
                                                                  <mstyle 
   id="x1-37008r31"  class="label" ></mstyle><!--endlabel-->
</math></td><td class="eq-no">(5/3LLifted)<a 
 id="x1-37009r31"></a></td></tr></table>
<!--l. 706--><p class="indent" >   Notice that <!--l. 706--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>H</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mn>0</mn></math>
if <!--l. 706--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi><mo 
class="MathClass-bin">+</mo><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">(</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi><mo 
class="MathClass-bin">+</mo><mn>2</mn></mrow></msub 
></mrow><mo 
class="MathClass-close">)</mo></mrow><mo 
class="MathClass-bin">∕</mo><mn>2</mn></math>.
Therefore, the 5/3 transform is suitable to encode lineally piece-wised signals.
</p><!--l. 708--><p class="indent" >   <a 
href="https://nbviewer.jupyter.org/github/vicente-gonzalez-ruiz/image_transformations_for_coding/blob/master/linear_2d_basis.ipynb" >Linear (5/3) basis</a>.
</p><!--l. 710--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">27   </span> <a 
 id="x1-3800027"></a>Quantization in the transform domain</h3>
     <ul class="itemize1">
     <li class="itemize">If the transform is orthogonal, by deﬁnition coeﬀs <!--l. 714--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>S</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>k</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow></math>
     are uncorrelated. Therefore, a scalar quantizer can performs an optimal
     quantization.</li></ul>
<!--l. 719--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">28   </span> <a 
 id="x1-3900028"></a>Bit-planes progression</h3>
<!--l. 720--><p class="noindent" ><div style="text-align:center;"> <img width=800 src="graphics/bit-plane-trans.svg" /> </div> 
                                                                  

                                                                  
</p><!--l. 722--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">28.1   </span> <a 
 id="x1-4000028.1"></a>Bit allocation (bit-rate control)</h4>
     <ul class="itemize1">
     <li class="itemize">In lossless coding, coeﬀs <!--l. 725--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>S</mi></mrow><mrow 
><mi 
>u</mi></mrow></msub 
></mrow></math>
     are directly encoded using some text compression algorithm or a combination
     of them.
     </li>
     <li class="itemize">However, in most situations, a lossy compression is needed and in this
     case, a transform coder must determine, given a maximum number of bits
     <!--l. 730--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mover accent="false" 
class="mml-overline"><mrow><mi 
>R</mi></mrow><mo 
accent="true">¯</mo></mover></mrow></math>
     (which  is  deﬁned  by  the  compression  ratio  selected  by  the  user),  the
     number of bits <!--l. 731--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>R</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>u</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow></math>
     used by the quantizer for each coeﬀ <!--l. 732--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>S</mi></mrow><mrow 
><mi 
>k</mi></mrow></msub 
></mrow></math>.</li></ul>
<!--l. 735--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">29   </span> <a 
 id="x1-4100029"></a>Bit allocation based on minimizing the quantization error</h3>
     <ul class="itemize1">
     <li class="itemize">In unitary transforms, as a consequence of the energy preserving property,
     an uniform quantization (i.e. the dividing each coeﬀ <!--l. 741--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>S</mi></mrow><mrow 
><mi 
>u</mi></mrow></msub 
></mrow></math>
     by the same quantization step) should provide optimal bit allocation if we
     want to minimize the quantization error (the distortion) in the recostructed
     signal <!--l. 743--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>s</mi></mrow></math>.</li></ul>
<!--l. 746--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">30   </span> <a 
 id="x1-4200030"></a>Bit allocation based on minimizing the variance of the quantization
error</h3>
     <ul class="itemize1">
     <li class="itemize">Lets assume that the variance of the coeﬀs, deﬁned as
     <table class="equation"><tr><td> <a 
 id="x1-42001r32"></a>
                                                                  

                                                                  
     <!--l. 751--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                       <msubsup><mrow 
><mi 
>σ</mi></mrow><mrow 
><msub><mrow 
><mi 
>S</mi></mrow><mrow 
><mi 
>u</mi></mrow></msub 
></mrow><mrow 
><mn>2</mn></mrow></msubsup 
> <mo 
class="MathClass-rel">=</mo> <mstyle 
class="text"><mtext  >E</mtext></mstyle><mstyle mathsize="1.19em"><mfenced separators="" 
open="("  close="" ><mrow></mrow></mfenced></mstyle><msup><mrow 
><mrow ><mo 
class="MathClass-open">(</mo><mrow><msub><mrow 
><mi 
>S</mi></mrow><mrow 
>
<mi 
>u</mi></mrow></msub 
> <mo 
class="MathClass-bin">−</mo><mover accent="false" 
class="mml-overline"><mrow><mi 
>S</mi></mrow><mo 
accent="true">¯</mo></mover></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow><mrow 
><mn>2</mn></mrow></msup 
><mstyle mathsize="1.19em"><mfenced separators="" 
open=")"  close="" ><mrow></mrow></mfenced></mstyle>
</math></td><td class="eq-no">(32)</td></tr></table>
     <!--l. 755--><p class="noindent" >(where
</p>
     <table class="equation"><tr><td> <a 
 id="x1-42002r33"></a>
     <!--l. 757--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                 <mover accent="false" 
class="mml-overline"><mrow><mi 
>S</mi></mrow><mo 
accent="true">¯</mo></mover> <mo 
class="MathClass-rel">=</mo> <mstyle 
class="text"><mtext  >E</mtext></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>S</mi></mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-rel">=</mo>  <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mi 
>B</mi></mrow></mfrac><munderover accentunder="false" accent="false"><mrow  
><mo mathsize="big" 
>∑</mo>
  </mrow><mrow 
><mi 
>u</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>B</mi><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></munderover 
><msub><mrow 
><mi 
>S</mi></mrow><mrow 
>
<mi 
>u</mi></mrow></msub 
>
</math></td><td class="eq-no">(33)</td></tr></table>
     <!--l. 761--><p class="noindent" >corresponds to the amount of information provided by each coeﬀ. Therefore,
     coeﬀs with high variance should be assigned more bits and viceversa.
     </p></li>
     <li class="itemize">Lets deﬁne
     <table class="equation"><tr><td> <a 
 id="x1-42003r34"></a>
     <!--l. 767--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                    <mover accent="false" 
class="mml-overline"><mrow><mi 
>R</mi></mrow><mo 
accent="true">¯</mo></mover> <mo 
class="MathClass-rel">=</mo>  <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mi 
>B</mi></mrow></mfrac><munderover accentunder="false" accent="false"><mrow  
><mo mathsize="big" 
>∑</mo>
  </mrow><mrow 
><mi 
>u</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>B</mi><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></munderover 
><mi 
>R</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>u</mi></mrow><mo 
class="MathClass-close">)</mo></mrow>
                                                                                                       <mstyle 
   id="x1-42004r33"  class="label" ></mstyle><!--endlabel-->
</math></td><td class="eq-no">(<!--l. 770--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mover accent="false" 
class="mml-overline"><mrow><mi 
>R</mi></mrow><mo 
accent="true">¯</mo></mover></math>)<a 
 id="x1-42005r33"></a></td></tr></table>
     <!--l. 772--><p class="noindent" >as the (target) average number of bits/coeﬀ, where
     <!--l. 772--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>R</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>u</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow></math> is the number of bits
     assigned to coeﬀ <!--l. 773--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>S</mi></mrow><mrow 
><mi 
>u</mi></mrow></msub 
></mrow></math>.
                                                                  

                                                                  
     </p></li>
     <li class="itemize">If the mean square error is as a measure of distortion, the
     variance of the distortion generated by the quantization of a coeﬀ
     <!--l. 776--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>S</mi></mrow><mrow 
><mi 
>u</mi></mrow></msub 
></mrow></math>
     <a 
href="http://cdn.intechopen.com/pdfs/16267/InTech-Rate_control_in_video_coding.pdf" >can be modeled</a> by
     <table class="equation"><tr><td> <a 
 id="x1-42006r34"></a>
     <!--l. 780--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                 <msubsup><mrow 
><mi 
>σ</mi></mrow><mrow 
><msub><mrow 
><mi 
>S</mi></mrow><mrow 
><mi 
>u</mi></mrow></msub 
><mo 
class="MathClass-bin">−</mo><msub><mrow 
><mover 
accent="true"><mrow 
><mi 
>S</mi></mrow><mo 
class="MathClass-op">̃</mo></mover></mrow><mrow 
><mi 
>u</mi></mrow></msub 
></mrow><mrow 
><mn>2</mn></mrow></msubsup 
> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>α</mi></mrow><mrow 
>
<mi 
>u</mi></mrow></msub 
><msup><mrow 
><mn>2</mn></mrow><mrow 
><mo 
class="MathClass-bin">−</mo><mn>2</mn><mi 
>R</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>u</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow></msup 
><msubsup><mrow 
><mi 
>σ</mi></mrow><mrow 
><msub><mrow 
>
<mi 
>S</mi></mrow><mrow 
><mi 
>u</mi></mrow></msub 
></mrow><mrow 
><mn>2</mn></mrow></msubsup 
><mo 
class="MathClass-punc">,</mo>
</math></td><td class="eq-no">(34)</td></tr></table>
     <!--l. 784--><p class="noindent" >where <!--l. 784--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>α</mi></mrow><mrow 
><mi 
>u</mi></mrow></msub 
></mrow></math> depends
     on the frequency <!--l. 784--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>u</mi></mrow></math>
     and the quantizer.</p></li></ul>
<!--l. 787--><p class="noindent" ><a 
href="https://nbviewer.jupyter.org/github/vicente-gonzalez-ruiz/image_transformations_for_coding/blob/master/DR_model.ipynb" >DR_model notebook</a>.
</p>
     <ul class="itemize1">
     <li class="itemize">Assuming an additive distorion metric, the total distortion variance for
     <!--l. 792--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>R</mi></mrow><mrow 
><mi 
>k</mi></mrow></msub 
></mrow></math>
     bits/coeﬀ is given by
     <table class="equation"><tr><td> <a 
 id="x1-42007r35"></a>
     <!--l. 794--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
<mi 
>D</mi> <mo 
class="MathClass-rel">=</mo> <msubsup><mrow 
><mi 
>σ</mi></mrow><mrow 
><mi 
>S</mi><mo 
class="MathClass-bin">−</mo><mover 
accent="true"><mrow 
><mi 
>S</mi></mrow><mo 
class="MathClass-op">̃</mo></mover></mrow><mrow 
><mn>2</mn></mrow></msubsup 
> <mo 
class="MathClass-rel">=</mo><munderover accentunder="false" accent="false"><mrow  
><mo mathsize="big" 
> ∑</mo>
  </mrow><mrow 
><mi 
>u</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>B</mi><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></munderover 
><msubsup><mrow 
><mi 
>σ</mi></mrow><mrow 
><msub><mrow 
>
<mi 
>S</mi></mrow><mrow 
><mi 
>u</mi></mrow></msub 
><mo 
class="MathClass-bin">−</mo><msub><mrow 
><mover 
accent="true"><mrow 
><mi 
>S</mi></mrow><mo>̃</mo></mover></mrow><mrow 
><mi 
>u</mi></mrow></msub 
></mrow><mrow 
><mn>2</mn></mrow></msubsup 
> <mo 
class="MathClass-rel">=</mo><munderover accentunder="false" accent="false"><mrow  
><mo mathsize="big" 
> ∑</mo>
  </mrow><mrow 
><mi 
>u</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>B</mi><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></munderover 
><msub><mrow 
><mi 
>α</mi></mrow><mrow 
>
<mi 
>u</mi></mrow></msub 
><msup><mrow 
><mn>2</mn></mrow><mrow 
><mo 
class="MathClass-bin">−</mo><mn>2</mn><mi 
>R</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>u</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow></msup 
><msubsup><mrow 
><mi 
>σ</mi></mrow><mrow 
><msub><mrow 
>
<mi 
>S</mi></mrow><mrow 
><mi 
>u</mi></mrow></msub 
></mrow><mrow 
><mn>2</mn></mrow></msubsup 
> <mo 
class="MathClass-rel">=</mo> <mi 
>α</mi><munderover accentunder="false" accent="false"><mrow  
><mo mathsize="big" 
>∑</mo>
  </mrow><mrow 
><mi 
>u</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>B</mi><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></munderover 
><msup><mrow 
><mn>2</mn></mrow><mrow 
><mo 
class="MathClass-bin">−</mo><mn>2</mn><mi 
>R</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>u</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow></msup 
><msubsup><mrow 
><mi 
>σ</mi></mrow><mrow 
><msub><mrow 
>
<mi 
>S</mi></mrow><mrow 
><mi 
>u</mi></mrow></msub 
></mrow><mrow 
><mn>2</mn></mrow></msubsup 
>
                                                                                                                                <mstyle 
   id="x1-42008r34"  class="label" ></mstyle><!--endlabel-->
</math></td><td class="eq-no">(<!--l. 797--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>D</mi></math>)<a 
 id="x1-42009r34"></a></td></tr></table>
     <!--l. 797--><p class="noindent" >,
                                                                  

                                                                  
     </p><!--l. 799--><p class="noindent" >supposing that <!--l. 799--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>α</mi></mrow><mrow 
><mi 
>u</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mi 
>α</mi></mrow></math>
     is constant for all coeﬀs (a valid supposition for unitary transforms because the
     quantization error generated in each coeﬀ should be the same if an uniform
     quantizer is used).
     </p></li>
     <li class="itemize">The objective of the bit-allocation process is to ﬁnd the
     <!--l. 805--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msubsup><mrow 
><mrow ><mo 
class="MathClass-open">{</mo><mrow><mi 
>R</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>u</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow><mo 
class="MathClass-close">}</mo></mrow></mrow><mrow 
><mi 
>u</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>B</mi><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></msubsup 
></mrow></math> so that minimize
     <!--l. 805--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>D</mi></mrow></math> subject to
     constraint <!--l. 806--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mover accent="false" 
class="mml-overline"><mrow><mi 
>R</mi></mrow><mo 
accent="true">¯</mo></mover></mrow></math>:
     <table class="equation"><tr><td> <a 
 id="x1-42010r35"></a>
     <!--l. 808--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                <munder><mrow 
><mo class="qopname"> argmin</mo><!--nolimits--></mrow><mrow 
><msubsup><mrow 
><mrow ><mo 
class="MathClass-open">{</mo><mrow><mi 
>R</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>u</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow><mo 
class="MathClass-close">}</mo></mrow></mrow><mrow 
><mi 
>u</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>B</mi><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></msubsup 
></mrow></munder><mi 
>D</mi><mo 
class="MathClass-punc">,</mo><mstyle 
class="text"><mtext  >s.t.</mtext></mstyle><mspace width="0.33em" class="nbsp" /><mover accent="false" 
class="mml-overline"><mrow><mi 
>R</mi></mrow><mo 
accent="true">¯</mo></mover><mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">(35)</td></tr></table>
     </li>
     <li class="itemize">This is an optimization problem that can be solved using <a 
href="https://en.wikipedia.org/wiki/Lagrange_multiplier" >Lagrange multipliers</a>
     (note: the following development is not the “standard” way of using Lagrenge
     multipliear, but it is equivalent).
     </li>
     <li class="itemize">Lets deﬁne the Lagrangian functional
     <table class="equation"><tr><td> <a 
 id="x1-42011r36"></a>
     <!--l. 819--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
<mi 
>J</mi> <mo 
class="MathClass-rel">=</mo> <mi 
>D</mi><mo 
class="MathClass-bin">−</mo><mi 
>λ</mi><mstyle mathsize="1.61em"><mfenced separators="" 
open="("  close="" ><mrow></mrow></mfenced></mstyle><mover accent="false" 
class="mml-overline"><mrow><mi 
>R</mi></mrow><mo 
accent="true">¯</mo></mover><mo 
class="MathClass-bin">−</mo><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mi 
>B</mi></mrow></mfrac><munderover accentunder="false" accent="false"><mrow  
><mo mathsize="big" 
>∑</mo>
  </mrow><mrow 
><mi 
>u</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>B</mi><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></munderover 
><mi 
>R</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>u</mi></mrow><mo 
class="MathClass-close">)</mo></mrow><mstyle mathsize="1.61em"><mfenced separators="" 
open=")"  close="" ><mrow></mrow></mfenced></mstyle> <mo 
class="MathClass-rel">=</mo> <mi 
>α</mi><munderover accentunder="false" accent="false"><mrow  
><mo mathsize="big" 
>∑</mo>
</mrow><mrow 
><mi 
>u</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>B</mi><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></munderover 
><msup><mrow 
><mn>2</mn></mrow><mrow 
><mo 
class="MathClass-bin">−</mo><mn>2</mn><mi 
>R</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>u</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow></msup 
><msubsup><mrow 
><mi 
>σ</mi></mrow><mrow 
><msub><mrow 
>
<mi 
>S</mi></mrow><mrow 
><mi 
>u</mi></mrow></msub 
></mrow><mrow 
><mn>2</mn></mrow></msubsup 
><mo 
class="MathClass-bin">−</mo><mi 
>λ</mi><mstyle mathsize="1.61em"><mfenced separators="" 
open="("  close="" ><mrow></mrow></mfenced></mstyle><mover accent="false" 
class="mml-overline"><mrow><mi 
>R</mi></mrow><mo 
accent="true">¯</mo></mover><mo 
class="MathClass-bin">−</mo><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mi 
>B</mi></mrow></mfrac><munderover accentunder="false" accent="false"><mrow  
><mo mathsize="big" 
>∑</mo>
</mrow><mrow 
><mi 
>u</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>B</mi><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></munderover 
><mi 
>R</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>u</mi></mrow><mo 
class="MathClass-close">)</mo></mrow><mstyle mathsize="1.61em"><mfenced separators="" 
open=")"  close="" ><mrow></mrow></mfenced></mstyle><mo 
class="MathClass-punc">,</mo>
</math></td><td class="eq-no">(36)</td></tr></table>
     </li></ul>
                                                                  

                                                                  
<!--l. 824--><p class="indent" >   which taking
</p>
   <table class="equation"><tr><td> <a 
 id="x1-42012r37"></a>
<!--l. 826--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                              <mfrac><mrow 
><mi 
>∂</mi><mi 
>J</mi></mrow>
<mrow 
><mi 
>∂</mi><mi 
>R</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>u</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow></mfrac> <mo 
class="MathClass-rel">=</mo> <mn>0</mn>
</math></td><td class="eq-no">(37)</td></tr></table>
<!--l. 830--><p class="indent" >   produces that
</p>
   <table class="equation"><tr><td> <a 
 id="x1-42013r38"></a>
<!--l. 832--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                  <mi 
>R</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>u</mi></mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>2</mn></mrow></mfrac><msub><mrow 
><mo class="qopname">log</mo><!--nolimits--></mrow><mrow 
><mn>2</mn></mrow></msub 
><mstyle mathsize="1.19em"><mfenced separators="" 
open="("  close="" ><mrow></mrow></mfenced></mstyle><mn>2</mn><mi 
>α</mi><mo class="qopname">ln</mo><!--nolimits--><mn>2</mn><msubsup><mrow 
><mi 
>σ</mi></mrow><mrow 
><msub><mrow 
><mi 
>S</mi></mrow><mrow 
><mi 
>u</mi></mrow></msub 
></mrow><mrow 
><mn>2</mn></mrow></msubsup 
><mstyle mathsize="1.19em"><mfenced separators="" 
open=")"  close="" ><mrow></mrow></mfenced></mstyle> <mo 
class="MathClass-bin">−</mo><mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>2</mn></mrow></mfrac><msub><mrow 
><mo class="qopname">log</mo><!--nolimits--></mrow><mrow 
><mn>2</mn></mrow></msub 
><mi 
>λ</mi><mo 
class="MathClass-punc">.</mo>
                                                                  <mstyle 
   id="x1-42014r37"  class="label" ></mstyle><!--endlabel-->
</math></td><td class="eq-no">(<!--l. 835--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>R</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>u</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></math>)<a 
 id="x1-42015r37"></a></td></tr></table>
     <ul class="itemize1">
     <li class="itemize">Substituting <!--l. 839--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>R</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>u</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow></math>
     in Eq. (<!--l. 839--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mover accent="false" 
class="mml-overline"><mrow><mi 
>R</mi></mrow><mo 
accent="true">¯</mo></mover></mrow></math>),
     we get that
     <table class="equation"><tr><td> <a 
 id="x1-42016r38"></a>
                                                                  

                                                                  
     <!--l. 841--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                     <mover accent="false" 
class="mml-overline"><mrow><mi 
>R</mi></mrow><mo 
accent="true">¯</mo></mover> <mo 
class="MathClass-rel">=</mo>  <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mi 
>B</mi></mrow></mfrac><munderover accentunder="false" accent="false"><mrow  
><mo mathsize="big" 
>∑</mo>
  </mrow><mrow 
><mi 
>u</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>B</mi><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></munderover 
><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>2</mn></mrow></mfrac><msub><mrow 
><mo class="qopname">log</mo><!--nolimits--></mrow><mrow 
><mn>2</mn></mrow></msub 
><mstyle mathsize="1.19em"><mfenced separators="" 
open="("  close="" ><mrow></mrow></mfenced></mstyle><mn>2</mn><mi 
>α</mi><mo class="qopname">ln</mo><!--nolimits--><mn>2</mn><msubsup><mrow 
><mi 
>σ</mi></mrow><mrow 
><msub><mrow 
><mi 
>S</mi></mrow><mrow 
><mi 
>u</mi></mrow></msub 
></mrow><mrow 
><mn>2</mn></mrow></msubsup 
><mstyle mathsize="1.19em"><mfenced separators="" 
open=")"  close="" ><mrow></mrow></mfenced></mstyle> <mo 
class="MathClass-bin">−</mo><mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>2</mn></mrow></mfrac><msub><mrow 
><mo class="qopname">log</mo><!--nolimits--></mrow><mrow 
><mn>2</mn></mrow></msub 
><mi 
>λ</mi><mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">(38)</td></tr></table>
     </li>
     <li class="itemize">Operating
     <table class="equation"><tr><td> <a 
 id="x1-42017r39"></a>
     <!--l. 847--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                           <mi 
>λ</mi> <mo 
class="MathClass-rel">=</mo><munderover accentunder="false" accent="false"><mrow  
><mo mathsize="big" 
> ∏</mo>
  </mrow><mrow 
><mi 
>u</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>B</mi><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></munderover 
><mroot><mrow 
><mn>2</mn><mi 
>α</mi><mo class="qopname">ln</mo><!--nolimits--><mn>2</mn><msubsup><mrow 
><mi 
>σ</mi></mrow><mrow 
><msub><mrow 
>
<mi 
>S</mi></mrow><mrow 
><mi 
>u</mi></mrow></msub 
></mrow><mrow 
><mn>2</mn></mrow></msubsup 
></mrow><mrow 
><mi 
>B</mi></mrow></mroot> <mo 
class="MathClass-bin">−</mo> <msup><mrow 
><mn>2</mn></mrow><mrow 
><mo 
class="MathClass-bin">−</mo><mn>2</mn><mover accent="false" 
class="mml-overline"><mrow><mi 
>R</mi></mrow><mo 
accent="true">¯</mo></mover></mrow></msup 
><mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">(39)</td></tr></table>
     </li>
     <li class="itemize">Substituting <!--l. 851--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>λ</mi></mrow></math>
     in Eq. (<!--l. 851--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>R</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>u</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow></math>),
     we obtain the optimal number of bits for each coeﬀ
     <table class="equation"><tr><td> <a 
 id="x1-42018r40"></a>
     <!--l. 854--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                           <mi 
>R</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>u</mi></mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mover accent="false" 
class="mml-overline"><mrow><mi 
>R</mi></mrow><mo 
accent="true">¯</mo></mover> <mo 
class="MathClass-bin">+</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>2</mn></mrow></mfrac><msub><mrow 
><mo class="qopname">log</mo><!--nolimits--></mrow><mrow 
><mn>2</mn></mrow></msub 
>           <mfrac><mrow 
><msubsup><mrow 
><mi 
>σ</mi></mrow><mrow 
><msub><mrow 
><mi 
>S</mi></mrow><mrow 
><mi 
>u</mi></mrow></msub 
></mrow><mrow 
><mn>2</mn></mrow></msubsup 
></mrow> 
<mrow 
><munderover accentunder="false" accent="false"><mrow  
><mo mathsize="big" 
> ∏</mo>
  </mrow><mrow 
><mi 
>u</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>B</mi><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></munderover 
><mroot><mrow 
><msubsup><mrow 
><mi 
>σ</mi></mrow><mrow 
><msub><mrow 
>
<mi 
>S</mi></mrow><mrow 
><mi 
>u</mi></mrow></msub 
></mrow><mrow 
><mn>2</mn></mrow></msubsup 
></mrow><mrow 
><mi 
>B</mi></mrow></mroot></mrow></mfrac><mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">(40)</td></tr></table>
     <!--l. 858--><p class="noindent" >which minimizes the variance of the quantization
     error. Notice that this value depends proportionally on
     <!--l. 859--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mover accent="false" 
class="mml-overline"><mrow><mi 
>R</mi></mrow><mo 
accent="true">¯</mo></mover></mrow></math>
     (the target average bits/coeﬀ), logaritmically on
     <!--l. 860--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>σ</mi></mrow><mrow 
><msubsup><mrow 
><mi 
>S</mi></mrow><mrow 
><mi 
>u</mi></mrow><mrow 
><mn>2</mn></mrow></msubsup 
></mrow></msub 
></mrow></math>
     (the variance of the coeﬀ) and log-inversely on the geometric mean of the
                                                                  

                                                                  
     variances of all coeﬀs.</p></li></ul>
<!--l. 865--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">31   </span> <a 
 id="x1-4300031"></a>Encoding</h3>
     <ul class="itemize1">
     <li class="itemize">For DCT, usually ZigZag-RLE followed by 0-order entropy coding.
     </li>
     <li class="itemize">For DWT, tree coding or block-based coding.</li></ul>
<!--l. 874--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">32   </span> <a 
 id="x1-4400032"></a>Code-stream orderings and scalabilities</h3>
     <ul class="itemize1">
     <li class="itemize">The order in which the DWT coeﬃcients are decoded determines the type
     of scalability (example with 2 qualities and 3 resolutions):</li></ul>
<!--l. 882--><p class="noindent" ><div style="text-align:center;"> <img width=800 src="graphics/orderers-and-scalabilities.svg" /> </div> 
</p><!--l. 1--><p class="noindent" >
</p>
   <h3 class="likesectionHead"><a 
 id="x1-4500032"></a>References</h3>
<!--l. 1--><p class="noindent" >
   </p><div class="thebibliography">
   <p class="bibitem" ><span class="biblabel">
 [1]<span class="bibsp">   </span></span><a 
 id="Xbarr__image"></a>Iain       Barr.                  Image       processing       with       numpy.
   http://www.degeneratestate.org/posts/2016/Oct/23/image-processing-with-numpy/.
   </p>
   <p class="bibitem" ><span class="biblabel">
 [2]<span class="bibsp">   </span></span><a 
 id="Xgouillart__scikit"></a>Emmanuelle     Gouillart.            Scikit-image:     image     processing.
   http://www.scipy-lectures.org/packages/scikit-image/.
   </p>
   <p class="bibitem" ><span class="biblabel">
 [3]<span class="bibsp">   </span></span><a 
 id="Xhaar1910theorie"></a>Alfred   Haar.      <a 
href="https://scholar.google.es/scholar?hl=es&as_sdt=0%2C5&q=A.+Haar.+Zur+Theorie+der+orthogolanen+Funktionen-Systeme.+Mathematische+Annalen%2C+69%3A331%E2%80%93371%2C+1910&btnG=" >Zur   theorie   der   orthogonalen   funktionensysteme</a>.
   <span 
class="ecti-1000">Mathematische Annalen</span>, 69(3):331–371, 1910.
                                                                  

                                                                  
   </p>
   <p class="bibitem" ><span class="biblabel">
 [4]<span class="bibsp">   </span></span><a 
 id="Xsolem__programming"></a>Jan Erik  Solem.     Programming  computer  vision  with  python  by.
   https://www.oreilly.com/library/view/programming-computer-vision/9781449341916/ch01.html.
   </p>
   <p class="bibitem" ><span class="biblabel">
 [5]<span class="bibsp">   </span></span><a 
 id="Xsovic2012signal"></a>Ana  Sovic  and  Damir  Sersic.    <a 
href="https://scholar.google.es/scholar?hl=en&as_sdt=0%2C5&q=Ana+Sovic+and+Damir+Sersic.+Signal+decomposition+methods+for+reducind+drawbacks+of+the+dwt&btnG=" >Signal  Decomposition  Methods  for
   Reducind Drawbacks of the DWT</a>. <span 
class="ecti-1000">Engineering Review</span>, 32(2):70–77, 2012.
   </p>
   <p class="bibitem" ><span class="biblabel">
 [6]<span class="bibsp">   </span></span><a 
 id="Xsweldens1997building"></a>Wim Sweldens and Peter Schröder.   <a 
href="https://scholar.google.es/scholar?hl=es&as_sdt=0%2C5&q=building+your+own+wavelets+at+home+1997+Sweldens+Schr%C3%B6der&btnG=" >Building your own wavelets at
   home</a>. <span 
class="ecti-1000">Wavelets in Computer Graphics</span>, 1997.
</p>
   </div>
<a 
 id="Q1-1-46"></a>
    
</body> 
</html>
                                                                  


