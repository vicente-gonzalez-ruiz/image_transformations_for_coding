<?xml version="1.0" encoding="iso-8859-1" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN" 
"http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd" > 
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>Image transformations for compression</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
<meta name="generator" content="TeX4ht (https://tug.org/tex4ht/)" /> 
<meta name="originator" content="TeX4ht (https://tug.org/tex4ht/)" /> 
<!-- xhtml,mathml,html --> 
<meta name="src" content="index.tex" /> 
<link rel="stylesheet" type="text/css" href="index.css" /> 
</head><body 
>
   <div class="maketitle">
                                                                  

                                                                  
                                                                  

                                                                  

<h2 class="titleHead">Image transformations for compression</h2>
 <div class="author" ><span 
class="ecrm-1200">Vicente Gonz</span><span 
class="ecrm-1200">&#x00E1;</span><span 
class="ecrm-1200">lez Ruiz</span></div><br />
<div class="date" ><span 
class="ecrm-1200">November 18, 2021</span></div>
   </div>
   <h3 class="likesectionHead"><a 
 id="x1-1000"></a>Contents</h3>
   <div class="tableofcontents">
   &#x00A0;<span class="sectionToc" >1 <a 
href="#x1-20001" id="QQ2-1-2">Insights</a></span>
<br />   &#x00A0;<span class="sectionToc" >2 <a 
href="#x1-30002" id="QQ2-1-3">Basic coding steps</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >2.1 <a 
href="#x1-40002.1" id="QQ2-1-4">Encoder</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >2.2 <a 
href="#x1-50002.2" id="QQ2-1-5">Decoder</a></span>
<br />   &#x00A0;<span class="sectionToc" >3 <a 
href="#x1-60003" id="QQ2-1-6">Splitting</a></span>
<br />   &#x00A0;<span class="sectionToc" >4                <a 
href="#x1-70004" id="QQ2-1-7">Transform                of                a                block
<!--l. 8--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi> <mo 
class="MathClass-rel">=</mo> <msubsup><mrow 
><mo 
class="MathClass-open">&#x007B;</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
><mo 
class="MathClass-close">&#x007D;</mo></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>N</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msubsup 
></math></a></span>
<br />   &#x00A0;<span class="sectionToc" >5 <a 
href="#x1-80005" id="QQ2-1-8">A color transform</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >5.1 <a 
href="#x1-90005.1" id="QQ2-1-9">Luminance and chrominance</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >5.2 <a 
href="#x1-100005.2" id="QQ2-1-10">Spectral &#x0028;color&#x0029; redundancy</a></span>
<br />   &#x00A0;<span class="sectionToc" >6 <a 
href="#x1-110006" id="QQ2-1-11">Chrominance subsampling</a></span>
<br />   &#x00A0;<span class="sectionToc" >7 <a 
href="#x1-120007" id="QQ2-1-12">Orthogonal transform</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >7.1 <a 
href="#x1-130007.1" id="QQ2-1-13">Orthonormal transform</a></span>
<br />   &#x00A0;<span class="sectionToc" >8 <a 
href="#x1-140008" id="QQ2-1-14">Signal energy</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >8.1 <a 
href="#x1-150008.1" id="QQ2-1-15">Energy conservation</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >8.2 <a 
href="#x1-160008.2" id="QQ2-1-16">Proof</a></span>
<br />   &#x00A0;<span class="sectionToc" >9 <a 
href="#x1-170009" id="QQ2-1-17">Expected value</a></span>
<br />   &#x00A0;<span class="sectionToc" >10 <a 
href="#x1-1800010" id="QQ2-1-18">Variance</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >10.1 <a 
href="#x1-1900010.1" id="QQ2-1-19">Covariance</a></span>
<br />   &#x00A0;<span class="sectionToc" >11 <a 
href="#x1-2000011" id="QQ2-1-20">Covariance matrix</a></span>
<br />   &#x00A0;<span class="sectionToc" >12 <a 
href="#x1-2100012" id="QQ2-1-21">Covariance matrix of a block-based transform</a></span>
<br />   &#x00A0;<span class="sectionToc" >13 <a 
href="#x1-2200013" id="QQ2-1-22">Correlation</a></span>
<br />   &#x00A0;<span class="sectionToc" >14 <a 
href="#x1-2300014" id="QQ2-1-23">Autocorrelation</a></span>
<br />   &#x00A0;<span class="sectionToc" >15 <a 
href="#x1-2400015" id="QQ2-1-24">Autocorrelation matrix</a></span>
<br />   &#x00A0;<span class="sectionToc" >16 <a 
href="#x1-2500016" id="QQ2-1-25">Eigenvalue and eigenvector</a></span>
                                                                  

                                                                  
<br />   &#x00A0;<span class="sectionToc" >17 <a 
href="#x1-2600017" id="QQ2-1-26">Coding gain</a></span>
<br />   &#x00A0;<span class="sectionToc" >18 <a 
href="#x1-2700018" id="QQ2-1-27">Karhunen-Lo&#x00E9;ve transform &#x0028;KLT&#x0029;</a></span>
<br />   &#x00A0;<span class="sectionToc" >19 <a 
href="#x1-2800019" id="QQ2-1-28">Discrete cosine transform &#x0028;DCT&#x0029;&#x0029;</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >19.1 <a 
href="#x1-3000019.1" id="QQ2-1-30">Properties fo DCT</a></span>
<br />   &#x00A0;<span class="sectionToc" >20 <a 
href="#x1-3100020" id="QQ2-1-31">Dyadic discrete wavelet transform &#x0028;DWT&#x0029;</a></span>
<br />   &#x00A0;<span class="sectionToc" >21 <a 
href="#x1-3200021" id="QQ2-1-32">Filters bank implementation</a></span>
<br />   &#x00A0;<span class="sectionToc" >22 <a 
href="#x1-3300022" id="QQ2-1-33">Lifting implementation&#x00A0;&#x005B;6&#x005D;</a></span>
<br />   &#x00A0;<span class="sectionToc" >23 <a 
href="#x1-3400023" id="QQ2-1-34"><!--l. 35--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>T</mi></math>-levels
1D-DWT</a></span>
<br />   &#x00A0;<span class="sectionToc" >24 <a 
href="#x1-3500024" id="QQ2-1-35">Subband indepency&#x00A0;&#x005B;7&#x005D;</a></span>
<br />   &#x00A0;<span class="sectionToc" >25 <a 
href="#x1-3600025" id="QQ2-1-36">Statistics of the subbands&#x00A0;&#x005B;7&#x005D;</a></span>
<br />   &#x00A0;<span class="sectionToc" >26 <a 
href="#x1-3700026" id="QQ2-1-37">Subband quantization&#x00A0;&#x005B;7&#x005D;</a></span>
<br />   &#x00A0;<span class="sectionToc" >27 <a 
href="#x1-3800027" id="QQ2-1-38">2D-DWT</a></span>
<br />   &#x00A0;<span class="sectionToc" >28 <a 
href="#x1-3900028" id="QQ2-1-39">Haar &#xFB01;lters&#x00A0;&#x005B;3&#x005D;</a></span>
<br />   &#x00A0;<span class="sectionToc" >29 <a 
href="#x1-4000029" id="QQ2-1-40">Linear &#x0028;5/3&#x0029; &#xFB01;lters&#x00A0;&#x005B;6&#x005D;</a></span>
<br />   &#x00A0;<span class="sectionToc" >30 <a 
href="#x1-4100030" id="QQ2-1-41">Orthogonal, orthonormal, and biorthogonal transforms</a></span>
<br />   &#x00A0;<span class="sectionToc" >31 <a 
href="#x1-4200031" id="QQ2-1-42">Quantization in the transform domain</a></span>
<br />   &#x00A0;<span class="sectionToc" >32 <a 
href="#x1-4300032" id="QQ2-1-43">Bit-planes progression</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >32.1 <a 
href="#x1-4400032.1" id="QQ2-1-44">Bit allocation &#x0028;bit-rate control&#x0029;</a></span>
<br />   &#x00A0;<span class="sectionToc" >33 <a 
href="#x1-4500033" id="QQ2-1-45">Bit allocation based on minimizing the quantization error</a></span>
<br />   &#x00A0;<span class="sectionToc" >34 <a 
href="#x1-4600034" id="QQ2-1-46">Bit allocation based on minimizing the variance of the quantization error</a></span>
<br />   &#x00A0;<span class="sectionToc" >35 <a 
href="#x1-4700035" id="QQ2-1-47">Encoding</a></span>
<br />   &#x00A0;<span class="sectionToc" >36 <a 
href="#x1-4800036" id="QQ2-1-48">Code-stream orderings and scalabilities</a></span>
<br />   &#x00A0;<span class="sectionToc" ><a 
href="#Q1-1-49">References</a></span>
   </div>
<!--l. 9--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">1   </span> <a 
 id="x1-20001"></a>Insights</h3>
     <ul class="itemize1">
     <li class="itemize">Signals can be represented at least in two di&#xFB00;erent domains: the signal
     domain &#x0028;for example, time in the case of sound of space in the case of
     image&#x0029; and the frequency domain &#x0028;in general, in a transform domain&#x0029;.
     </li>
     <li class="itemize">Transform coding is based on the idea that, in the transform domain,
     most of the energy of the signal can be compacted in a small number of
     &#x0028;transform&#x0029; coe&#xFB03;cients. This property can be interesting for increasing
     the coding e&#xFB03;ciency.
     </li>
     <li class="itemize">Scalar quantization of decorrelated transform coe&#xFB03;cients is more e&#xFB03;cient
     than direct scalar quantization of the samples&#x00A0;<span class="cite">&#x005B;<a 
href="#Xvetterli1995wavelets">7</a>&#x005D;</span>.</li></ul>
                                                                  

                                                                  
<!--l. 27--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">2   </span> <a 
 id="x1-30002"></a>Basic coding steps</h3>
<!--l. 28--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.1   </span> <a 
 id="x1-40002.1"></a>Encoder</h4>
<!--l. 29--><p class="noindent" >
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-4002x1">Split <!--l. 32--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>s</mi></mrow></math>
     into blocks of <!--l. 32--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>B</mi></mrow></math>
     samples, if required.
     </li>
     <li 
  class="enumerate" id="x1-4004x2">Transform each block.
     </li>
     <li 
  class="enumerate" id="x1-4006x3">&#x0028;Optional&#x0029; Quantize the coe&#xFB03;cients.
     </li>
     <li 
  class="enumerate" id="x1-4008x4">Lossless   encode   the   quantized   coe&#xFB03;cients,   performing   a   minimal
     bit-allocation.</li></ol>
<!--l. 42--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.2   </span> <a 
 id="x1-50002.2"></a>Decoder</h4>
<!--l. 43--><p class="noindent" >
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-5002x1">Decode the coe&#xFB03;cients of each block.
     </li>
     <li 
  class="enumerate" id="x1-5004x2">&#x0028;Optional&#x0029; &#x201C;Dequantize&#x201D; the coe&#xFB03;cients of each block.
     </li>
     <li 
  class="enumerate" id="x1-5006x3">Inverse-transform each block.
     </li>
     <li 
  class="enumerate" id="x1-5008x4">Join the blocks, if required.</li></ol>
<!--l. 55--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">3   </span> <a 
 id="x1-60003"></a>Splitting</h3>
<!--l. 56--><p class="noindent" >
                                                                  

                                                                  
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-6002x1">Divide <!--l. 59--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>x</mi> <mo 
class="MathClass-rel">=</mo> <msubsup><mrow 
><mo 
class="MathClass-open">&#x007B;</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
><mo 
class="MathClass-close">&#x007D;</mo></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>N</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msubsup 
></mrow></math>
     into <!--l. 59--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mo 
class="MathClass-open">&#x2308;</mo><mi 
>N</mi><mo 
class="MathClass-bin">&#x2215;</mo><mi 
>B</mi><mo 
class="MathClass-close">&#x2309;</mo></mrow></math>
     blocks <!--l. 60--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mo 
class="MathClass-open">&#x007B;</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-rel">&#x22EF;</mo><mspace width="0.17em" class="thinspace"/><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mo 
class="MathClass-open">&#x2308;</mo><mi 
>N</mi><mo 
class="MathClass-bin">&#x2215;</mo><mi 
>B</mi><mo 
class="MathClass-close">&#x2309;</mo></mrow></msub 
><mo 
class="MathClass-close">&#x007D;</mo></mrow></math>
     of <!--l. 60--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>B</mi></mrow></math>
     samples.</li></ol>
<!--l. 63--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">4   </span> <a 
 id="x1-70004"></a>Transform of a block <!--l. 63--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi> <mo 
class="MathClass-rel">=</mo> <msubsup><mrow 
><mo 
class="MathClass-open">&#x007B;</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
><mo 
class="MathClass-close">&#x007D;</mo></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>N</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msubsup 
></math></h3>
     <ul class="itemize1">
     <li class="itemize">In the forward transform the samples of the block
     <!--l. 66--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math>
     are projected &#x0028;notice that this operation is a <a 
href="https://en.wikipedia.org/wiki/Dot_product" >dot product</a>&#x0029; on a set of basis
     functions <table class="equation"><tr><td> <a 
 id="x1-7001r1"></a>
     <!--l. 70--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                     <msub><mrow 
><mi 
>y</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo><munderover accentunder="false" accent="false"><mrow  
><mo  
> &#x2211;</mo>
  </mrow><mrow 
><mi 
>i</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>N</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></munderover 
><msub><mrow 
><mi 
>a</mi></mrow><mrow 
>
<mi 
>n</mi><mo 
class="MathClass-punc">,</mo><mi 
>i</mi></mrow></msub 
><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-punc">,</mo>
                                                                                        <mstyle 
   id="x1-7002r0"  class="label" ></mstyle><!--endlabel-->
</math></td><td class="eq-no">&#x0028;forward_transform&#x0029;<a 
 id="x1-7003r0"></a></td></tr></table>
     <!--l. 74--><p class="noindent" >where <!--l. 74--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-open">&#x007B;</mo><msub><mrow 
><mi 
>y</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
><mo 
class="MathClass-close">&#x007D;</mo></math> is the transformed
     sequence and <!--l. 74--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-open">&#x007B;</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
><mo 
class="MathClass-close">&#x007D;</mo></math>
     is the original sequence.
     </p></li>
     <li class="itemize">The backward &#x0028;inverse&#x0029; transform restores the original samples <table class="equation"><tr><td> <a 
 id="x1-7004r1"></a>
                                                                  

                                                                  
     <!--l. 78--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                     <msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo><munderover accentunder="false" accent="false"><mrow  
><mo  
> &#x2211;</mo>
  </mrow><mrow 
><mi 
>i</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>N</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></munderover 
><msub><mrow 
><mi 
>b</mi></mrow><mrow 
>
<mi 
>n</mi><mo 
class="MathClass-punc">,</mo><mi 
>i</mi></mrow></msub 
><msub><mrow 
><mi 
>y</mi></mrow><mrow 
><mi 
>u</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo>
                                                                                        <mstyle 
   id="x1-7005r0"  class="label" ></mstyle><!--endlabel-->
</math></td><td class="eq-no">&#x0028;inverse_transform&#x0029;<a 
 id="x1-7006r0"></a></td></tr></table>
     </li>
     <li class="itemize">These equations can be written in matrix form as <table class="equation"><tr><td> <a 
 id="x1-7007r1"></a>
     <!--l. 84--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
<mi 
>y</mi> <mo 
class="MathClass-rel">=</mo> <mi 
>A</mi><mi 
>x</mi> <mo 
class="MathClass-rel">=</mo>  <mrow><mo fence="true" form="prefix"> [</mo><mrow><mtable  align="axis" style=""  
equalrows="false" columnlines="none none none none none none none none none" equalcolumns="false" class="array"><mtr><mtd 
class="array"  columnalign="center">   <msub><mrow 
><mi 
>a</mi></mrow><mrow 
><mn>0</mn><mo 
class="MathClass-punc">,</mo><mn>0</mn></mrow></msub 
>    </mtd><mtd 
class="array"  columnalign="center">     <mo 
class="MathClass-rel">&#x22EF;</mo>   </mtd><mtd 
class="array"  columnalign="center">   <msub><mrow 
><mi 
>a</mi></mrow><mrow 
><mi 
>B</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn><mo 
class="MathClass-punc">,</mo><mn>0</mn></mrow></msub 
>    </mtd>
</mtr> <mtr><mtd 
class="array"  columnalign="center">      <mi 
class="MathClass-op">&#x22EE;</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo>    </mtd><mtd 
class="array"  columnalign="center">        </mtd><mtd 
class="array"  columnalign="center">      <mi 
class="MathClass-op">&#x22EE;</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo>      </mtd></mtr> <mtr><mtd 
class="array"  columnalign="center"> <msub><mrow 
><mi 
>a</mi></mrow><mrow 
>
<mn>0</mn><mo 
class="MathClass-punc">,</mo><mi 
>B</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msub 
>  </mtd><mtd 
class="array"  columnalign="center">  <mi 
>c</mi><mi 
>d</mi><mi 
>o</mi><mi 
>t</mi><mi 
>s</mi> </mtd><mtd 
class="array"  columnalign="center"> <msub><mrow 
><mi 
>a</mi></mrow><mrow 
><mi 
>B</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn><mo 
class="MathClass-punc">,</mo><mi 
>B</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msub 
>  </mtd></mtr>
<!--*\c@MaxMatrixCols c--></mtable>                                                                                                                             </mrow><mo fence="true" form="postfix">]</mo></mrow>  <mrow><mo fence="true" form="prefix"> [</mo><mrow><mtable  align="axis" style=""  
equalrows="false" columnlines="none none none none none none none none none" equalcolumns="false" class="array"> <mtr><mtd 
class="array"  columnalign="center">     <msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>0</mn></mrow></msub 
>     </mtd>
</mtr> <mtr><mtd 
class="array"  columnalign="center">      <mi 
class="MathClass-op">&#x22EE;</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo>    </mtd></mtr> <mtr><mtd 
class="array"  columnalign="center"> <msub><mrow 
><mi 
>x</mi></mrow><mrow 
>
<mi 
>N</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo> </mtd></mtr><!--*\c@MaxMatrixCols c--></mtable>                                                                            </mrow><mo fence="true" form="postfix">]</mo></mrow>
                                                                                        <mstyle 
   id="x1-7008r0"  class="label" ></mstyle><!--endlabel-->
</math></td><td class="eq-no">&#x0028;forward_transform_matrix_form&#x0029;<a 
 id="x1-7009r0"></a></td></tr></table>
     <!--l. 97--><p class="noindent" >and </p><table class="equation"><tr><td> <a 
 id="x1-7010r1"></a>
     <!--l. 98--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                              <mi 
>x</mi> <mo 
class="MathClass-rel">=</mo> <mi 
>B</mi><mi 
>y</mi><mo 
class="MathClass-punc">,</mo>
                                                                                        <mstyle 
   id="x1-7011r0"  class="label" ></mstyle><!--endlabel-->
</math></td><td class="eq-no">&#x0028;inverse_transform_matrix_form&#x0029;<a 
 id="x1-7012r0"></a></td></tr></table>
     <!--l. 102--><p class="noindent" >where <!--l. 102--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>A</mi></mrow></math>
     and <!--l. 102--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>B</mi></mrow></math>
     are matrices, being </p><table class="equation"><tr><td> <a 
 id="x1-7013r1"></a>
                                                                  

                                                                  
     <!--l. 103--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
 <mtable  align="axis" style=""  
equalrows="false" equalcolumns="false" class="array"> <mtr><mtd 
class="array"  columnalign="left">  <msub><mrow 
><mo 
class="MathClass-open">&#x005B;</mo><mi 
>A</mi><mo 
class="MathClass-close">&#x005D;</mo></mrow><mrow 
><mi 
>i</mi><mo 
class="MathClass-punc">,</mo><mi 
>j</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>a</mi></mrow><mrow 
><mi 
>i</mi><mo 
class="MathClass-punc">,</mo><mi 
>j</mi></mrow></msub 
>  </mtd>
</mtr>  <mtr><mtd 
class="array"  columnalign="left">  <msub><mrow 
><mo 
class="MathClass-open">&#x005B;</mo><mi 
>B</mi><mo 
class="MathClass-close">&#x005D;</mo></mrow><mrow 
><mi 
>i</mi><mo 
class="MathClass-punc">,</mo><mi 
>j</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>i</mi><mo 
class="MathClass-punc">,</mo><mi 
>j</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo> </mtd></mtr><!--l--></mtable>
</math></td><td class="eq-no">&#x0028;1&#x0029;</td></tr></table>
     <!--l. 110--><p class="noindent" ><!--l. 110--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mo 
class="MathClass-open">&#x005B;</mo><mi 
>A</mi><mo 
class="MathClass-close">&#x005D;</mo></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></math>
     is called a basis vector of the transformation matrix
     <!--l. 110--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>A</mi></math>.
     If the transform is orthonormal, they form an orthonormal basis set.
     </p></li>
     <li class="itemize">In transform coding, <!--l. 114--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>A</mi></mrow></math>
     and <!--l. 114--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>B</mi></mrow></math> must be inverses
     of each other &#x0028;<!--l. 115--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>B</mi> <mo 
class="MathClass-rel">=</mo> <msup><mrow 
><mi 
>A</mi></mrow><mrow 
><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msup 
></mrow></math>&#x0029;,
     i.e.
     <table class="equation"><tr><td> <a 
 id="x1-7014r2"></a>
     <!--l. 117--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                          <mi 
>A</mi><mi 
>B</mi> <mo 
class="MathClass-rel">=</mo> <mi 
>B</mi><mi 
>A</mi> <mo 
class="MathClass-rel">=</mo> <mi 
>I</mi><mo 
class="MathClass-punc">,</mo>
</math></td><td class="eq-no">&#x0028;2&#x0029;</td></tr></table>
     <!--l. 121--><p class="noindent" >where <!--l. 121--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>I</mi></mrow></math>
     is the identity matrix.</p></li></ul>
<!--l. 124--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">5   </span> <a 
 id="x1-80005"></a>A color transform</h3>
<!--l. 125--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.1   </span> <a 
 id="x1-90005.1"></a>Luminance and chrominance</h4>
                                                                  

                                                                  
     <ul class="itemize1">
     <li class="itemize"><a 
href="https://en.wikipedia.org/wiki/Chrominance" >Chrominance</a> &#x0028;or chroma&#x0029; is the signal used in video systems to convey the
     color information of the picture or a video. It was de&#xFB01;ned to add the color
     signal to the black and white one in analog TV. Thus, the same signal,
     composed by two di&#xFB00;erent subsignals: Y and UV that can be isolated by
     &#xFB01;ltering, was compatible with both, black and white &#x0028;which only used Y&#x0029;
     and color ones &#x0028;that used <a 
href="https://en.wikipedia.org/wiki/YUV" >YUV</a>&#x0029;.</li></ul>
   <table class="equation"><tr><td> <a 
 id="x1-9001r3"></a>
<!--l. 139--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
<mrow><mo fence="true" form="prefix"> (</mo><mrow> <mtable  align="axis" style=""  
equalrows="false" equalcolumns="false" class="array"> <mtr><mtd 
class="array"  columnalign="center">  <mstyle 
class="text"><mtext  >Y</mtext></mstyle>  </mtd></mtr><mtr><mtd 
class="array"  columnalign="center"><mstyle 
class="text"><mtext  >U</mtext></mstyle></mtd>
</mtr>  <mtr><mtd 
class="array"  columnalign="center">  <mstyle 
class="text"><mtext  >V</mtext></mstyle>  </mtd></mtr><!--c--></mtable>                                                             </mrow><mo fence="true" form="postfix">)</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mrow><mo fence="true" form="prefix"> (</mo><mrow> <mtable  align="axis" style=""  
equalrows="false" columnlines="none none" equalcolumns="false" class="array"> <mtr><mtd 
class="array"  columnalign="right">        <mn>0</mn><mo 
class="MathClass-punc">,</mo><mn>2</mn><mn>9</mn><mn>9</mn> </mtd><mtd 
class="array"  columnalign="right">        <mn>0</mn><mo 
class="MathClass-punc">,</mo><mn>5</mn><mn>8</mn><mn>7</mn> </mtd><mtd 
class="array"  columnalign="right">        <mn>0</mn><mo 
class="MathClass-punc">,</mo><mn>1</mn><mn>4</mn><mn>4</mn> </mtd>
</mtr>  <mtr><mtd 
class="array"  columnalign="right">   <mo 
class="MathClass-bin">&#x2212;</mo> <mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>4</mn><mn>7</mn><mn>1</mn><mn>3</mn> </mtd><mtd 
class="array"  columnalign="right">   <mo 
class="MathClass-bin">&#x2212;</mo> <mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>2</mn><mn>8</mn><mn>8</mn><mn>8</mn><mn>6</mn> </mtd><mtd 
class="array"  columnalign="right">        <mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>4</mn><mn>3</mn><mn>6</mn> </mtd></mtr>  <mtr><mtd 
class="array"  columnalign="right">  <mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>6</mn><mn>1</mn><mn>5</mn> </mtd> <mtd 
class="array"  columnalign="right">  <mo 
class="MathClass-bin">&#x2212;</mo> <mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>5</mn><mn>1</mn><mn>4</mn><mn>9</mn><mn>9</mn> </mtd> <mtd 
class="array"  columnalign="right">  <mo 
class="MathClass-bin">&#x2212;</mo> <mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>0</mn><mn>0</mn><mn>0</mn><mn>1</mn></mtd>
</mtr>    <!--rrr--></mtable>                                                                                                   </mrow><mo fence="true" form="postfix">)</mo></mrow> <mrow><mo fence="true" form="prefix"> (</mo><mrow> <mtable  align="axis" style=""  
equalrows="false" equalcolumns="false" class="array"> <mtr><mtd 
class="array"  columnalign="center">  <mstyle 
class="text"><mtext  >R</mtext></mstyle>  </mtd></mtr>  <mtr><mtd 
class="array"  columnalign="center">  <mstyle 
class="text"><mtext  >G</mtext></mstyle></mtd>
</mtr>  <mtr><mtd 
class="array"  columnalign="center">  <mstyle 
class="text"><mtext  >B</mtext></mstyle>  </mtd></mtr> <!--c--></mtable>                                                                                                 </mrow><mo fence="true" form="postfix">)</mo></mrow>
</math></td><td class="eq-no">&#x0028;3&#x0029;</td></tr></table>
   <table class="equation"><tr><td> <a 
 id="x1-9002r4"></a>
<!--l. 163--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
<mrow><mo fence="true" form="prefix"> (</mo><mrow> <mtable  align="axis" style=""  
equalrows="false" equalcolumns="false" class="array"> <mtr><mtd 
class="array"  columnalign="center">  <mstyle 
class="text"><mtext  >R</mtext></mstyle>  </mtd></mtr><mtr><mtd 
class="array"  columnalign="center"><mstyle 
class="text"><mtext  >G</mtext></mstyle></mtd>
</mtr>  <mtr><mtd 
class="array"  columnalign="center">  <mstyle 
class="text"><mtext  >B</mtext></mstyle>  </mtd></mtr><!--c--></mtable>                                                             </mrow><mo fence="true" form="postfix">)</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mrow><mo fence="true" form="prefix"> (</mo><mrow> <mtable  align="axis" style=""  
equalrows="false" columnlines="none none" equalcolumns="false" class="array"> <mtr><mtd 
class="array"  columnalign="right">  <mn>1</mn> </mtd><mtd 
class="array"  columnalign="right">             <mn>0</mn> </mtd><mtd 
class="array"  columnalign="right">     <mn>1</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>3</mn><mn>9</mn><mn>8</mn><mn>3</mn> </mtd></mtr>  <mtr><mtd 
class="array"  columnalign="right">  <mn>1</mn> </mtd> <mtd 
class="array"  columnalign="right">  <mo 
class="MathClass-bin">&#x2212;</mo> <mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>3</mn><mn>9</mn><mn>4</mn><mn>6</mn><mn>5</mn> </mtd> <mtd 
class="array"  columnalign="right">  <mo 
class="MathClass-bin">&#x2212;</mo> <mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>5</mn><mn>8</mn><mn>0</mn><mn>6</mn><mn>0</mn></mtd>
</mtr>  <mtr><mtd 
class="array"  columnalign="right">  <mn>1</mn> </mtd><mtd 
class="array"  columnalign="right">     <mn>2</mn><mo 
class="MathClass-punc">.</mo><mn>0</mn><mn>3</mn><mn>2</mn><mn>1</mn><mn>1</mn> </mtd><mtd 
class="array"  columnalign="right">             <mn>0</mn> </mtd></mtr> <!--rrr--></mtable>                                                                </mrow><mo fence="true" form="postfix">)</mo></mrow> <mrow><mo fence="true" form="prefix"> (</mo><mrow> <mtable  align="axis" style=""  
equalrows="false" equalcolumns="false" class="array"> <mtr><mtd 
class="array"  columnalign="center"> <mstyle 
class="text"><mtext  >Y</mtext></mstyle>  </mtd></mtr>  <mtr><mtd 
class="array"  columnalign="center">  <mstyle 
class="text"><mtext  >U</mtext></mstyle></mtd>
</mtr>  <mtr><mtd 
class="array"  columnalign="center">  <mstyle 
class="text"><mtext  >V</mtext></mstyle>  </mtd></mtr> <!--c--></mtable>                                                                                                 </mrow><mo fence="true" form="postfix">)</mo></mrow>
</math></td><td class="eq-no">&#x0028;4&#x0029;</td></tr></table>
     <ul class="itemize1">
     <li class="itemize">Later, in digital video, the YUV color domain was called the <a 
href="https://en.wikipedia.org/wiki/YCbCr" >YCrCb color
     domain</a>.
     </li>
     <li class="itemize">Used, for example, in <a 
href="https://en.wikipedia.org/wiki/JPEG" >JPEG</a>.</li></ul>
                                                                  

                                                                  
<!--l. 195--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.2   </span> <a 
 id="x1-100005.2"></a>Spectral &#x0028;color&#x0029; redundancy</h4>
     <ul class="itemize1">
     <li class="itemize"><a 
href="https://en.wikipedia.org/wiki/RGB_color_model" ><!--l. 200--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mstyle 
class="text"><mtext  >RGB</mtext></mstyle></mrow></math>
     domain</a> is more redundant than the <a 
href="https://en.wikipedia.org/wiki/YUV" ><!--l. 201--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mstyle 
class="text"><mtext  >YUV</mtext></mstyle></mrow></math>
     domain</a>:</li></ul>
<!--l. 206--><p class="noindent" ><a 
href="https://nbviewer.jupyter.org/github/vicente-gonzalez-ruiz/image_transformations_for_coding/blob/master/color_redundancy.ipynb" >Color redundancy&#x00A0;<span class="cite">&#x005B;<a 
href="#Xbarr__image">1</a>,&#x00A0;<a 
href="#Xgouillart__scikit">2</a>,&#x00A0;<a 
href="#Xsolem__programming">4</a>&#x005D;</span></a>.
</p><!--l. 208--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">6   </span> <a 
 id="x1-110006"></a>Chrominance subsampling</h3>
<!--l. 210--><p class="noindent" ><a 
href="https://en.wikipedia.org/wiki/Chroma_subsampling" >The human visual system is more sensitive to the luma &#x0028;Y&#x0029; than to the chroma &#x0028;UV&#x0029;</a>.
This means than the chroma can be subsampled without a signi&#xFB01;cant loss of quality
in the images.
</p><!--l. 214--><p class="indent" >   <div style="text-align:center;"> <img width=600 src="color_subsampling.svg" /> </div> 
</p><!--l. 217--><p class="indent" >   <a 
href="https://nbviewer.jupyter.org/github/vicente-gonzalez-ruiz/image_transformations_for_coding/blob/master/chroma_subsampling.ipynb" >Chroma subsampling</a>.
</p><!--l. 219--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">7   </span> <a 
 id="x1-120007"></a>Orthogonal transform</h3>
     <ul class="itemize1">
     <li class="itemize">The rows of <!--l. 223--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>A</mi></mrow></math>
     &#x0028;<!--l. 223--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>a</mi></mrow><mrow 
><mi 
>k</mi><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-bin">&#x2217;</mo></mrow></msub 
></mrow></math>&#x0029;
     are refered to as the <span 
class="ecti-1000">basis vectors </span>of the transform, and should form an
     <span 
class="ecti-1000">orthogonal </span>basis set in order to provide maximum energy compactation.
     The rows can be also seen as the coe&#xFB03;cients of <!--l. 226--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>B</mi></mrow></math>
     &#xFB01;lters, being the &#xFB01;rst one &#x0028;<!--l. 227--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>i</mi> <mo 
class="MathClass-rel">=</mo> <mn>0</mn></mrow></math>&#x0029;
     the &#x201C;low-pass&#x201D;  one, which will produce the DC coe&#xFB03;cient, and the rest
     &#x0028;<!--l. 228--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>i</mi> <mo 
class="MathClass-rel">&#x2265;</mo> <mn>1</mn></mrow></math>&#x0029;
     the &#x201C;high-pass&#x201D; &#xFB01;lters, which will generate the AC &#x0028;Alternating Current&#x0029;
     coe&#xFB00;s. These <!--l. 229--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>B</mi></mrow></math>
     &#xFB01;lters form a &#xFB01;lter-bank where the overlapping between the frequency
     response of the &#xFB01;lters should be as small as possible if we want maximum
     energy compaction.</li></ul>
                                                                  

                                                                  
<!--l. 235--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">7.1   </span> <a 
 id="x1-130007.1"></a>Orthonormal transform</h4>
     <ul class="itemize1">
     <li class="itemize">If  the  basis  vectors  of  a  orthogonal  transform  are  unit  vectors,  the
     transform is said orthonormal.
     </li>
     <li class="itemize">For orthonormal transforms, it holds that
     <table class="equation"><tr><td> <a 
 id="x1-13001r5"></a>
     <!--l. 243--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                             <msup><mrow 
><mi 
>A</mi></mrow><mrow 
><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msup 
> <mo 
class="MathClass-rel">=</mo> <msup><mrow 
><mi 
>A</mi></mrow><mrow 
><mi 
>T</mi></mrow></msup 
><mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">&#x0028;5&#x0029;</td></tr></table>
     <!--l. 247--><p class="noindent" >Therefore, the pair of transforms refered by Eqs. &#x0028;forward_transform_matrix_form&#x0029;
     and &#x0028;inverse_transform_matrix_form&#x0029; can be written as
</p>
     <table class="equation"><tr><td> <a 
 id="x1-13002r6"></a>
     <!--l. 251--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
 <mtable  align="axis" style=""  
equalrows="false" equalcolumns="false" class="array"> <mtr><mtd 
class="array"  columnalign="left">  <mi 
>y</mi> <mo 
class="MathClass-rel">=</mo> <mi 
>A</mi><mi 
>x</mi>    </mtd>
</mtr>  <mtr><mtd 
class="array"  columnalign="left"> <mi 
>x</mi> <mo 
class="MathClass-rel">=</mo> <msup><mrow 
><mi 
>A</mi></mrow><mrow 
><mi 
>T</mi></mrow></msup 
><mi 
>y</mi><mo 
class="MathClass-punc">.</mo> </mtd></mtr><!--l--></mtable>
</math></td><td class="eq-no">&#x0028;6&#x0029;</td></tr></table>
     </li></ul>
                                                                  

                                                                  
<!--l. 259--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">8   </span> <a 
 id="x1-140008"></a>Signal energy</h3>
   <table class="equation"><tr><td> <a 
 id="x1-14001r7"></a>
<!--l. 260--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                       <mo 
class="MathClass-rel">&#x007C;</mo><mo 
class="MathClass-rel">&#x007C;</mo><mi 
>s</mi><mo 
class="MathClass-rel">&#x007C;</mo><msup><mrow 
><mo 
class="MathClass-rel">&#x007C;</mo></mrow><mrow 
><mn>2</mn></mrow></msup 
> <mo 
class="MathClass-rel">=</mo><munderover accentunder="false" accent="false"><mrow  
><mo  
> &#x2211;</mo>
  </mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>B</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></munderover 
><msubsup><mrow 
><mi 
>s</mi></mrow><mrow 
>
<mi 
>n</mi></mrow><mrow 
><mn>2</mn></mrow></msubsup 
><mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">&#x0028;7&#x0029;</td></tr></table>
<!--l. 264--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">8.1   </span> <a 
 id="x1-150008.1"></a>Energy conservation</h4>
<!--l. 265--><p class="noindent" >Orthonormal transforms are energy preserving. </p>
     <ul class="itemize1">
     <li class="itemize">If <!--l. 268--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>A</mi></mrow></math>
     is orthonormal &#x0028;also called <span 
class="ecti-1000">unitary</span>&#x0029;, the energy of the transformed signal
     is the equal to the original one:
     <table class="equation"><tr><td> <a 
 id="x1-15001r8"></a>
     <!--l. 271--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                           <mo 
class="MathClass-rel">&#x007C;</mo><mo 
class="MathClass-rel">&#x007C;</mo><mi 
>C</mi><mo 
class="MathClass-rel">&#x007C;</mo><msup><mrow 
><mo 
class="MathClass-rel">&#x007C;</mo></mrow><mrow 
><mn>2</mn></mrow></msup 
> <mo 
class="MathClass-rel">=</mo> <mo 
class="MathClass-rel">&#x007C;</mo><mo 
class="MathClass-rel">&#x007C;</mo><mi 
>c</mi><mo 
class="MathClass-rel">&#x007C;</mo><msup><mrow 
><mo 
class="MathClass-rel">&#x007C;</mo></mrow><mrow 
><mn>2</mn></mrow></msup 
><mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">&#x0028;8&#x0029;</td></tr></table>
     </li></ul>
                                                                  

                                                                  
<!--l. 276--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">8.2   </span> <a 
 id="x1-160008.2"></a>Proof</h4>
   <table class="equation"><tr><td> <a 
 id="x1-16001r9"></a>
<!--l. 277--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
        <mo 
class="MathClass-rel">&#x007C;</mo><mo 
class="MathClass-rel">&#x007C;</mo><mi 
>C</mi><mo 
class="MathClass-rel">&#x007C;</mo><msup><mrow 
><mo 
class="MathClass-rel">&#x007C;</mo></mrow><mrow 
><mn>2</mn></mrow></msup 
> <mo 
class="MathClass-rel">=</mo> <msup><mrow 
><mi 
>C</mi></mrow><mrow 
><mi 
>T</mi></mrow></msup 
><mi 
>C</mi> <mo 
class="MathClass-rel">=</mo> <msup><mrow 
><mo 
class="MathClass-open">&#x0028;</mo><mi 
>A</mi><mi 
>c</mi><mo 
class="MathClass-close">&#x0029;</mo></mrow><mrow 
><mi 
>T</mi></mrow></msup 
><mi 
>A</mi><mi 
>c</mi> <mo 
class="MathClass-rel">=</mo> <msup><mrow 
><mi 
>c</mi></mrow><mrow 
><mi 
>T</mi></mrow></msup 
><msup><mrow 
><mi 
>A</mi></mrow><mrow 
><mi 
>T</mi></mrow></msup 
><mi 
>A</mi><mi 
>c</mi> <mo 
class="MathClass-rel">=</mo> <msup><mrow 
><mi 
>c</mi></mrow><mrow 
><mi 
>T</mi></mrow></msup 
><mi 
>I</mi><mi 
>c</mi> <mo 
class="MathClass-rel">=</mo> <msup><mrow 
><mi 
>c</mi></mrow><mrow 
><mi 
>T</mi></mrow></msup 
><mi 
>c</mi> <mo 
class="MathClass-rel">=</mo> <mo 
class="MathClass-rel">&#x007C;</mo><mo 
class="MathClass-rel">&#x007C;</mo><mi 
>c</mi><mo 
class="MathClass-rel">&#x007C;</mo><msup><mrow 
><mo 
class="MathClass-rel">&#x007C;</mo></mrow><mrow 
><mn>2</mn></mrow></msup 
><mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">&#x0028;9&#x0029;</td></tr></table>
<!--l. 281--><p class="noindent" >Therefore, the sum of the squares of the transformed sequence is the same as the sum
of the squares of the original sequence.
</p><!--l. 284--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">9   </span> <a 
 id="x1-170009"></a><a 
href="https://en.wikipedia.org/wiki/Expected_value" >Expected value</a></h3>
<!--l. 285--><p class="noindent" >The expected value <!--l. 285--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi class="qopname">E</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mo 
class="MathClass-open">&#x005B;</mo><mi 
>X</mi><mo 
class="MathClass-close">&#x005D;</mo></mrow></math>
of a random variable <!--l. 285--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>X</mi></mrow></math>,
intuitively, is the long-run average value of repetitions of the experiment it represents.
Let <!--l. 287--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>X</mi></mrow></math>
be a random variable with a &#xFB01;nite number of &#xFB01;nite outcomes
<!--l. 288--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
></mrow></math>,
<!--l. 288--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
></mrow></math>,
<!--l. 288--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mo 
class="MathClass-rel">&#x22EF;</mo></mrow></math>,
<!--l. 288--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
></mrow></math> occurring with
probabilities <!--l. 289--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
></mrow></math>,
<!--l. 289--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
></mrow></math>,
<!--l. 289--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mo 
class="MathClass-rel">&#x22EF;</mo></mrow></math>,
<!--l. 289--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>k</mi></mrow></msub 
></mrow></math>,
respectively. The expected value &#x0028;or <span 
class="ecti-1000">expectation</span>&#x0029; of
<!--l. 290--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>X</mi></mrow></math> is
de&#xFB01;ned as
</p>
   <table class="equation"><tr><td> <a 
 id="x1-17001r10"></a>
                                                                  

                                                                  
<!--l. 293--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                        <mi class="qopname">E</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mo 
class="MathClass-open">&#x005B;</mo><mi 
>X</mi><mo 
class="MathClass-close">&#x005D;</mo> <mo 
class="MathClass-rel">=</mo><munderover accentunder="false" accent="false"><mrow  
><mo  
> &#x2211;</mo>
  </mrow><mrow 
><mi 
>i</mi><mo 
class="MathClass-rel">=</mo><mn>1</mn></mrow><mrow 
><mi 
>n</mi></mrow></munderover 
><msub><mrow 
><mi 
>X</mi></mrow><mrow 
>
<mi 
>i</mi></mrow></msub 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">&#x0028;10&#x0029;</td></tr></table>
<!--l. 297--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">10   </span> <a 
 id="x1-1800010"></a><a 
href="https://en.wikipedia.org/wiki/Variance" >Variance</a></h3>
<!--l. 298--><p class="noindent" >The variance of a random variable <!--l. 298--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>X</mi></mrow></math>
is the expected value of the squared deviation from the mean of
<!--l. 299--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>X</mi></mrow></math>:
</p>
   <table class="equation"><tr><td> <a 
 id="x1-18001r11"></a>
<!--l. 301--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
<msub><mrow 
><mi 
>&#x03C3;</mi></mrow><mrow 
><mi 
>X</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo><mi class="qopname"> Var</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mo 
class="MathClass-open">&#x0028;</mo><mi 
>X</mi><mo 
class="MathClass-close">&#x0029;</mo> <mo 
class="MathClass-rel">=</mo><mi class="qopname"> E</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--> <mrow><mo fence="true" form="prefix"> [</mo><mrow><msup><mrow 
><mo 
class="MathClass-open">&#x0028;</mo><mi 
>X</mi> <mo 
class="MathClass-bin">&#x2212;</mo><mi class="qopname"> E</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mo 
class="MathClass-open">&#x005B;</mo><mi 
>X</mi><mo 
class="MathClass-close">&#x005D;</mo><mo 
class="MathClass-close">&#x0029;</mo></mrow><mrow 
><mn>2</mn></mrow></msup 
></mrow><mo fence="true" form="postfix">]</mo></mrow> <mo 
class="MathClass-rel">=</mo><mi class="qopname"> E</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--> <mrow><mo fence="true" form="prefix"> [</mo><mrow><mo 
class="MathClass-open">&#x0028;</mo><mi 
>X</mi> <mo 
class="MathClass-bin">&#x2212;</mo><mi class="qopname"> E</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mo 
class="MathClass-open">&#x005B;</mo><mi 
>X</mi><mo 
class="MathClass-close">&#x005D;</mo><mo 
class="MathClass-close">&#x0029;</mo><mo 
class="MathClass-open">&#x0028;</mo><mi 
>X</mi> <mo 
class="MathClass-bin">&#x2212;</mo><mi class="qopname"> E</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mo 
class="MathClass-open">&#x005B;</mo><mi 
>X</mi><mo 
class="MathClass-close">&#x005D;</mo><mo 
class="MathClass-close">&#x0029;</mo></mrow><mo fence="true" form="postfix">]</mo></mrow> <mo 
class="MathClass-rel">=</mo><mi class="qopname"> E</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--> <mrow><mo fence="true" form="prefix"> [</mo><mrow><msup><mrow 
><mi 
>X</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
></mrow><mo fence="true" form="postfix">]</mo></mrow> <mo 
class="MathClass-bin">&#x2212;</mo><mi class="qopname"> E</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><msup><mrow 
><mo 
class="MathClass-open">&#x005B;</mo><mi 
>X</mi><mo 
class="MathClass-close">&#x005D;</mo></mrow><mrow 
><mn>2</mn></mrow></msup 
><mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">&#x0028;11&#x0029;</td></tr></table>
<!--l. 305--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">10.1   </span> <a 
 id="x1-1900010.1"></a><a 
href="https://en.wikipedia.org/wiki/Covariance" >Covariance</a></h4>
<!--l. 306--><p class="noindent" >The covariance <!--l. 306--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi class="qopname">cov</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mo 
class="MathClass-open">&#x0028;</mo><mi 
>X</mi><mo 
class="MathClass-punc">,</mo><mi 
>Y</mi> <mo 
class="MathClass-close">&#x0029;</mo></mrow></math>
is a measure of the joint variability of two random variables
<!--l. 307--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>X</mi></mrow></math>,
<!--l. 307--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>Y</mi> </mrow></math>,
de&#xFB01;ned as:
</p>
   <table class="equation"><tr><td> <a 
 id="x1-19001r12"></a>
                                                                  

                                                                  
<!--l. 309--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                 <mi class="qopname">cov</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mo 
class="MathClass-open">&#x0028;</mo><mi 
>X</mi><mo 
class="MathClass-punc">,</mo><mi 
>Y</mi> <mo 
class="MathClass-close">&#x0029;</mo> <mo 
class="MathClass-rel">=</mo><mi class="qopname"> E</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mstyle mathsize="1.19em"><mrow><mo fence="true" form="prefix"> [</mo><mrow></mrow><mo fence="true" form="postfix"></mo></mrow></mstyle><mo 
class="MathClass-open">&#x0028;</mo><mi 
>X</mi> <mo 
class="MathClass-bin">&#x2212;</mo><mi class="qopname"> E</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mo 
class="MathClass-open">&#x005B;</mo><mi 
>X</mi><mo 
class="MathClass-close">&#x005D;</mo><mo 
class="MathClass-close">&#x0029;</mo><mo 
class="MathClass-open">&#x0028;</mo><mi 
>Y</mi> <mo 
class="MathClass-bin">&#x2212;</mo><mi class="qopname"> E</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mo 
class="MathClass-open">&#x005B;</mo><mi 
>Y</mi> <mo 
class="MathClass-close">&#x005D;</mo><mo 
class="MathClass-close">&#x0029;</mo><mstyle mathsize="1.19em"><mrow><mo fence="true" form="prefix"> ]</mo><mrow></mrow><mo fence="true" form="postfix"></mo></mrow></mstyle><mo 
class="MathClass-punc">,</mo>
</math></td><td class="eq-no">&#x0028;12&#x0029;</td></tr></table>
<!--l. 314--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">11   </span> <a 
 id="x1-2000011"></a><a 
href="https://en.wikipedia.org/wiki/Covariance_matrix" >Covariance matrix</a></h3>
<!--l. 315--><p class="noindent" >A covariance matrix <!--l. 315--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>&#x03A3;</mi></mrow><mrow 
><mi 
>Z</mi></mrow></msub 
></mrow></math> is a
matrix whose element in the <!--l. 315--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>i</mi></mrow></math>,
<!--l. 316--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>j</mi></mrow></math> position is the covariance
between the <!--l. 316--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>i</mi></mrow></math>-th and
<!--l. 316--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>j</mi></mrow></math>-th elements of a random
vector <!--l. 317--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>Z</mi></mrow></math> &#x0028;a collection
of random variables <!--l. 318--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>Z</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></mrow></math>&#x0029;:
</p>
   <table class="equation"><tr><td> <a 
 id="x1-20001r13"></a>
<!--l. 320--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation"><msub><mrow 
>
<mi 
>&#x03A3;</mi></mrow><mrow 
><mi 
>Z</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo>  <mrow><mo fence="true" form="prefix"> [</mo><mrow><mtable  align="axis" style=""  
equalrows="false" columnlines="none none none none none none none none none" equalcolumns="false" class="array"><mtr><mtd 
class="array"  columnalign="center">  <mi class="qopname">E</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mo 
class="MathClass-open">&#x005B;</mo><mo 
class="MathClass-open">&#x0028;</mo><msub><mrow 
><mi 
>Z</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-bin">&#x2212;</mo> <msub><mrow 
><mi 
>&#x03BC;</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-close">&#x0029;</mo><mo 
class="MathClass-open">&#x0028;</mo><msub><mrow 
><mi 
>Z</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-bin">&#x2212;</mo> <msub><mrow 
><mi 
>&#x03BC;</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-close">&#x0029;</mo><mo 
class="MathClass-close">&#x005D;</mo>  </mtd><mtd 
class="array"  columnalign="center">  <mi class="qopname">E</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mo 
class="MathClass-open">&#x005B;</mo><mo 
class="MathClass-open">&#x0028;</mo><msub><mrow 
><mi 
>Z</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-bin">&#x2212;</mo> <msub><mrow 
><mi 
>&#x03BC;</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-close">&#x0029;</mo><mo 
class="MathClass-open">&#x0028;</mo><msub><mrow 
><mi 
>Z</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
> <mo 
class="MathClass-bin">&#x2212;</mo> <msub><mrow 
><mi 
>&#x03BC;</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><mo 
class="MathClass-close">&#x0029;</mo><mo 
class="MathClass-close">&#x005D;</mo>  </mtd><mtd 
class="array"  columnalign="center"> <mo 
class="MathClass-rel">&#x22EF;</mo> </mtd><mtd 
class="array"  columnalign="center">  <mi class="qopname">E</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mo 
class="MathClass-open">&#x005B;</mo><mo 
class="MathClass-open">&#x0028;</mo><msub><mrow 
><mi 
>Z</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-bin">&#x2212;</mo> <msub><mrow 
><mi 
>&#x03BC;</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-close">&#x0029;</mo><mo 
class="MathClass-open">&#x0028;</mo><msub><mrow 
><mi 
>Z</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
> <mo 
class="MathClass-bin">&#x2212;</mo> <msub><mrow 
><mi 
>&#x03BC;</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
><mo 
class="MathClass-close">&#x0029;</mo><mo 
class="MathClass-close">&#x005D;</mo>  </mtd></mtr> <mtr><mtd 
class="array"  columnalign="center"> </mtd>
</mtr><mtr><mtd 
class="array"  columnalign="center">  <mi class="qopname">E</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mo 
class="MathClass-open">&#x005B;</mo><mo 
class="MathClass-open">&#x0028;</mo><msub><mrow 
><mi 
>Z</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
> <mo 
class="MathClass-bin">&#x2212;</mo> <msub><mrow 
><mi 
>&#x03BC;</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><mo 
class="MathClass-close">&#x0029;</mo><mo 
class="MathClass-open">&#x0028;</mo><msub><mrow 
><mi 
>Z</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-bin">&#x2212;</mo> <msub><mrow 
><mi 
>&#x03BC;</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-close">&#x0029;</mo><mo 
class="MathClass-close">&#x005D;</mo>  </mtd><mtd 
class="array"  columnalign="center">  <mi class="qopname">E</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mo 
class="MathClass-open">&#x005B;</mo><mo 
class="MathClass-open">&#x0028;</mo><msub><mrow 
><mi 
>Z</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
> <mo 
class="MathClass-bin">&#x2212;</mo> <msub><mrow 
><mi 
>&#x03BC;</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><mo 
class="MathClass-close">&#x0029;</mo><mo 
class="MathClass-open">&#x0028;</mo><msub><mrow 
><mi 
>Z</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
> <mo 
class="MathClass-bin">&#x2212;</mo> <msub><mrow 
><mi 
>&#x03BC;</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><mo 
class="MathClass-close">&#x0029;</mo><mo 
class="MathClass-close">&#x005D;</mo>  </mtd><mtd 
class="array"  columnalign="center"> <mo 
class="MathClass-rel">&#x22EF;</mo> </mtd><mtd 
class="array"  columnalign="center">  <mi class="qopname">E</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mo 
class="MathClass-open">&#x005B;</mo><mo 
class="MathClass-open">&#x0028;</mo><msub><mrow 
><mi 
>Z</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
> <mo 
class="MathClass-bin">&#x2212;</mo> <msub><mrow 
><mi 
>&#x03BC;</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><mo 
class="MathClass-close">&#x0029;</mo><mo 
class="MathClass-open">&#x0028;</mo><msub><mrow 
><mi 
>Z</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
> <mo 
class="MathClass-bin">&#x2212;</mo> <msub><mrow 
><mi 
>&#x03BC;</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
><mo 
class="MathClass-close">&#x0029;</mo><mo 
class="MathClass-close">&#x005D;</mo>  </mtd></mtr> <mtr><mtd 
class="array"  columnalign="center"> </mtd></mtr> <mtr><mtd 
class="array"  columnalign="center"> <mi 
class="MathClass-op">&#x22EE;</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo> </mtd> <mtd 
class="array"  columnalign="center"> <mi 
class="MathClass-op">&#x22EE;</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo> </mtd> <mtd 
class="array"  columnalign="center"> <mo 
class="MathClass-rel">&#x22F1;</mo> </mtd> <mtd 
class="array"  columnalign="center"> <mi 
class="MathClass-op">&#x22EE;</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo></mtd></mtr> <mtr><mtd 
class="array"  columnalign="center"> </mtd>
</mtr><mtr><mtd 
class="array"  columnalign="center"> <mi class="qopname">E</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mo 
class="MathClass-open">&#x005B;</mo><mo 
class="MathClass-open">&#x0028;</mo><msub><mrow 
><mi 
>Z</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
> <mo 
class="MathClass-bin">&#x2212;</mo> <msub><mrow 
><mi 
>&#x03BC;</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
><mo 
class="MathClass-close">&#x0029;</mo><mo 
class="MathClass-open">&#x0028;</mo><msub><mrow 
><mi 
>Z</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-bin">&#x2212;</mo> <msub><mrow 
><mi 
>&#x03BC;</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-close">&#x0029;</mo><mo 
class="MathClass-close">&#x005D;</mo> </mtd><mtd 
class="array"  columnalign="center"> <mi class="qopname">E</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mo 
class="MathClass-open">&#x005B;</mo><mo 
class="MathClass-open">&#x0028;</mo><msub><mrow 
><mi 
>Z</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
> <mo 
class="MathClass-bin">&#x2212;</mo> <msub><mrow 
><mi 
>&#x03BC;</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
><mo 
class="MathClass-close">&#x0029;</mo><mo 
class="MathClass-open">&#x0028;</mo><msub><mrow 
><mi 
>Z</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
> <mo 
class="MathClass-bin">&#x2212;</mo> <msub><mrow 
><mi 
>&#x03BC;</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><mo 
class="MathClass-close">&#x0029;</mo><mo 
class="MathClass-close">&#x005D;</mo> </mtd><mtd 
class="array"  columnalign="center"> <mo 
class="MathClass-rel">&#x22EF;</mo> </mtd><mtd 
class="array"  columnalign="center"> <mi class="qopname">E</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mo 
class="MathClass-open">&#x005B;</mo><mo 
class="MathClass-open">&#x0028;</mo><msub><mrow 
><mi 
>Z</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
> <mo 
class="MathClass-bin">&#x2212;</mo> <msub><mrow 
><mi 
>&#x03BC;</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
><mo 
class="MathClass-close">&#x0029;</mo><mo 
class="MathClass-open">&#x0028;</mo><msub><mrow 
><mi 
>Z</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
> <mo 
class="MathClass-bin">&#x2212;</mo> <msub><mrow 
><mi 
>&#x03BC;</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
><mo 
class="MathClass-close">&#x0029;</mo><mo 
class="MathClass-close">&#x005D;</mo> </mtd></mtr> <!--*\c@MaxMatrixCols c--></mtable> </mrow><mo fence="true" form="postfix">]</mo></mrow><mo 
class="MathClass-rel">=</mo><mi class="qopname"> E</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--> <mrow><mo fence="true" form="prefix"> [</mo><mrow><mo 
class="MathClass-open">&#x0028;</mo><mi 
>Z</mi> <mo 
class="MathClass-bin">&#x2212;</mo><mi class="qopname"> E</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mo 
class="MathClass-open">&#x005B;</mo><mi 
>Z</mi><mo 
class="MathClass-close">&#x005D;</mo><mo 
class="MathClass-close">&#x0029;</mo><msup><mrow 
><mo 
class="MathClass-open">&#x0028;</mo><mi 
>Z</mi> <mo 
class="MathClass-bin">&#x2212;</mo><mi class="qopname"> E</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mo 
class="MathClass-open">&#x005B;</mo><mi 
>Z</mi><mo 
class="MathClass-close">&#x005D;</mo><mo 
class="MathClass-close">&#x0029;</mo></mrow><mrow 
><mi 
>T</mi></mrow></msup 
></mrow><mo fence="true" form="postfix">]</mo></mrow> <mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">&#x0028;13&#x0029;</td></tr></table>
<!--l. 333--><p class="indent" >   where </p><table class="equation"><tr><td> <a 
 id="x1-20002r14"></a>
                                                                  

                                                                  
<!--l. 333--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                            <msub><mrow 
><mi 
>&#x03BC;</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo><mi class="qopname"> E</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mo 
class="MathClass-open">&#x0028;</mo><msub><mrow 
><mi 
>Z</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">&#x0029;</mo><mo 
class="MathClass-punc">,</mo>
</math></td><td class="eq-no">&#x0028;14&#x0029;</td></tr></table>
<!--l. 335--><p class="indent" >   is the expected value of the <!--l. 335--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>i</mi></mrow></math>-th
entry in the vector <!--l. 336--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>Z</mi></mrow></math>.
</p><!--l. 338--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">12   </span> <a 
 id="x1-2100012"></a>Covariance matrix of a block-based transform</h3>
   <table class="equation"><tr><td> <a 
 id="x1-21001r15"></a>
<!--l. 339--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation"><msub><mrow 
>
<mi 
>&#x03A3;</mi></mrow><mrow 
><mi 
>S</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo><mi class="qopname"> E</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--> <mrow><mo fence="true" form="prefix"> [</mo><mrow><mo 
class="MathClass-open">&#x0028;</mo><mi 
>S</mi> <mo 
class="MathClass-bin">&#x2212;</mo><mi class="qopname"> E</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mo 
class="MathClass-open">&#x005B;</mo><mi 
>S</mi><mo 
class="MathClass-close">&#x005D;</mo><mo 
class="MathClass-close">&#x0029;</mo><msup><mrow 
><mo 
class="MathClass-open">&#x0028;</mo><mi 
>S</mi> <mo 
class="MathClass-bin">&#x2212;</mo><mi class="qopname"> E</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mo 
class="MathClass-open">&#x005B;</mo><mi 
>S</mi><mo 
class="MathClass-close">&#x005D;</mo><mo 
class="MathClass-close">&#x0029;</mo></mrow><mrow 
><mi 
>T</mi></mrow></msup 
></mrow><mo fence="true" form="postfix">]</mo></mrow> <mo 
class="MathClass-rel">=</mo><mi class="qopname"> E</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--> <mrow><mo fence="true" form="prefix"> [</mo><mrow><mi 
>A</mi><mo 
class="MathClass-open">&#x0028;</mo><mi 
>s</mi> <mo 
class="MathClass-bin">&#x2212;</mo><mi class="qopname"> E</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mo 
class="MathClass-open">&#x005B;</mo><mi 
>s</mi><mo 
class="MathClass-close">&#x005D;</mo><mo 
class="MathClass-close">&#x0029;</mo><msup><mrow 
><mo 
class="MathClass-open">&#x0028;</mo><mi 
>s</mi> <mo 
class="MathClass-bin">&#x2212;</mo><mi class="qopname"> E</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mo 
class="MathClass-open">&#x005B;</mo><mi 
>s</mi><mo 
class="MathClass-close">&#x005D;</mo><mo 
class="MathClass-close">&#x0029;</mo></mrow><mrow 
><mi 
>T</mi></mrow></msup 
><msup><mrow 
><mi 
>A</mi></mrow><mrow 
><mi 
>T</mi></mrow></msup 
></mrow><mo fence="true" form="postfix">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mi 
>A</mi><mi class="qopname">E</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--> <mrow><mo fence="true" form="prefix"> [</mo><mrow><mo 
class="MathClass-open">&#x0028;</mo><mi 
>s</mi> <mo 
class="MathClass-bin">&#x2212;</mo><mi class="qopname"> E</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mo 
class="MathClass-open">&#x005B;</mo><mi 
>s</mi><mo 
class="MathClass-close">&#x005D;</mo><mo 
class="MathClass-close">&#x0029;</mo><msup><mrow 
><mo 
class="MathClass-open">&#x0028;</mo><mi 
>s</mi> <mo 
class="MathClass-bin">&#x2212;</mo><mi class="qopname"> E</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mo 
class="MathClass-open">&#x005B;</mo><mi 
>s</mi><mo 
class="MathClass-close">&#x005D;</mo><mo 
class="MathClass-close">&#x0029;</mo></mrow><mrow 
><mi 
>T</mi></mrow></msup 
></mrow><mo fence="true" form="postfix">]</mo></mrow> <msup><mrow 
><mi 
>A</mi></mrow><mrow 
><mi 
>T</mi></mrow></msup 
> <mo 
class="MathClass-rel">=</mo> <mi 
>A</mi><msub><mrow 
><mi 
>&#x03A3;</mi></mrow><mrow 
>
<mi 
>s</mi></mrow></msub 
><msup><mrow 
><mi 
>A</mi></mrow><mrow 
><mi 
>T</mi></mrow></msup 
><mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">&#x0028;15&#x0029;</td></tr></table>
<!--l. 354--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">13   </span> <a 
 id="x1-2200013"></a><a 
href="https://en.wikipedia.org/wiki/Correlation_and_dependence" >Correlation</a></h3>
<!--l. 355--><p class="noindent" >The most familiar measure of dependence between two random variables
<!--l. 356--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>X</mi></mrow></math> and
<!--l. 356--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>Y</mi> </mrow></math> is the
Pearson product-moment correlation coe&#xFB03;cient, or &#x201C;Pearson&#x2019;s correlation
coe&#xFB03;cient&#x201D;, commonly called simply &#x201C;the correlation coe&#xFB03;cient&#x201D;. It is obtained by
dividing the covariance of the two variables by the product of their standard
deviations.
</p>
   <table class="equation"><tr><td> <a 
 id="x1-22001r16"></a>
                                                                  

                                                                  
<!--l. 361--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
         <msub><mrow 
><mi 
>&#x03C1;</mi></mrow><mrow 
><mi 
>X</mi><mo 
class="MathClass-punc">,</mo><mi 
>Y</mi> </mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mstyle mathvariant="normal"><mi 
>c</mi><mi 
>o</mi><mi 
>r</mi><mi 
>r</mi></mstyle><mo 
class="MathClass-open">&#x0028;</mo><mi 
>X</mi><mo 
class="MathClass-punc">,</mo><mi 
>Y</mi> <mo 
class="MathClass-close">&#x0029;</mo> <mo 
class="MathClass-rel">=</mo><mfrac><mrow> <mstyle mathvariant="normal"><mi 
>c</mi><mi 
>o</mi><mi 
>v</mi></mstyle><mo 
class="MathClass-open">&#x0028;</mo><mi 
>X</mi><mo 
class="MathClass-punc">,</mo><mi 
>Y</mi> <mo 
class="MathClass-close">&#x0029;</mo></mrow> 
   <mrow><msub><mrow 
><mi 
>&#x03C3;</mi></mrow><mrow 
><mi 
>X</mi></mrow></msub 
><msub><mrow 
><mi 
>&#x03C3;</mi></mrow><mrow 
><mi 
>Y</mi> </mrow></msub 
></mrow></mfrac>    <mo 
class="MathClass-rel">=</mo><mfrac><mrow> <mi class="qopname">E</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mo 
class="MathClass-open">&#x005B;</mo><mo 
class="MathClass-open">&#x0028;</mo><mi 
>X</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <msub><mrow 
><mi 
>&#x03BC;</mi></mrow><mrow 
><mi 
>X</mi></mrow></msub 
><mo 
class="MathClass-close">&#x0029;</mo><mo 
class="MathClass-open">&#x0028;</mo><mi 
>Y</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <msub><mrow 
><mi 
>&#x03BC;</mi></mrow><mrow 
><mi 
>Y</mi> </mrow></msub 
><mo 
class="MathClass-close">&#x0029;</mo><mo 
class="MathClass-close">&#x005D;</mo></mrow> 
          <mrow><msub><mrow 
><mi 
>&#x03C3;</mi></mrow><mrow 
><mi 
>X</mi></mrow></msub 
><msub><mrow 
><mi 
>&#x03C3;</mi></mrow><mrow 
><mi 
>Y</mi> </mrow></msub 
></mrow></mfrac>
</math></td><td class="eq-no">&#x0028;16&#x0029;</td></tr></table>
<!--l. 365--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">14   </span> <a 
 id="x1-2300014"></a><a 
href="https://en.wikipedia.org/wiki/Autocorrelation" >Autocorrelation</a></h3>
<!--l. 366--><p class="noindent" >Autocorrelation, also known as serial correlation, is the correlation of a signal
<!--l. 367--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>s</mi><mo 
class="MathClass-open">&#x005B;</mo><mi 
>t</mi><mo 
class="MathClass-close">&#x005D;</mo></mrow></math>
with a delayed copy of itself as a function of delay
<!--l. 368--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>s</mi><mo 
class="MathClass-open">&#x005B;</mo><mi 
>t</mi> <mo 
class="MathClass-bin">+</mo> <mi 
>&#x03C4;</mi><mo 
class="MathClass-close">&#x005D;</mo></mrow></math>.
</p>
   <table class="equation"><tr><td> <a 
 id="x1-23001r17"></a>
<!--l. 370--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
              <msub><mrow 
><mi 
>&#x03C1;</mi></mrow><mrow 
><mi 
>s</mi></mrow></msub 
><mo 
class="MathClass-open">&#x005B;</mo><mi 
>&#x03C4;</mi><mo 
class="MathClass-close">&#x005D;</mo> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>&#x03C1;</mi></mrow><mrow 
><mi 
>s</mi><mo 
class="MathClass-open">&#x005B;</mo><mi 
>t</mi><mo 
class="MathClass-close">&#x005D;</mo><mo 
class="MathClass-punc">,</mo><mi 
>s</mi><mo 
class="MathClass-open">&#x005B;</mo><mi 
>t</mi><mo 
class="MathClass-bin">+</mo><mi 
>&#x03C4;</mi><mo 
class="MathClass-close">&#x005D;</mo></mrow></msub 
> <mo 
class="MathClass-rel">=</mo><mfrac><mrow> <mi class="qopname">E</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mo 
class="MathClass-open">&#x005B;</mo><mo 
class="MathClass-open">&#x0028;</mo><mi 
>s</mi><mo 
class="MathClass-open">&#x005B;</mo><mi 
>t</mi><mo 
class="MathClass-close">&#x005D;</mo> <mo 
class="MathClass-bin">&#x2212;</mo> <mi 
>&#x03BC;</mi><mo 
class="MathClass-close">&#x0029;</mo><mo 
class="MathClass-open">&#x0028;</mo><mi 
>s</mi><mo 
class="MathClass-open">&#x005B;</mo><mi 
>t</mi> <mo 
class="MathClass-bin">+</mo> <mi 
>&#x03C4;</mi><mo 
class="MathClass-close">&#x005D;</mo> <mo 
class="MathClass-bin">&#x2212;</mo> <mi 
>&#x03BC;</mi><mo 
class="MathClass-close">&#x0029;</mo><mo 
class="MathClass-close">&#x005D;</mo></mrow> 
               <mrow><msup><mrow 
><mi 
>&#x03C3;</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
></mrow></mfrac>
</math></td><td class="eq-no">&#x0028;17&#x0029;</td></tr></table>
<!--l. 374--><p class="indent" >   where <!--l. 374--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03BC;</mi> <mo 
class="MathClass-rel">=</mo><mi class="qopname"> E</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mo 
class="MathClass-open">&#x0028;</mo><mi 
>s</mi><mo 
class="MathClass-open">&#x005B;</mo><mi 
>t</mi><mo 
class="MathClass-close">&#x005D;</mo><mo 
class="MathClass-close">&#x0029;</mo> <mo 
class="MathClass-rel">=</mo><mi class="qopname"> E</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mo 
class="MathClass-open">&#x0028;</mo><mi 
>s</mi><mo 
class="MathClass-open">&#x005B;</mo><mi 
>t</mi> <mo 
class="MathClass-bin">+</mo> <mi 
>&#x03C4;</mi><mo 
class="MathClass-close">&#x005D;</mo><mo 
class="MathClass-close">&#x0029;</mo></mrow></math>
and <!--l. 375--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03C3;</mi> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>&#x03C3;</mi></mrow><mrow 
><mi 
>s</mi><mo 
class="MathClass-open">&#x005B;</mo><mi 
>t</mi><mo 
class="MathClass-close">&#x005D;</mo></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>&#x03C3;</mi></mrow><mrow 
><mi 
>s</mi><mo 
class="MathClass-open">&#x005B;</mo><mi 
>t</mi><mo 
class="MathClass-bin">+</mo><mi 
>&#x03C4;</mi><mo 
class="MathClass-close">&#x005D;</mo></mrow></msub 
></mrow></math>.
</p><!--l. 377--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">15   </span> <a 
 id="x1-2400015"></a>Autocorrelation matrix</h3>
<!--l. 378--><p class="noindent" >The autocorrelation matrix of a random process
<!--l. 378--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>X</mi></mrow></math> is the
matrix <!--l. 379--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mo 
class="MathClass-open">&#x005B;</mo><mi 
>R</mi><mo 
class="MathClass-close">&#x005D;</mo></mrow></math>
de&#xFB01;ned by
</p>
                                                                  

                                                                  
   <table class="equation"><tr><td> <a 
 id="x1-24001r18"></a>
<!--l. 381--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                         <msub><mrow 
><mo 
class="MathClass-open">&#x005B;</mo><mi 
>R</mi><mo 
class="MathClass-close">&#x005D;</mo></mrow><mrow 
><mi 
>i</mi><mo 
class="MathClass-punc">,</mo><mi 
>j</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>&#x03C1;</mi></mrow><mrow 
><mi 
>X</mi></mrow></msub 
><mo 
class="MathClass-open">&#x005B;</mo><mo 
class="MathClass-rel">&#x007C;</mo><mi 
>i</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <mi 
>j</mi><mo 
class="MathClass-rel">&#x007C;</mo><mo 
class="MathClass-close">&#x005D;</mo><mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">&#x0028;18&#x0029;</td></tr></table>
<!--l. 385--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">16   </span> <a 
 id="x1-2500016"></a><a 
href="https://en.wikipedia.org/wiki/Eigenvalues_and_eigenvectors" >Eigenvalue and eigenvector</a></h3>
<!--l. 386--><p class="noindent" >In linear algebra, an eigenvector or characteristic vector
<!--l. 387--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mover class="overrightarrow"><mrow 
><mi 
>v</mi></mrow><mi 
class="MathClass-op">&#x20D7;</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo></mover></mrow></math> of a linear
transformation <!--l. 387--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>T</mi><mo 
class="MathClass-open">&#x0028;</mo><mo 
class="MathClass-close">&#x0029;</mo></mrow></math>
is a non-zero vector that changes by only a scalar factor
<!--l. 388--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03BB;</mi></mrow></math>
&#x0028;known as the eigenvalue, characteristic value, or characteristic root of
<!--l. 390--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mover class="overrightarrow"><mrow 
><mi 
>v</mi></mrow><mi 
class="MathClass-op">&#x20D7;</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo></mover></mrow></math>&#x0029;
when that linear transformation is applied to it:
</p>
   <table class="equation"><tr><td> <a 
 id="x1-25001r19"></a>
<!--l. 393--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                            <mi 
>T</mi><mo 
class="MathClass-open">&#x0028;</mo><mover class="overrightarrow"><mrow 
><mi 
>v</mi></mrow><mi 
class="MathClass-op">&#x20D7;</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo></mover><mo 
class="MathClass-close">&#x0029;</mo> <mo 
class="MathClass-rel">=</mo> <mi 
>&#x03BB;</mi><mover class="overrightarrow"><mrow 
><mi 
>v</mi></mrow><mi 
class="MathClass-op">&#x20D7;</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo></mover><mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">&#x0028;19&#x0029;</td></tr></table>
<!--l. 397--><p class="indent" >   When <!--l. 397--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>T</mi><mo 
class="MathClass-open">&#x0028;</mo><mo 
class="MathClass-close">&#x0029;</mo></mrow></math> can be
expressed by a matrix <!--l. 397--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>X</mi></mrow></math>,
we get
</p>
   <table class="equation"><tr><td> <a 
 id="x1-25002r20"></a>
                                                                  

                                                                  
<!--l. 399--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                            <mi 
>A</mi><mover class="overrightarrow"><mrow 
><mi 
>v</mi></mrow><mi 
class="MathClass-op">&#x20D7;</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo></mover> <mo 
class="MathClass-rel">=</mo> <mi 
>&#x03BB;</mi><mover class="overrightarrow"><mrow 
><mi 
>v</mi></mrow><mi 
class="MathClass-op">&#x20D7;</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo></mover><mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">&#x0028;20&#x0029;</td></tr></table>
<!--l. 403--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">17   </span> <a 
 id="x1-2600017"></a>Coding gain</h3>
     <ul class="itemize1">
     <li class="itemize">The coding gain measures the compaction level of the transform, which is
     de&#xFB01;ned as
     <table class="equation"><tr><td> <a 
 id="x1-26001r21"></a>
     <!--l. 409--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                    <mi 
>G</mi> <mo 
class="MathClass-rel">=</mo> <mfrac><mrow 
> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mi 
>N</mi></mrow></mfrac><munderover accentunder="false" accent="false"><mrow  
><mo  
> &#x2211;</mo>
  </mrow><mrow 
><mi 
>i</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>N</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></munderover 
><msubsup><mrow 
><mi 
>&#x03C3;</mi></mrow><mrow 
><msub><mrow 
>
<mi 
>y</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></mrow><mrow 
><mn>2</mn></mrow></msubsup 
></mrow> 
<mrow 
><mroot><mrow 
><munderover accentunder="false" accent="false"><mrow  
><mo  
> &#x220F;</mo>
  </mrow><mrow 
><mi 
>i</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>N</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></munderover 
><msubsup><mrow 
><mi 
>&#x03C3;</mi></mrow><mrow 
><msub><mrow 
>
<mi 
>y</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></mrow><mrow 
><mn>2</mn></mrow></msubsup 
></mrow><mrow 
><mi 
>N</mi></mrow></mroot></mrow></mfrac> <mo 
class="MathClass-punc">,</mo>
</math></td><td class="eq-no">&#x0028;21&#x0029;</td></tr></table>
     <!--l. 413--><p class="noindent" >where <!--l. 413--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msubsup><mrow 
><mi 
>&#x03C3;</mi></mrow><mrow 
><msub><mrow 
><mi 
>y</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></mrow><mrow 
><mn>2</mn></mrow></msubsup 
></mrow></math> is the variance
     of coe&#xFB03;cient <!--l. 413--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>y</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></mrow></math>.</p></li></ul>
<!--l. 416--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">18   </span> <a 
 id="x1-2700018"></a>Karhunen-Lo&#x00E9;ve transform &#x0028;KLT&#x0029;</h3>
                                                                  

                                                                  
     <ul class="itemize1">
     <li class="itemize">For the KLT, the rows of <!--l. 419--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>A</mi></mrow></math>
     &#x0028;the basis of the forward transform&#x0029; are the eigenvectors of the &#x0028;unnormalized&#x0029;
     autocorrelation matrix <!--l. 421--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mo 
class="MathClass-open">&#x005B;</mo><mi 
>R</mi><mo 
class="MathClass-close">&#x005D;</mo></mrow></math>
     of the signal <!--l. 421--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>s</mi></mrow></math>,
     where
     <table class="equation"><tr><td> <a 
 id="x1-27001r22"></a>
     <!--l. 423--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                      <msub><mrow 
><mo 
class="MathClass-open">&#x005B;</mo><mi 
>R</mi><mo 
class="MathClass-close">&#x005D;</mo></mrow><mrow 
><mi 
>i</mi><mo 
class="MathClass-punc">,</mo><mi 
>j</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo><mi class="qopname"> E</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mstyle mathsize="1.19em"><mrow><mo fence="true" form="prefix"> (</mo><mrow></mrow><mo fence="true" form="postfix"></mo></mrow></mstyle><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-bin">+</mo><mo 
class="MathClass-rel">&#x007C;</mo><mi 
>i</mi><mo 
class="MathClass-bin">&#x2212;</mo><mi 
>j</mi><mo 
class="MathClass-rel">&#x007C;</mo></mrow></msub 
><mstyle mathsize="1.19em"><mrow><mo fence="true" form="prefix"> )</mo><mrow></mrow><mo fence="true" form="postfix"></mo></mrow></mstyle><mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">&#x0028;22&#x0029;</td></tr></table>
     </li>
     <li class="itemize">It can be proven that KLT minimizes
     <!--l. 428--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mroot><mrow 
><msubsup><mrow 
><mi 
class="MathClass-op"> &#x220F;</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo>
  <!--nolimits--></mrow><mrow 
><mi 
>u</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>B</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msubsup 
><msubsup><mrow 
><mi 
>&#x03C3;</mi></mrow><mrow 
><msub><mrow 
><mi 
>C</mi></mrow><mrow 
><mi 
>u</mi></mrow></msub 
></mrow><mrow 
><mn>2</mn></mrow></msubsup 
></mrow><mrow 
><mi 
>B</mi></mrow></mroot></mrow></math>,
     and therefore, it provides the maximum coding gain.
     Unfortunately, the basis fuctions of the KLT depends on
     <!--l. 430--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>s</mi></mrow></math>. If
     <!--l. 430--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>S</mi></mrow></math>
     is non-<a 
href="https://en.wikipedia.org/wiki/Stationary_process" >stationary</a>, the autocorrelation matrix &#x0028;or the basis&#x0029; must be sent to the
     decoder &#x0028;to run the inverse transform&#x0029; as side information. However, if
     <!--l. 434--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>N</mi> <mo 
class="MathClass-rel">=</mo> <mn>2</mn></mrow></math>,
     the KLT is
     <table class="equation"><tr><td> <a 
 id="x1-27002r23"></a>
     <!--l. 436--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation"><msub><mrow 
>
<mi 
>A</mi></mrow><mrow 
><mstyle 
class="text"><mtext  >2-KLT</mtext></mstyle></mrow></msub 
> <mo 
class="MathClass-rel">=</mo>  <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><msqrt><mrow><mn>2</mn></mrow></msqrt></mrow></mfrac> <mrow><mo fence="true" form="prefix"> [</mo><mrow> <mtable  align="axis" style=""  
equalrows="false" columnlines="none" equalcolumns="false" class="array"> <mtr><mtd 
class="array"  columnalign="center"> <mn>1</mn> </mtd><mtd 
class="array"  columnalign="center">   <mn>1</mn>   </mtd></mtr>  <mtr><mtd 
class="array"  columnalign="center">  <mn>1</mn> </mtd> <mtd 
class="array"  columnalign="center">  <mo 
class="MathClass-bin">&#x2212;</mo> <mn>1</mn></mtd></mtr><!--cc--></mtable>                                                                                         </mrow><mo fence="true" form="postfix">]</mo></mrow>
</math></td><td class="eq-no">&#x0028;23&#x0029;</td></tr></table>
     <!--l. 446--><p class="noindent" >for all signals.</p></li></ul>
                                                                  

                                                                  
<!--l. 449--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">19   </span> <a 
 id="x1-2800019"></a>Discrete cosine transform &#x0028;DCT&#x0029;&#x0029;</h3>
<!--l. 451--><p class="noindent" ><a 
 id="definition"></a>
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">19.0.1   </span> <a 
 id="x1-2900019.0.1"></a>De&#xFB01;nition</h5>
     <ul class="itemize1">
     <li class="itemize">The forward &#x0028;direct&#x0029; transform is
     <table class="equation"><tr><td> <a 
 id="x1-29001r24"></a>
     <!--l. 457--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                      <msub><mrow 
><mi 
>S</mi></mrow><mrow 
><mi 
>u</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo>  <mfrac><mrow 
><msqrt><mrow><mn>2</mn></mrow></msqrt></mrow> 
<mrow 
><msqrt><mrow><mi 
>N</mi></mrow></msqrt></mrow></mfrac><mi 
>K</mi><mo 
class="MathClass-open">&#x0028;</mo><mi 
>u</mi><mo 
class="MathClass-close">&#x0029;</mo><munderover accentunder="false" accent="false"><mrow  
><mo  
>&#x2211;</mo>
  </mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>N</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></munderover 
><msub><mrow 
><mi 
>s</mi></mrow><mrow 
>
<mi 
>n</mi></mrow></msub 
><mi class="qopname"> cos</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--> <mfrac><mrow 
><mo 
class="MathClass-open">&#x0028;</mo><mn>2</mn><mi 
>n</mi> <mo 
class="MathClass-bin">+</mo> <mn>1</mn><mo 
class="MathClass-close">&#x0029;</mo><mi 
>&#x03C0;</mi><mi 
>u</mi></mrow> 
     <mrow 
><mn>2</mn><mi 
>n</mi></mrow></mfrac>     <mo 
class="MathClass-punc">,</mo>
</math></td><td class="eq-no">&#x0028;24&#x0029;</td></tr></table>
     <!--l. 462--><p class="noindent" >and the backward &#x0028;inverse&#x0029; transform is
</p>
     <table class="equation"><tr><td> <a 
 id="x1-29002r25"></a>
     <!--l. 464--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                      <msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo>  <mfrac><mrow 
><msqrt><mrow><mn>2</mn></mrow></msqrt></mrow> 
<mrow 
><msqrt><mrow><mi 
>N</mi></mrow></msqrt></mrow></mfrac><munderover accentunder="false" accent="false"><mrow  
><mo  
>&#x2211;</mo>
  </mrow><mrow 
><mi 
>u</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>N</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></munderover 
><mi 
>K</mi><mo 
class="MathClass-open">&#x0028;</mo><mi 
>u</mi><mo 
class="MathClass-close">&#x0029;</mo><msub><mrow 
><mi 
>S</mi></mrow><mrow 
>
<mi 
>u</mi></mrow></msub 
><mi class="qopname"> cos</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--> <mfrac><mrow 
><mo 
class="MathClass-open">&#x0028;</mo><mn>2</mn><mi 
>n</mi> <mo 
class="MathClass-bin">+</mo> <mn>1</mn><mo 
class="MathClass-close">&#x0029;</mo><mi 
>&#x03C0;</mi><mi 
>u</mi></mrow> 
     <mrow 
><mn>2</mn><mi 
>n</mi></mrow></mfrac>     <mo 
class="MathClass-punc">,</mo>
</math></td><td class="eq-no">&#x0028;25&#x0029;</td></tr></table>
     <!--l. 469--><p class="noindent" >where <!--l. 469--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>N</mi></mrow></math> is the number
     of pixels, and <!--l. 469--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
></mrow></math>
     denotes the <!--l. 469--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi></mrow></math>-th
     pixel of the image <!--l. 470--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>s</mi></mrow></math>,
     and
                                                                  

                                                                  
</p>
     <table class="equation"><tr><td> <a 
 id="x1-29003r26"></a>
     <!--l. 472--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
<mi 
>K</mi><mo 
class="MathClass-open">&#x0028;</mo><mi 
>u</mi><mo 
class="MathClass-close">&#x0029;</mo> <mo 
class="MathClass-rel">=</mo> <mrow><mo fence="true" form="prefix"> {</mo><mrow> <mtable  align="axis" style=""  
equalrows="false" columnlines="none" equalcolumns="false" class="array"> <mtr><mtd 
class="array"  columnalign="left">   <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><msqrt><mrow><mn>2</mn></mrow></msqrt></mrow></mfrac>  </mtd><mtd 
class="array"  columnalign="left">  <mstyle 
class="text"><mtext  >si</mtext></mstyle><mi 
>&#x00A0;</mi><mi 
>u</mi> <mo 
class="MathClass-rel">=</mo> <mn>0</mn>  </mtd>
</mtr>  <mtr><mtd 
class="array"  columnalign="left">  <mn>1</mn>    </mtd><mtd 
class="array"  columnalign="left">  <mstyle 
class="text"><mtext  >if</mtext></mstyle><mi 
>&#x00A0;</mi><mi 
>u</mi> <mo 
class="MathClass-rel">&#x003E;</mo> <mn>0</mn><mo 
class="MathClass-punc">.</mo> </mtd></mtr><!--ll--></mtable>                                                                    </mrow><mo fence="true" form="postfix"></mo></mrow>
</math></td><td class="eq-no">&#x0028;26&#x0029;</td></tr></table>
     </li></ul>
<!--l. 483--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">19.1   </span> <a 
 id="x1-3000019.1"></a>Properties fo DCT</h4>
<!--l. 484--><p class="noindent" >
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-30002x1"><span 
class="ecbx-1000">Separable</span>: the <!--l. 487--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>D</mi></mrow></math>-dimensional
     DCT can be computed using the <!--l. 488--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>1</mn></mrow></math>D
     DCT in each possible dimension.
     </li>
     <li 
  class="enumerate" id="x1-30004x2">In general, <span 
class="ecbx-1000">high energy compaction</span>: a small number of DCT coe&#xFB03;cients
     can reconstruct with a reasonable accuracy the original signal.
     </li>
     <li 
  class="enumerate" id="x1-30006x3"><span 
class="ecbx-1000">Unitary</span>: the energy of the DCT coe&#xFB03;cients is proportional to the energy
     of the samples.
     </li>
     <li 
  class="enumerate" id="x1-30008x4"><span 
class="ecbx-1000">Orthonormality</span>: DCT basis are orthonormal &#x0028;orthogonal + unitary&#x0029;
     and therefore, DCT coe&#xFB03;cients are uncorrelated.</li></ol>
<!--l. 502--><p class="noindent" ><a 
href="https://nbviewer.jupyter.org/github/vicente-gonzalez-ruiz/image_transformations_for_coding/blob/master/DCT.ipynb" >DCT</a>.
</p><!--l. 504--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">20   </span> <a 
 id="x1-3100020"></a>Dyadic discrete wavelet transform &#x0028;DWT&#x0029;</h3>
<!--l. 505--><p class="noindent" >Key <a 
href="https://en.wikipedia.org/wiki/Discrete_wavelet_transform" >features</a>:
</p><!--l. 507--><p class="indent" >
                                                                  

                                                                  
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-31002x1"><span 
class="ecbx-1000">High spectral compaction</span>, specially when transient signals are present.
     </li>
     <li 
  class="enumerate" id="x1-31004x2"><span 
class="ecbx-1000">Multiresolution representation</span>: it is easy to recover a reduced version
     of the original image if only a sub-set of the coe&#xFB03;cients is proccesed.</li></ol>
<!--l. 518--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">21   </span> <a 
 id="x1-3200021"></a>Filters bank implementation</h3>
<!--l. 519--><p class="noindent" >Where: </p><table class="equation"><tr><td> <a 
 id="x1-32001r27"></a>
<!--l. 519--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                   <mi 
>s</mi> <mo 
class="MathClass-rel">=</mo> <mo 
class="MathClass-open">&#x0028;</mo><msup><mrow 
><mi 
>&#x2191;</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
><mo 
class="MathClass-open">&#x0028;</mo><mi 
>L</mi><mo 
class="MathClass-close">&#x0029;</mo> <mo 
class="MathClass-bin">&#x2217;</mo><msub><mrow 
><mstyle 
class="text"><mtext  >s</mtext></mstyle></mrow><mrow 
>
<mi 
>L</mi></mrow></msub 
><mo 
class="MathClass-close">&#x0029;</mo> <mo 
class="MathClass-bin">+</mo> <mo 
class="MathClass-open">&#x0028;</mo><msup><mrow 
><mi 
>&#x2191;</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
><mo 
class="MathClass-open">&#x0028;</mo><mi 
>H</mi><mo 
class="MathClass-close">&#x0029;</mo> <mo 
class="MathClass-bin">&#x2217;</mo><msub><mrow 
><mstyle 
class="text"><mtext  >s</mtext></mstyle></mrow><mrow 
>
<mi 
>H</mi></mrow></msub 
><mo 
class="MathClass-close">&#x0029;</mo>
</math></td><td class="eq-no">&#x0028;27&#x0029;</td></tr></table>
<!--l. 521--><p class="indent" >   and </p><table class="equation"><tr><td> <a 
 id="x1-32002r28"></a>
<!--l. 521--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
 <mtable  align="axis" style=""  
equalrows="false" columnlines="none none" equalcolumns="false" class="array"> <mtr><mtd 
class="array"  columnalign="right">  <mi 
>L</mi> </mtd><mtd 
class="array"  columnalign="center">  <mo 
class="MathClass-rel">=</mo> </mtd><mtd 
class="array"  columnalign="left">  <msup><mrow 
><mi 
>&#x2193;</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
><mo 
class="MathClass-open">&#x0028;</mo><mi 
>s</mi> <mo 
class="MathClass-bin">&#x2217;</mo><msub><mrow 
><mstyle 
class="text"><mtext  >a</mtext></mstyle></mrow><mrow 
><mi 
>L</mi></mrow></msub 
><mo 
class="MathClass-close">&#x0029;</mo>   </mtd>
</mtr>  <mtr><mtd 
class="array"  columnalign="right">  <mi 
>H</mi> </mtd><mtd 
class="array"  columnalign="center">  <mo 
class="MathClass-rel">=</mo> </mtd><mtd 
class="array"  columnalign="left">  <msup><mrow 
><mi 
>&#x2193;</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
><mo 
class="MathClass-open">&#x0028;</mo><mi 
>s</mi> <mo 
class="MathClass-bin">&#x2217;</mo><msub><mrow 
><mstyle 
class="text"><mtext  >a</mtext></mstyle></mrow><mrow 
><mi 
>H</mi></mrow></msub 
><mo 
class="MathClass-close">&#x0029;</mo><mo 
class="MathClass-punc">.</mo> </mtd></mtr><!--rcl--></mtable>
</math></td><td class="eq-no">&#x0028;28&#x0029;</td></tr></table>
<!--l. 528--><p class="indent" >   Comments:
</p><!--l. 530--><p class="indent" >
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-32004x1"><!--l. 532--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mstyle 
class="text"><mtext  >a</mtext></mstyle></mrow><mrow 
><mi 
>L</mi></mrow></msub 
></mrow></math>
     and <!--l. 532--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mstyle 
class="text"><mtext  >a</mtext></mstyle></mrow><mrow 
><mi 
>H</mi></mrow></msub 
></mrow></math>
     are the transfer function &#x0028;the transfer function of a &#xFB01;lter is the response
     of that &#xFB01;lter to the unitary impulse function &#x0028;Dirac&#x2019;s delta&#x0029;&#x0029; of a low-pass
     &#xFB01;lter  and  high-pass  &#xFB01;lter,  respectively,  that  have  been  designed  to  be
                                                                  

                                                                  
     complementary &#x0028;ideally, in <!--l. 536--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>L</mi></mrow></math>
     we only found the frequencies of <!--l. 537--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>s</mi></mrow></math>
     that are not in <!--l. 537--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>H</mi></mrow></math>,
     and viceversa&#x0029;. When this is true, it is said the we are using a perfect-reconstruction
     quadrature-mirror &#xFB01;lter-bank and the DWT is <span 
class="ecti-1000">biorthogonal</span>.
     </li>
     <li 
  class="enumerate" id="x1-32006x2">In the wavelet theory, <!--l. 541--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mstyle 
class="text"><mtext  >s</mtext></mstyle></mrow><mrow 
><mi 
>L</mi></mrow></msub 
></mrow></math>
     is named the <span 
class="ecti-1000">scale function </span>and <!--l. 542--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mstyle 
class="text"><mtext  >s</mtext></mstyle></mrow><mrow 
><mi 
>H</mi></mrow></msub 
></mrow></math>
     the <span 
class="ecti-1000">mother function </span>or <span 
class="ecti-1000">wavelet basis function</span>. The coe&#xFB03;cients of <!--l. 543--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>L</mi></mrow></math>
     are also known as the <span 
class="ecti-1000">scale coe&#xFB03;ents </span>and the coe&#xFB00;cientes of <!--l. 544--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>H</mi></mrow></math>
     the <span 
class="ecti-1000">wavelet coe&#xFB03;cients</span>&#x00A0;<span class="cite">&#x005B;<a 
href="#Xsovic2012signal">5</a>&#x005D;</span>.
     </li>
     <li 
  class="enumerate" id="x1-32008x3"><!--l. 547--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msup><mrow 
><mi 
>&#x2193;</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
><mo 
class="MathClass-open">&#x0028;</mo><mo 
class="MathClass-bin">&#x22C5;</mo><mo 
class="MathClass-close">&#x0029;</mo></mrow></math>
     and <!--l. 547--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msup><mrow 
><mi 
>&#x2191;</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
><mo 
class="MathClass-open">&#x0028;</mo><mo 
class="MathClass-bin">&#x22C5;</mo><mo 
class="MathClass-close">&#x0029;</mo></mrow></math>
     donote the subsampling and oversampling operations:</li></ol>
   <table class="equation"><tr><td> <a 
 id="x1-32009r29"></a>
<!--l. 551--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                           <msub><mrow 
><mo 
class="MathClass-open">&#x0028;</mo><msup><mrow 
><mi 
>&#x2193;</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
><mo 
class="MathClass-open">&#x0028;</mo><mi 
>s</mi><mo 
class="MathClass-close">&#x0029;</mo><mo 
class="MathClass-close">&#x0029;</mo></mrow><mrow 
>
<mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi></mrow></msub 
>
</math></td><td class="eq-no">&#x0028;29&#x0029;</td></tr></table>
<!--l. 555--><p class="indent" >   and
</p>
   <table class="equation"><tr><td> <a 
 id="x1-32010r30"></a>
<!--l. 557--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation"><msub><mrow 
>
<mo 
class="MathClass-open">&#x0028;</mo><msup><mrow 
><mi 
>&#x2191;</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
><mo 
class="MathClass-open">&#x0028;</mo><mi 
>s</mi><mo 
class="MathClass-close">&#x0029;</mo><mo 
class="MathClass-close">&#x0029;</mo></mrow><mrow 
>
<mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mrow><mo fence="true" form="prefix"> {</mo><mrow> <mtable  align="axis" style=""  
equalrows="false" columnlines="none" equalcolumns="false" class="array"> <mtr><mtd 
class="array"  columnalign="left">  <msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>i</mi><mo 
class="MathClass-bin">&#x2215;</mo><mn>2</mn></mrow></msub 
>  </mtd><mtd 
class="array"  columnalign="left">  <mstyle 
class="text"><mtext  >if&#x00A0;</mtext><mstyle 
class="math"><mi 
>i</mi></mstyle><mtext  >&#x00A0;if&#x00A0;even</mtext></mstyle>  </mtd>
</mtr>  <mtr><mtd 
class="array"  columnalign="left">  <mn>0</mn>     </mtd><mtd 
class="array"  columnalign="left">  <mstyle 
class="text"><mtext  >otherwise</mtext></mstyle><mo 
class="MathClass-punc">.</mo> </mtd></mtr> <!--ll--></mtable>                                                                  </mrow><mo fence="true" form="postfix"></mo></mrow>
</math></td><td class="eq-no">&#x0028;30&#x0029;</td></tr></table>
                                                                  

                                                                  
<!--l. 567--><p class="indent" >   where <!--l. 567--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></mrow></math>
if the <!--l. 567--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>i</mi></mrow></math>-th
sample of <!--l. 567--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>s</mi></mrow></math>.
</p><!--l. 569--><p class="indent" >
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-32012x4"><!--l. 572--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mo 
class="MathClass-bin">&#x2217;</mo></mrow></math>
     is the convolution operator.
     </li>
     <li 
  class="enumerate" id="x1-32014x5">Notice that half of the &#xFB01;ltered samples are wasted.</li></ol>
<!--l. 577--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">22   </span> <a 
 id="x1-3300022"></a>Lifting implementation&#x00A0;<span class="cite">&#x005B;<a 
href="#Xsweldens1997building">6</a>&#x005D;</span></h3>
<!--l. 578--><p class="noindent" ><div style="text-align:center;"> <img width=1000 src="lifting.svg" /> </div> 
</p><!--l. 580--><p class="indent" >   Comments:
</p><!--l. 582--><p class="indent" >
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-33002x1"><table class="equation"><tr><td> <a 
 id="x1-33003r31"></a>
     <!--l. 585--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                     <msub><mrow 
><mi 
>H</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi><mo 
class="MathClass-bin">+</mo><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-bin">&#x2212;</mo><mi 
mathvariant="bold-script">&#x1D4AB;</mi><msub><mrow 
><mo 
class="MathClass-open">&#x0028;</mo><mo 
class="MathClass-open">&#x007B;</mo><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">&#x007D;</mo><mo 
class="MathClass-close">&#x0029;</mo></mrow><mrow 
><mi 
>i</mi></mrow></msub 
>
                                                                                                          <mstyle 
   id="x1-33004r30"  class="label" ></mstyle><!--endlabel-->
</math></td><td class="eq-no">&#x0028;PredictionStep&#x0029;<a 
 id="x1-33005r30"></a></td></tr></table>
     </li></ol>
   <table class="equation"><tr><td> <a 
 id="x1-33006r31"></a>
                                                                  

                                                                  
<!--l. 592--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                         <msub><mrow 
><mi 
>L</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mo 
class="MathClass-open">&#x007B;</mo><mi 
mathvariant="bold-script">&#x1D4B0;</mi><mo 
class="MathClass-open">&#x0028;</mo><mi 
>H</mi><mo 
class="MathClass-close">&#x0029;</mo><mo 
class="MathClass-close">&#x007D;</mo></mrow><mrow 
><mi 
>i</mi></mrow></msub 
>
                                                                  <mstyle 
   id="x1-33007r30"  class="label" ></mstyle><!--endlabel-->
</math></td><td class="eq-no">&#x0028;UpdateStep&#x0029;<a 
 id="x1-33008r30"></a></td></tr></table>
<!--l. 598--><p class="indent" >
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-33010x2">Subsampled signals <!--l. 602--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mo 
class="MathClass-open">&#x007B;</mo><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">&#x007D;</mo></mrow></math>
     and <!--l. 602--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mo 
class="MathClass-open">&#x007B;</mo><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi><mo 
class="MathClass-bin">+</mo><mn>1</mn></mrow></msub 
><mo 
class="MathClass-close">&#x007D;</mo></mrow></math>
     can been computed by using</li></ol>
   <table class="equation-star"><tr><td>
<!--l. 606--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                        <mo 
class="MathClass-open">&#x007B;</mo><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi><mo 
class="MathClass-bin">+</mo><mn>1</mn></mrow></msub 
><mo 
class="MathClass-close">&#x007D;</mo> <mo 
class="MathClass-rel">=</mo><msup><mrow 
><mi 
>&#x2193;</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
><mo 
class="MathClass-open">&#x0028;</mo><msup><mrow 
><mi 
>Z</mi></mrow><mrow 
><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msup 
><mo 
class="MathClass-open">&#x0028;</mo><mi 
>s</mi><mo 
class="MathClass-close">&#x0029;</mo><mo 
class="MathClass-close">&#x0029;</mo>
</math></td></tr></table>
<!--l. 610--><p class="indent" >   and
</p>
   <table class="equation-star"><tr><td>
<!--l. 612--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                           <mo 
class="MathClass-open">&#x007B;</mo><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">&#x007D;</mo> <mo 
class="MathClass-rel">=</mo><msup><mrow 
><mi 
>&#x2193;</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
><mo 
class="MathClass-open">&#x0028;</mo><mi 
>s</mi><mo 
class="MathClass-close">&#x0029;</mo><mo 
class="MathClass-punc">,</mo>
</math></td></tr></table>
<!--l. 616--><p class="indent" >   where <!--l. 616--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msup><mrow 
><mi 
>Z</mi></mrow><mrow 
><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msup 
></mrow></math>
represents the one sample delay function.
</p><!--l. 618--><p class="indent" >
                                                                  

                                                                  
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-33012x3"><!--l. 622--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>H</mi></mrow></math>
     has tipically less energy and variance and entropy than <!--l. 623--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mo 
class="MathClass-open">&#x007B;</mo><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi><mo 
class="MathClass-bin">+</mo><mn>1</mn></mrow></msub 
><mo 
class="MathClass-close">&#x007D;</mo></mrow></math>.
     </li>
     <li 
  class="enumerate" id="x1-33014x4"><!--l. 625--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>L</mi></mrow></math>
     has less aliasing than <!--l. 625--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mo 
class="MathClass-open">&#x007B;</mo><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">&#x007D;</mo></mrow></math>
     &#x0028;notice that <!--l. 625--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>L</mi></mrow></math>
     has not been low-pass &#xFB01;ltered before subsampling it&#x0029;.</li></ol>
<!--l. 629--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">23   </span> <a 
 id="x1-3400023"></a><!--l. 629--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>T</mi></math>-levels
1D-DWT</h3>
<!--l. 630--><p class="noindent" ><div style="text-align:center;"> <img width=1000 src="n_levels_dwt1d.svg" /> </div> 
</p><!--l. 632--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">24   </span> <a 
 id="x1-3500024"></a>Subband indepency&#x00A0;<span class="cite">&#x005B;<a 
href="#Xvetterli1995wavelets">7</a>&#x005D;</span></h3>
<!--l. 633--><p class="noindent" >While the subbands are only independent if the input is a Gaussian random variable
and the &#xFB01;lters decorrelate the subbands &#x0028;the &#xFB01;lters are ideal&#x0029;, the independence
assumption is ofte made because it makes he system simpler.
</p><!--l. 638--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">25   </span> <a 
 id="x1-3600025"></a>Statistics of the subbands&#x00A0;<span class="cite">&#x005B;<a 
href="#Xvetterli1995wavelets">7</a>&#x005D;</span></h3>
<!--l. 639--><p class="noindent" >The PDF of the coe&#xFB03;cients of the high-frequency subbands peaks in zero and falls o&#xFB00;
very rapidly. While is it often modeled as a Laplacian distribution, it is actually
falling o&#xFB00; faster. It is more adequately &#xFB01;tted with a generalized Gaussian PDF with
faster decay than the Laplacian PDF.
</p><!--l. 645--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">26   </span> <a 
 id="x1-3700026"></a>Subband quantization&#x00A0;<span class="cite">&#x005B;<a 
href="#Xvetterli1995wavelets">7</a>&#x005D;</span></h3>
<!--l. 646--><p class="noindent" >Besides the low band compression, which uses known image coding methods, the bulk
of the compression is obtained by appropiate quantization of the high bands. The
following <a 
href="https://vicente-gonzalez-ruiz.github.io/quantization/" >quantizers</a> are typically used:
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-37002x1">Lloyd quantizers &#xFB01;tted to the PDF of the particular subband.
                                                                  

                                                                  
     </li>
     <li 
  class="enumerate" id="x1-37004x2">Deadzone  uniform  quantizers,  since  they  tend  to  eliminate  what  is
     essentially noise.</li></ol>
<!--l. 655--><p class="noindent" >Because entropy coding is used after quantization, uniform quantizers are nearly
optimal. Note that VQ could be used in the subbands, but its complexity is
usually not worthwhile since there is little dependence between coe&#xFB03;cients
anyway.
</p><!--l. 660--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">27   </span> <a 
 id="x1-3800027"></a>2D-DWT</h3>
     <ul class="itemize1">
     <li class="itemize">The one-dimensional &#x0028;1D&#x0029; DWT is a separable transform. Therefore, the
     2D DWT can be computed applying the DWT to all the rows of an image
     and next, to all the columns, or viceversa.</li></ul>
<!--l. 669--><p class="noindent" ><div style="text-align:center;"> <img width=800 src="2D-DWT.svg" /> </div> 
</p>
     <ul class="itemize1">
     <li class="itemize">The contribution of a coe&#xFB03;cient of a subband <!--l. 674--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>b</mi></mrow></math>
     is determined by the DWT basis fuction <!--l. 675--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msup><mrow 
><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>H</mi></mrow></msub 
></mrow><mrow 
><mi 
>b</mi></mrow></msup 
></mrow></math>
     asociated  to  that  coe&#xFB03;cient,  which  can  be  empirically  determined  by
     applying the inverse DWT to the Dirac Impulse function localized in that
     coe&#xFB03;cient &#x0028;notice that <!--l. 678--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msup><mrow 
><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>H</mi></mrow></msub 
></mrow><mrow 
><mi 
>b</mi></mrow></msup 
></mrow></math>
     does  not  depend  on  the  coe&#xFB03;cient  because  we  are  supposing  that  all
     the coe&#xFB03;cients of a subband have the same contribution, the same basis
     fuction&#x0029;&#x00A0;<span class="cite">&#x005B;<span 
class="ecbx-1000">?</span>&#x005D;</span>. Therefore, the L<!--l. 681--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mrow 
></mrow><mrow 
><mn>2</mn></mrow></msub 
></mrow></math>-norm
     for the subband <!--l. 682--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>b</mi></mrow></math>
     is computed as the energy of a basis function of that subband as</li></ul>
   <table class="equation"><tr><td> <a 
 id="x1-38001r31"></a>
<!--l. 686--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                        <mi 
>E</mi><mo 
class="MathClass-open">&#x0028;</mo><msup><mrow 
><msub><mrow 
><mstyle 
class="text"><mtext  >s</mtext></mstyle></mrow><mrow 
><mi 
>H</mi></mrow></msub 
></mrow><mrow 
><mi 
>b</mi></mrow></msup 
><mo 
class="MathClass-close">&#x0029;</mo> <mo 
class="MathClass-rel">=</mo><munder class="msub"><mrow 
><mo  
> &#x2211;</mo>
   </mrow><mrow 
><mi 
>i</mi></mrow></munder 
><msup><mrow 
><mo 
class="MathClass-rel">&#x007C;</mo><msubsup><mrow 
><msub><mrow 
><mstyle 
class="text"><mtext  >s</mtext></mstyle></mrow><mrow 
><mi 
>H</mi></mrow></msub 
></mrow><mrow 
><mi 
>i</mi></mrow><mrow 
><mi 
>b</mi></mrow></msubsup 
><mo 
class="MathClass-rel">&#x007C;</mo></mrow><mrow 
><mn>2</mn></mrow></msup 
><mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">&#x0028;31&#x0029;</td></tr></table>
                                                                  

                                                                  
<!--l. 690--><p class="indent" >   In  the  case  of  the  5/3-DWT,  the
L<!--l. 690--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mrow 
></mrow><mrow 
><mn>2</mn></mrow></msub 
></mrow></math>-norms
of the DWT subbands are: <div style="text-align:center;"> <img width=400 src="factores_5_3_L2_norm.svg" /> </div> 
</p><!--l. 693--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">28   </span> <a 
 id="x1-3900028"></a>Haar &#xFB01;lters&#x00A0;<span class="cite">&#x005B;<a 
href="#Xhaar1910theorie">3</a>&#x005D;</span></h3>
<!--l. 694--><p class="noindent" >The <!--l. 694--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>i</mi></mrow></math>-th
sample of the low-frequency subband is computed &#x0028;using a &#xFB01;lter plus subsampling&#x0029;
as
</p>
   <table class="equation"><tr><td> <a 
 id="x1-39001r32"></a>
<!--l. 697--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                          <msub><mrow 
><mi 
>L</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mfrac><mrow 
><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi><mo 
class="MathClass-bin">+</mo><mn>1</mn></mrow></msub 
></mrow> 
        <mrow 
><mn>2</mn></mrow></mfrac>       <mo 
class="MathClass-punc">,</mo>
                                                                  <mstyle 
   id="x1-39002r31"  class="label" ></mstyle><!--endlabel-->
</math></td><td class="eq-no">&#x0028;HaarL&#x0029;<a 
 id="x1-39003r31"></a></td></tr></table>
<!--l. 703--><p class="indent" >   and the <!--l. 703--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>i</mi></mrow></math>-th
sample of the high-frequency subband as
</p>
   <table class="equation"><tr><td> <a 
 id="x1-39004r32"></a>
<!--l. 705--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                          <msub><mrow 
><mi 
>H</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi><mo 
class="MathClass-bin">+</mo><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-bin">&#x2212;</mo> <msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo>
                                                                  <mstyle 
   id="x1-39005r31"  class="label" ></mstyle><!--endlabel-->
</math></td><td class="eq-no">&#x0028;HaarH&#x0029;<a 
 id="x1-39006r31"></a></td></tr></table>
<!--l. 711--><p class="indent" >   If Lifting is used,
</p>
   <table class="equation"><tr><td> <a 
 id="x1-39007r32"></a>
                                                                  

                                                                  
<!--l. 713--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                           <msub><mrow 
><mi 
>L</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-bin">+</mo> <mfrac><mrow 
><msub><mrow 
><mi 
>H</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></mrow> 
 <mrow 
><mn>2</mn></mrow></mfrac> <mo 
class="MathClass-punc">.</mo>
                                                                  <mstyle 
   id="x1-39008r31"  class="label" ></mstyle><!--endlabel-->
</math></td><td class="eq-no">&#x0028;HaarLLifted&#x0029;<a 
 id="x1-39009r31"></a></td></tr></table>
<!--l. 719--><p class="indent" >   Notice that <!--l. 719--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>H</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mn>0</mn></mrow></math>
if <!--l. 719--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi><mo 
class="MathClass-bin">+</mo><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi></mrow></msub 
></mrow></math>,
therefore, the Haar transform is good to encode constant signals. The notation X/Y
indicates the length &#x0028;taps or number of coe&#xFB03;cients&#x0029; of the low-pass and the
high-pass &#x0028;convolution&#x0029; &#xFB01;lters of the &#xFB01;lter bank implementation &#x0028;not Lifting&#x0029;,
respectively.
</p><!--l. 726--><p class="indent" >   <a 
href="https://nbviewer.jupyter.org/github/vicente-gonzalez-ruiz/image_transformations_for_coding/blob/master/Haar_2d_basis.ipynb" >Haar basis</a>.
</p><!--l. 728--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">29   </span> <a 
 id="x1-4000029"></a>Linear &#x0028;5/3&#x0029; &#xFB01;lters&#x00A0;<span class="cite">&#x005B;<a 
href="#Xsweldens1997building">6</a>&#x005D;</span></h3>
<!--l. 729--><p class="noindent" >The <!--l. 729--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>i</mi></math>-th
sample of the low-frequency subband &#x0028;using a &#xFB01;lter-bank implementation&#x0029;
is
</p>
   <table class="equation"><tr><td> <a 
 id="x1-40001r32"></a>
<!--l. 731--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
            <msub><mrow 
><mi 
>L</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mo 
class="MathClass-bin">&#x2212;</mo><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>8</mn></mrow></mfrac><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>2</mn></mrow></msub 
> <mo 
class="MathClass-bin">+</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>4</mn></mrow></mfrac><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-bin">+</mo> <mfrac><mrow 
><mn>3</mn></mrow> 
<mrow 
><mn>4</mn></mrow></mfrac><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-bin">+</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>4</mn></mrow></mfrac><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi><mo 
class="MathClass-bin">+</mo><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-bin">&#x2212;</mo><mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>8</mn></mrow></mfrac><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi><mo 
class="MathClass-bin">+</mo><mn>2</mn></mrow></msub 
>
                                                                  <mstyle 
   id="x1-40002r31"  class="label" ></mstyle><!--endlabel-->
</math></td><td class="eq-no">&#x0028;5/3L&#x0029;<a 
 id="x1-40003r31"></a></td></tr></table>
<!--l. 738--><p class="indent" >   and the <!--l. 738--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>i</mi></math>-th
sample of the high-frequency signal is computed by
</p>
   <table class="equation"><tr><td> <a 
 id="x1-40004r32"></a>
                                                                  

                                                                  
<!--l. 740--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                      <msub><mrow 
><mi 
>H</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi><mo 
class="MathClass-bin">+</mo><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-bin">&#x2212;</mo><mfrac><mrow 
><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi><mo 
class="MathClass-bin">+</mo><mn>2</mn></mrow></msub 
></mrow> 
        <mrow 
><mn>2</mn></mrow></mfrac>       <mo 
class="MathClass-punc">,</mo>
                                                                  <mstyle 
   id="x1-40005r31"  class="label" ></mstyle><!--endlabel-->
</math></td><td class="eq-no">&#x0028;5/3H&#x0029;<a 
 id="x1-40006r31"></a></td></tr></table>
<!--l. 746--><p class="indent" >   that, if we use Lifting, it can be also computed using less operations
by
</p>
   <table class="equation"><tr><td> <a 
 id="x1-40007r32"></a>
<!--l. 748--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                       <msub><mrow 
><mi 
>L</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-bin">+</mo> <mfrac><mrow 
><msub><mrow 
><mi 
>H</mi></mrow><mrow 
><mi 
>i</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>H</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></mrow> 
      <mrow 
><mn>4</mn></mrow></mfrac>       <mo 
class="MathClass-punc">.</mo>
                                                                  <mstyle 
   id="x1-40008r31"  class="label" ></mstyle><!--endlabel-->
</math></td><td class="eq-no">&#x0028;5/3LLifted&#x0029;<a 
 id="x1-40009r31"></a></td></tr></table>
<!--l. 754--><p class="indent" >   Notice that <!--l. 754--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>H</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mn>0</mn></math>
if <!--l. 754--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi><mo 
class="MathClass-bin">+</mo><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mo 
class="MathClass-open">&#x0028;</mo><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi><mo 
class="MathClass-bin">+</mo><mn>2</mn></mrow></msub 
><mo 
class="MathClass-close">&#x0029;</mo><mo 
class="MathClass-bin">&#x2215;</mo><mn>2</mn></math>.
Therefore, the 5/3 transform is suitable to encode lineally piece-wised signals.
</p><!--l. 756--><p class="indent" >   <a 
href="https://nbviewer.jupyter.org/github/vicente-gonzalez-ruiz/image_transformations_for_coding/blob/master/linear_2d_basis.ipynb" >Linear &#x0028;5/3&#x0029; basis</a>.
</p><!--l. 759--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">30   </span> <a 
 id="x1-4100030"></a>Orthogonal, orthonormal, and biorthogonal transforms</h3>
<!--l. 762--><p class="noindent" >In signal processing<span class="footnote-mark"><a 
href="index2.html#fn1x0"><sup class="textsuperscript">1</sup></a></span><a 
 id="x1-41001f1"></a> ,
a transform &#x0028;such as the <a 
href="https://en.wikipedia.org/wiki/Discrete_cosine_transform" >Discrete Cosine Transform</a>, the <a 
href="https://en.wikipedia.org/wiki/Hadamard_transform" >Walsh-Hadamard Transform</a>
or the <a 
href="https://en.wikipedia.org/wiki/Karhunen%E2%80%93Lo%C3%A8ve_theorem" >Karhunen-Lo&#x00E8;ve Transform</a>&#x0029; is orthogonal when the coe&#xFB03;cients generated by
the transform are uncorrelated &#x0028;there is no way to infer one coe&#xFB03;cient from
another&#x0029;.
                                                                  

                                                                  
</p><!--l. 777--><p class="indent" >   If the <a 
href="https://en.wikipedia.org/wiki/Norm_(mathematics)" >norm</a> of all the basis of an orthogonal transform is one, then the
transform is said <a 
href="https://en.wikipedia.org/wiki/Orthonormal_basis" >orthonormal</a>. Orthonormal transforms are interesting because of
their:
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-41003x1"><a 
href="https://en.wikipedia.org/wiki/Energy_(signal_processing)" ><span 
class="ecbx-1000">Energy</span></a>  <span 
class="ecbx-1000">preservation</span>:  The  energy  of  the  output  is  the  same  than
     the energy of the input. This means that, for example, a quantization
     error produced in a coe&#xFB03;cient of the transform will generate the same
     quantization  error  at  the  output  &#x0028;the  complete  signal&#x0029;  of  the  inverse
     transform. The same holds by the forward transform.
     </li>
     <li 
  class="enumerate" id="x1-41005x2"><span 
class="ecbx-1000">Implementation</span>:  The  transform  matrix  of  the  inverse  transform  is
     the transpose of the forward transform. In orthogonal transforms, the
     transform matrix of the inverse transform is the inverse of the transform
     matrix of the forward transform.</li></ol>
<!--l. 796--><p class="indent" >   Biorthogonal transforms &#x0028;and in particular, <a 
href="https://en.wikipedia.org/wiki/Biorthogonal_wavelet" >biorthogonal wavelets</a>&#x0029; do
no satisfy any of these features: they are not energy preserving &#x0028;this can
be also observed because the frequency-domain responses of the analysis
and synthesis &#xFB01;lters are not symmetric&#x0029;, and there is not an algebraic way
&#x0028;matrix transposition/inversion&#x0029; to compute the backward transform from the
forward one, and viceversa. This, that can be considered as a drawback, gives
an extra degree of freedom to design the analysis and the synthesis &#xFB01;lters
&#x0028;whose only requirement is that transform pair to be reversible&#x0029;, providing in
general the possibility of using more so&#xFB01;sticated &#xFB01;lters such as those based
on non-linear &#xFB01;ltering, as for example, those that use motion estimation
algorithms.
</p><!--l. 810--><p class="indent" >   In general, each subband <!--l. 810--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi></math>
of a decomposition generated by a biorthogonal 2D-DWT transform have a di&#xFB00;erent subband
gain <!--l. 812--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>&#x03B1;</mi></mrow><mrow 
><mi 
>b</mi></mrow></msub 
></math>.
Usually, the lower the frequency of the subband, the higher the gain. Notice also,
that these gains also are di&#xFB00;erent for each transform.
</p><!--l. 816--><p class="indent" >   Subband gains are important in lossy signal compression because they quantify
the relative importance of the wavelet coe&#xFB03;cients of the di&#xFB00;erent subbands when we
introduce distortion in the wavelet domain. Thus, for example, if we decide to
quantize a wavelet coe&#xFB03;cient, the amount of distortion that we are generating in the
signal domain will depend on the subband where that coe&#xFB03;cient is localized. In
general, low-frequency coe&#xFB03;cients are more &#x201C;important&#x201D; that high-frequency
ones.
</p><!--l. 825--><p class="indent" >   To compute the subband gains we have two options:
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-41007x1">The algebraic way. We will need the expressions of the four &#xFB01;lters &#x0028;two
     anaylsis &#xFB01;lters and two synthesis &#xFB01;lters&#x0029; and deduce the gains.
     </li>
     <li 
  class="enumerate" id="x1-41009x2">The algorithmic way. We will need to compute the energy of the impulse response
                                                                  

                                                                  
     of the inverse transform, when we apply such impulse to each one of the
     subbands of the decomposition. Supposing that, after appliying the DWT to an
     image, the coe&#xFB03;cients of the subband HH are the least energetic with an energy
     <!--l. 834--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math>, the subband
     gain for subband <!--l. 835--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi></math>
     is computed as <table class="equation"><tr><td> <a 
 id="x1-41010r32"></a>
     <!--l. 836--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                            <msub><mrow 
><mi 
>&#x03B1;</mi></mrow><mrow 
><mi 
>b</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>b</mi></mrow></msub 
><mo 
class="MathClass-bin">&#x2215;</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo>
</math></td><td class="eq-no">&#x0028;32&#x0029;</td></tr></table>
     <!--l. 839--><p class="noindent" >where <!--l. 839--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>b</mi></mrow></msub 
></math>
     is the energy of the reconstruction when the impulse signal is localized at
     <!--l. 840--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi></math>.
     Notice that all the gains should be larger than one.</p></li></ol>
<!--l. 844--><p class="indent" >   This computation can be also applied to MCDWT, by computing the subband gains as a function
of the number <!--l. 845--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>T</mi></math>
of temporal decompositions.
</p>
   <h3 class="sectionHead"><span class="titlemark">31   </span> <a 
 id="x1-4200031"></a>Quantization in the transform domain</h3>
     <ul class="itemize1">
     <li class="itemize">If the transform is orthogonal, by de&#xFB01;nition coe&#xFB00;s <!--l. 853--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>S</mi><mo 
class="MathClass-open">&#x005B;</mo><mi 
>k</mi><mo 
class="MathClass-close">&#x005D;</mo></mrow></math>
     are uncorrelated. Therefore, a scalar quantizer can performs an optimal
     quantization.</li></ul>
<!--l. 858--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">32   </span> <a 
 id="x1-4300032"></a>Bit-planes progression</h3>
<!--l. 859--><p class="noindent" ><div style="text-align:center;"> <img width=800 src="bit-plane-trans.svg" /> </div> 
                                                                  

                                                                  
</p><!--l. 861--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">32.1   </span> <a 
 id="x1-4400032.1"></a>Bit allocation &#x0028;bit-rate control&#x0029;</h4>
     <ul class="itemize1">
     <li class="itemize">In lossless coding, coe&#xFB00;s <!--l. 864--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>S</mi></mrow><mrow 
><mi 
>u</mi></mrow></msub 
></mrow></math>
     are directly encoded using some text compression algorithm or a combination
     of them.
     </li>
     <li class="itemize">However, in most situations, a lossy compression is needed and in this
     case, a transform coder must determine, given a maximum number of bits
     <!--l. 869--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mover accent="false" 
class="mml-overline"><mrow><mi 
>R</mi></mrow><mo 
accent="true">&#x00AF;</mo></mover></mrow></math>
     &#x0028;which  is  de&#xFB01;ned  by  the  compression  ratio  selected  by  the  user&#x0029;,  the
     number of bits <!--l. 870--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>R</mi><mo 
class="MathClass-open">&#x0028;</mo><mi 
>u</mi><mo 
class="MathClass-close">&#x0029;</mo></mrow></math>
     used by the quantizer for each coe&#xFB00; <!--l. 871--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>S</mi></mrow><mrow 
><mi 
>k</mi></mrow></msub 
></mrow></math>.</li></ul>
<!--l. 874--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">33   </span> <a 
 id="x1-4500033"></a>Bit allocation based on minimizing the quantization error</h3>
     <ul class="itemize1">
     <li class="itemize">In unitary transforms, as a consequence of the energy preserving property,
     an uniform quantization &#x0028;i.e.&#x00A0;the dividing each coe&#xFB00; <!--l. 880--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>S</mi></mrow><mrow 
><mi 
>u</mi></mrow></msub 
></mrow></math>
     by the same quantization step&#x0029; should provide optimal bit allocation if we
     want to minimize the quantization error &#x0028;the distortion&#x0029; in the recostructed
     signal <!--l. 882--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>s</mi></mrow></math>.</li></ul>
<!--l. 885--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">34   </span> <a 
 id="x1-4600034"></a>Bit allocation based on minimizing the variance of the quantization
error</h3>
     <ul class="itemize1">
     <li class="itemize">Lets assume that the variance of the coe&#xFB00;s, de&#xFB01;ned as
     <table class="equation"><tr><td> <a 
 id="x1-46001r33"></a>
                                                                  

                                                                  
     <!--l. 890--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                       <msubsup><mrow 
><mi 
>&#x03C3;</mi></mrow><mrow 
><msub><mrow 
><mi 
>S</mi></mrow><mrow 
><mi 
>u</mi></mrow></msub 
></mrow><mrow 
><mn>2</mn></mrow></msubsup 
> <mo 
class="MathClass-rel">=</mo> <mstyle 
class="text"><mtext  >E</mtext></mstyle><mstyle mathsize="1.19em"><mrow><mo fence="true" form="prefix"> (</mo><mrow></mrow><mo fence="true" form="postfix"></mo></mrow></mstyle><msup><mrow 
><mo 
class="MathClass-open">&#x0028;</mo><msub><mrow 
><mi 
>S</mi></mrow><mrow 
>
<mi 
>u</mi></mrow></msub 
> <mo 
class="MathClass-bin">&#x2212;</mo><mover accent="false" 
class="mml-overline"><mrow><mi 
>S</mi></mrow><mo 
accent="true">&#x00AF;</mo></mover><mo 
class="MathClass-close">&#x0029;</mo></mrow><mrow 
><mn>2</mn></mrow></msup 
><mstyle mathsize="1.19em"><mrow><mo fence="true" form="prefix"> )</mo><mrow></mrow><mo fence="true" form="postfix"></mo></mrow></mstyle>
</math></td><td class="eq-no">&#x0028;33&#x0029;</td></tr></table>
     <!--l. 894--><p class="noindent" >&#x0028;where
</p>
     <table class="equation"><tr><td> <a 
 id="x1-46002r34"></a>
     <!--l. 896--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                 <mover accent="false" 
class="mml-overline"><mrow><mi 
>S</mi></mrow><mo 
accent="true">&#x00AF;</mo></mover> <mo 
class="MathClass-rel">=</mo> <mstyle 
class="text"><mtext  >E</mtext></mstyle><mo 
class="MathClass-open">&#x0028;</mo><mi 
>S</mi><mo 
class="MathClass-close">&#x0029;</mo> <mo 
class="MathClass-rel">=</mo>  <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mi 
>B</mi></mrow></mfrac><munderover accentunder="false" accent="false"><mrow  
><mo  
>&#x2211;</mo>
  </mrow><mrow 
><mi 
>u</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>B</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></munderover 
><msub><mrow 
><mi 
>S</mi></mrow><mrow 
>
<mi 
>u</mi></mrow></msub 
>
</math></td><td class="eq-no">&#x0028;34&#x0029;</td></tr></table>
     <!--l. 900--><p class="noindent" >corresponds to the amount of information provided by each coe&#xFB00;. Therefore,
     coe&#xFB00;s with high variance should be assigned more bits and viceversa.
     </p></li>
     <li class="itemize">Lets de&#xFB01;ne
     <table class="equation"><tr><td> <a 
 id="x1-46003r35"></a>
     <!--l. 906--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                    <mover accent="false" 
class="mml-overline"><mrow><mi 
>R</mi></mrow><mo 
accent="true">&#x00AF;</mo></mover> <mo 
class="MathClass-rel">=</mo>  <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mi 
>B</mi></mrow></mfrac><munderover accentunder="false" accent="false"><mrow  
><mo  
>&#x2211;</mo>
  </mrow><mrow 
><mi 
>u</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>B</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></munderover 
><mi 
>R</mi><mo 
class="MathClass-open">&#x0028;</mo><mi 
>u</mi><mo 
class="MathClass-close">&#x0029;</mo>
                                                                                                       <mstyle 
   id="x1-46004r34"  class="label" ></mstyle><!--endlabel-->
</math></td><td class="eq-no">&#x0028;<!--l. 909--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mover accent="false" 
class="mml-overline"><mrow><mi 
>R</mi></mrow><mo 
accent="true">&#x00AF;</mo></mover></math>&#x0029;<a 
 id="x1-46005r34"></a></td></tr></table>
     <!--l. 911--><p class="noindent" >as the &#x0028;target&#x0029; average number of bits/coe&#xFB00;, where
     <!--l. 911--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>R</mi><mo 
class="MathClass-open">&#x0028;</mo><mi 
>u</mi><mo 
class="MathClass-close">&#x0029;</mo></mrow></math> is the number of bits
     assigned to coe&#xFB00; <!--l. 912--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>S</mi></mrow><mrow 
><mi 
>u</mi></mrow></msub 
></mrow></math>.
                                                                  

                                                                  
     </p></li>
     <li class="itemize">If the mean square error is as a measure of distortion, the
     variance of the distortion generated by the quantization of a coe&#xFB00;
     <!--l. 915--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>S</mi></mrow><mrow 
><mi 
>u</mi></mrow></msub 
></mrow></math>
     <a 
href="http://cdn.intechopen.com/pdfs/16267/InTech-Rate_control_in_video_coding.pdf" >can be modeled</a> by
     <table class="equation"><tr><td> <a 
 id="x1-46006r35"></a>
     <!--l. 919--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                 <msubsup><mrow 
><mi 
>&#x03C3;</mi></mrow><mrow 
><msub><mrow 
><mi 
>S</mi></mrow><mrow 
><mi 
>u</mi></mrow></msub 
><mo 
class="MathClass-bin">&#x2212;</mo><msub><mrow 
><mover 
accent="true"><mrow 
><mi 
>S</mi></mrow><mo accent="true">&#x007E;</mo></mover></mrow><mrow 
><mi 
>u</mi></mrow></msub 
></mrow><mrow 
><mn>2</mn></mrow></msubsup 
> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>&#x03B1;</mi></mrow><mrow 
>
<mi 
>u</mi></mrow></msub 
><msup><mrow 
><mn>2</mn></mrow><mrow 
><mo 
class="MathClass-bin">&#x2212;</mo><mn>2</mn><mi 
>R</mi><mo 
class="MathClass-open">&#x0028;</mo><mi 
>u</mi><mo 
class="MathClass-close">&#x0029;</mo></mrow></msup 
><msubsup><mrow 
><mi 
>&#x03C3;</mi></mrow><mrow 
><msub><mrow 
>
<mi 
>S</mi></mrow><mrow 
><mi 
>u</mi></mrow></msub 
></mrow><mrow 
><mn>2</mn></mrow></msubsup 
><mo 
class="MathClass-punc">,</mo>
</math></td><td class="eq-no">&#x0028;35&#x0029;</td></tr></table>
     <!--l. 923--><p class="noindent" >where <!--l. 923--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>&#x03B1;</mi></mrow><mrow 
><mi 
>u</mi></mrow></msub 
></mrow></math> depends
     on the frequency <!--l. 923--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>u</mi></mrow></math>
     and the quantizer.</p></li></ul>
<!--l. 926--><p class="noindent" ><a 
href="https://nbviewer.jupyter.org/github/vicente-gonzalez-ruiz/image_transformations_for_coding/blob/master/DR_model.ipynb" >DR_model notebook</a>.
</p>
     <ul class="itemize1">
     <li class="itemize">Assuming an additive distorion metric, the total distortion variance for
     <!--l. 931--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>R</mi></mrow><mrow 
><mi 
>k</mi></mrow></msub 
></mrow></math>
     bits/coe&#xFB00; is given by
     <table class="equation"><tr><td> <a 
 id="x1-46007r36"></a>
     <!--l. 933--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
<mi 
>D</mi> <mo 
class="MathClass-rel">=</mo> <msubsup><mrow 
><mi 
>&#x03C3;</mi></mrow><mrow 
><mi 
>S</mi><mo 
class="MathClass-bin">&#x2212;</mo><mover 
accent="true"><mrow 
><mi 
>S</mi></mrow><mo accent="true">&#x007E;</mo></mover></mrow><mrow 
><mn>2</mn></mrow></msubsup 
> <mo 
class="MathClass-rel">=</mo><munderover accentunder="false" accent="false"><mrow  
><mo  
> &#x2211;</mo>
  </mrow><mrow 
><mi 
>u</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>B</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></munderover 
><msubsup><mrow 
><mi 
>&#x03C3;</mi></mrow><mrow 
><msub><mrow 
>
<mi 
>S</mi></mrow><mrow 
><mi 
>u</mi></mrow></msub 
><mo 
class="MathClass-bin">&#x2212;</mo><msub><mrow 
><mover 
accent="true"><mrow 
><mi 
>S</mi></mrow><mo accent="true">&#x007E;</mo></mover></mrow><mrow 
><mi 
>u</mi></mrow></msub 
></mrow><mrow 
><mn>2</mn></mrow></msubsup 
> <mo 
class="MathClass-rel">=</mo><munderover accentunder="false" accent="false"><mrow  
><mo  
> &#x2211;</mo>
  </mrow><mrow 
><mi 
>u</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>B</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></munderover 
><msub><mrow 
><mi 
>&#x03B1;</mi></mrow><mrow 
>
<mi 
>u</mi></mrow></msub 
><msup><mrow 
><mn>2</mn></mrow><mrow 
><mo 
class="MathClass-bin">&#x2212;</mo><mn>2</mn><mi 
>R</mi><mo 
class="MathClass-open">&#x0028;</mo><mi 
>u</mi><mo 
class="MathClass-close">&#x0029;</mo></mrow></msup 
><msubsup><mrow 
><mi 
>&#x03C3;</mi></mrow><mrow 
><msub><mrow 
>
<mi 
>S</mi></mrow><mrow 
><mi 
>u</mi></mrow></msub 
></mrow><mrow 
><mn>2</mn></mrow></msubsup 
> <mo 
class="MathClass-rel">=</mo> <mi 
>&#x03B1;</mi><munderover accentunder="false" accent="false"><mrow  
><mo  
>&#x2211;</mo>
  </mrow><mrow 
><mi 
>u</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>B</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></munderover 
><msup><mrow 
><mn>2</mn></mrow><mrow 
><mo 
class="MathClass-bin">&#x2212;</mo><mn>2</mn><mi 
>R</mi><mo 
class="MathClass-open">&#x0028;</mo><mi 
>u</mi><mo 
class="MathClass-close">&#x0029;</mo></mrow></msup 
><msubsup><mrow 
><mi 
>&#x03C3;</mi></mrow><mrow 
><msub><mrow 
>
<mi 
>S</mi></mrow><mrow 
><mi 
>u</mi></mrow></msub 
></mrow><mrow 
><mn>2</mn></mrow></msubsup 
>
                                                                                                                                <mstyle 
   id="x1-46008r35"  class="label" ></mstyle><!--endlabel-->
</math></td><td class="eq-no">&#x0028;<!--l. 936--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>D</mi></math>&#x0029;<a 
 id="x1-46009r35"></a></td></tr></table>
     <!--l. 936--><p class="noindent" >,
                                                                  

                                                                  
     </p><!--l. 938--><p class="noindent" >supposing that <!--l. 938--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>&#x03B1;</mi></mrow><mrow 
><mi 
>u</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mi 
>&#x03B1;</mi></mrow></math>
     is constant for all coe&#xFB00;s &#x0028;a valid supposition for unitary transforms because the
     quantization error generated in each coe&#xFB00; should be the same if an uniform
     quantizer is used&#x0029;.
     </p></li>
     <li class="itemize">The objective of the bit-allocation process is to &#xFB01;nd the
     <!--l. 944--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msubsup><mrow 
><mo 
class="MathClass-open">&#x007B;</mo><mi 
>R</mi><mo 
class="MathClass-open">&#x0028;</mo><mi 
>u</mi><mo 
class="MathClass-close">&#x0029;</mo><mo 
class="MathClass-close">&#x007D;</mo></mrow><mrow 
><mi 
>u</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>B</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msubsup 
></mrow></math> so that minimize
     <!--l. 944--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>D</mi></mrow></math> subject to
     constraint <!--l. 945--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mover accent="false" 
class="mml-overline"><mrow><mi 
>R</mi></mrow><mo 
accent="true">&#x00AF;</mo></mover></mrow></math>:
     <table class="equation"><tr><td> <a 
 id="x1-46010r36"></a>
     <!--l. 947--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                               <munder><mrow 
><mi class="qopname"> argmin</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--></mrow><mrow 
><msubsup><mrow 
><mo 
class="MathClass-open">&#x007B;</mo><mi 
>R</mi><mo 
class="MathClass-open">&#x0028;</mo><mi 
>u</mi><mo 
class="MathClass-close">&#x0029;</mo><mo 
class="MathClass-close">&#x007D;</mo></mrow><mrow 
><mi 
>u</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>B</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msubsup 
></mrow></munder><mi 
>D</mi><mo 
class="MathClass-punc">,</mo><mstyle 
class="text"><mtext  >s.t.</mtext></mstyle><mi 
>&#x00A0;</mi><mover accent="false" 
class="mml-overline"><mrow><mi 
>R</mi></mrow><mo 
accent="true">&#x00AF;</mo></mover><mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">&#x0028;36&#x0029;</td></tr></table>
     </li>
     <li class="itemize">This is an optimization problem that can be solved using <a 
href="https://en.wikipedia.org/wiki/Lagrange_multiplier" >Lagrange multipliers</a>
     &#x0028;note: the following development is not the &#x201C;standard&#x201D; way of using Lagrenge
     multipliear, but it is equivalent&#x0029;.
     </li>
     <li class="itemize">Lets de&#xFB01;ne the Lagrangian functional
     <table class="equation"><tr><td> <a 
 id="x1-46011r37"></a>
     <!--l. 958--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
<mi 
>J</mi> <mo 
class="MathClass-rel">=</mo> <mi 
>D</mi><mo 
class="MathClass-bin">&#x2212;</mo><mi 
>&#x03BB;</mi><mstyle mathsize="1.61em"><mrow><mo fence="true" form="prefix"> (</mo><mrow></mrow><mo fence="true" form="postfix"></mo></mrow></mstyle><mover accent="false" 
class="mml-overline"><mrow><mi 
>R</mi></mrow><mo 
accent="true">&#x00AF;</mo></mover><mo 
class="MathClass-bin">&#x2212;</mo><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mi 
>B</mi></mrow></mfrac><munderover accentunder="false" accent="false"><mrow  
><mo  
>&#x2211;</mo>
  </mrow><mrow 
><mi 
>u</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>B</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></munderover 
><mi 
>R</mi><mo 
class="MathClass-open">&#x0028;</mo><mi 
>u</mi><mo 
class="MathClass-close">&#x0029;</mo><mstyle mathsize="1.61em"><mrow><mo fence="true" form="prefix"> )</mo><mrow></mrow><mo fence="true" form="postfix"></mo></mrow></mstyle> <mo 
class="MathClass-rel">=</mo> <mi 
>&#x03B1;</mi><munderover accentunder="false" accent="false"><mrow  
><mo  
>&#x2211;</mo>
</mrow><mrow 
><mi 
>u</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>B</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></munderover 
><msup><mrow 
><mn>2</mn></mrow><mrow 
><mo 
class="MathClass-bin">&#x2212;</mo><mn>2</mn><mi 
>R</mi><mo 
class="MathClass-open">&#x0028;</mo><mi 
>u</mi><mo 
class="MathClass-close">&#x0029;</mo></mrow></msup 
><msubsup><mrow 
><mi 
>&#x03C3;</mi></mrow><mrow 
><msub><mrow 
>
<mi 
>S</mi></mrow><mrow 
><mi 
>u</mi></mrow></msub 
></mrow><mrow 
><mn>2</mn></mrow></msubsup 
><mo 
class="MathClass-bin">&#x2212;</mo><mi 
>&#x03BB;</mi><mstyle mathsize="1.61em"><mrow><mo fence="true" form="prefix"> (</mo><mrow></mrow><mo fence="true" form="postfix"></mo></mrow></mstyle><mover accent="false" 
class="mml-overline"><mrow><mi 
>R</mi></mrow><mo 
accent="true">&#x00AF;</mo></mover><mo 
class="MathClass-bin">&#x2212;</mo><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mi 
>B</mi></mrow></mfrac><munderover accentunder="false" accent="false"><mrow  
><mo  
>&#x2211;</mo>
</mrow><mrow 
><mi 
>u</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>B</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></munderover 
><mi 
>R</mi><mo 
class="MathClass-open">&#x0028;</mo><mi 
>u</mi><mo 
class="MathClass-close">&#x0029;</mo><mstyle mathsize="1.61em"><mrow><mo fence="true" form="prefix"> )</mo><mrow></mrow><mo fence="true" form="postfix"></mo></mrow></mstyle><mo 
class="MathClass-punc">,</mo>
</math></td><td class="eq-no">&#x0028;37&#x0029;</td></tr></table>
     </li></ul>
                                                                  

                                                                  
<!--l. 963--><p class="indent" >   which taking
</p>
   <table class="equation"><tr><td> <a 
 id="x1-46012r38"></a>
<!--l. 965--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                              <mfrac><mrow 
><mi 
>&#x2202;</mi><mi 
>J</mi></mrow>
<mrow 
><mi 
>&#x2202;</mi><mi 
>R</mi><mo 
class="MathClass-open">&#x0028;</mo><mi 
>u</mi><mo 
class="MathClass-close">&#x0029;</mo></mrow></mfrac> <mo 
class="MathClass-rel">=</mo> <mn>0</mn>
</math></td><td class="eq-no">&#x0028;38&#x0029;</td></tr></table>
<!--l. 969--><p class="indent" >   produces that
</p>
   <table class="equation"><tr><td> <a 
 id="x1-46013r39"></a>
<!--l. 971--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                  <mi 
>R</mi><mo 
class="MathClass-open">&#x0028;</mo><mi 
>u</mi><mo 
class="MathClass-close">&#x0029;</mo> <mo 
class="MathClass-rel">=</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>2</mn></mrow></mfrac><msub><mrow 
><mi class="qopname">log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--></mrow><mrow 
><mn>2</mn></mrow></msub 
><mstyle mathsize="1.19em"><mrow><mo fence="true" form="prefix"> (</mo><mrow></mrow><mo fence="true" form="postfix"></mo></mrow></mstyle><mn>2</mn><mi 
>&#x03B1;</mi><mi class="qopname">ln</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mn>2</mn><msubsup><mrow 
><mi 
>&#x03C3;</mi></mrow><mrow 
><msub><mrow 
><mi 
>S</mi></mrow><mrow 
><mi 
>u</mi></mrow></msub 
></mrow><mrow 
><mn>2</mn></mrow></msubsup 
><mstyle mathsize="1.19em"><mrow><mo fence="true" form="prefix"> )</mo><mrow></mrow><mo fence="true" form="postfix"></mo></mrow></mstyle> <mo 
class="MathClass-bin">&#x2212;</mo><mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>2</mn></mrow></mfrac><msub><mrow 
><mi class="qopname">log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--></mrow><mrow 
><mn>2</mn></mrow></msub 
><mi 
>&#x03BB;</mi><mo 
class="MathClass-punc">.</mo>
                                                                  <mstyle 
   id="x1-46014r38"  class="label" ></mstyle><!--endlabel-->
</math></td><td class="eq-no">&#x0028;<!--l. 974--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>R</mi><mo 
class="MathClass-open">&#x0028;</mo><mi 
>u</mi><mo 
class="MathClass-close">&#x0029;</mo></math>&#x0029;<a 
 id="x1-46015r38"></a></td></tr></table>
     <ul class="itemize1">
     <li class="itemize">Substituting <!--l. 978--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>R</mi><mo 
class="MathClass-open">&#x0028;</mo><mi 
>u</mi><mo 
class="MathClass-close">&#x0029;</mo></mrow></math>
     in Eq. &#x0028;<!--l. 978--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mover accent="false" 
class="mml-overline"><mrow><mi 
>R</mi></mrow><mo 
accent="true">&#x00AF;</mo></mover></mrow></math>&#x0029;,
     we get that
     <table class="equation"><tr><td> <a 
 id="x1-46016r39"></a>
                                                                  

                                                                  
     <!--l. 980--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                     <mover accent="false" 
class="mml-overline"><mrow><mi 
>R</mi></mrow><mo 
accent="true">&#x00AF;</mo></mover> <mo 
class="MathClass-rel">=</mo>  <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mi 
>B</mi></mrow></mfrac><munderover accentunder="false" accent="false"><mrow  
><mo  
>&#x2211;</mo>
  </mrow><mrow 
><mi 
>u</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>B</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></munderover 
><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>2</mn></mrow></mfrac><msub><mrow 
><mi class="qopname">log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--></mrow><mrow 
><mn>2</mn></mrow></msub 
><mstyle mathsize="1.19em"><mrow><mo fence="true" form="prefix"> (</mo><mrow></mrow><mo fence="true" form="postfix"></mo></mrow></mstyle><mn>2</mn><mi 
>&#x03B1;</mi><mi class="qopname">ln</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mn>2</mn><msubsup><mrow 
><mi 
>&#x03C3;</mi></mrow><mrow 
><msub><mrow 
><mi 
>S</mi></mrow><mrow 
><mi 
>u</mi></mrow></msub 
></mrow><mrow 
><mn>2</mn></mrow></msubsup 
><mstyle mathsize="1.19em"><mrow><mo fence="true" form="prefix"> )</mo><mrow></mrow><mo fence="true" form="postfix"></mo></mrow></mstyle> <mo 
class="MathClass-bin">&#x2212;</mo><mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>2</mn></mrow></mfrac><msub><mrow 
><mi class="qopname">log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--></mrow><mrow 
><mn>2</mn></mrow></msub 
><mi 
>&#x03BB;</mi><mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">&#x0028;39&#x0029;</td></tr></table>
     </li>
     <li class="itemize">Operating
     <table class="equation"><tr><td> <a 
 id="x1-46017r40"></a>
     <!--l. 986--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                           <mi 
>&#x03BB;</mi> <mo 
class="MathClass-rel">=</mo><munderover accentunder="false" accent="false"><mrow  
><mo  
> &#x220F;</mo>
  </mrow><mrow 
><mi 
>u</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>B</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></munderover 
><mroot><mrow 
><mn>2</mn><mi 
>&#x03B1;</mi><mi class="qopname">ln</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mn>2</mn><msubsup><mrow 
><mi 
>&#x03C3;</mi></mrow><mrow 
><msub><mrow 
>
<mi 
>S</mi></mrow><mrow 
><mi 
>u</mi></mrow></msub 
></mrow><mrow 
><mn>2</mn></mrow></msubsup 
></mrow><mrow 
><mi 
>B</mi></mrow></mroot> <mo 
class="MathClass-bin">&#x2212;</mo> <msup><mrow 
><mn>2</mn></mrow><mrow 
><mo 
class="MathClass-bin">&#x2212;</mo><mn>2</mn><mover accent="false" 
class="mml-overline"><mrow><mi 
>R</mi></mrow><mo 
accent="true">&#x00AF;</mo></mover></mrow></msup 
><mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">&#x0028;40&#x0029;</td></tr></table>
     </li>
     <li class="itemize">Substituting <!--l. 990--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03BB;</mi></mrow></math>
     in Eq. &#x0028;<!--l. 990--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>R</mi><mo 
class="MathClass-open">&#x0028;</mo><mi 
>u</mi><mo 
class="MathClass-close">&#x0029;</mo></mrow></math>&#x0029;,
     we obtain the optimal number of bits for each coe&#xFB00;
     <table class="equation"><tr><td> <a 
 id="x1-46018r41"></a>
     <!--l. 993--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                           <mi 
>R</mi><mo 
class="MathClass-open">&#x0028;</mo><mi 
>u</mi><mo 
class="MathClass-close">&#x0029;</mo> <mo 
class="MathClass-rel">=</mo> <mover accent="false" 
class="mml-overline"><mrow><mi 
>R</mi></mrow><mo 
accent="true">&#x00AF;</mo></mover> <mo 
class="MathClass-bin">+</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>2</mn></mrow></mfrac><msub><mrow 
><mi class="qopname">log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--></mrow><mrow 
><mn>2</mn></mrow></msub 
>           <mfrac><mrow 
><msubsup><mrow 
><mi 
>&#x03C3;</mi></mrow><mrow 
><msub><mrow 
><mi 
>S</mi></mrow><mrow 
><mi 
>u</mi></mrow></msub 
></mrow><mrow 
><mn>2</mn></mrow></msubsup 
></mrow> 
<mrow 
><munderover accentunder="false" accent="false"><mrow  
><mo  
> &#x220F;</mo>
  </mrow><mrow 
><mi 
>u</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>B</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></munderover 
><mroot><mrow 
><msubsup><mrow 
><mi 
>&#x03C3;</mi></mrow><mrow 
><msub><mrow 
>
<mi 
>S</mi></mrow><mrow 
><mi 
>u</mi></mrow></msub 
></mrow><mrow 
><mn>2</mn></mrow></msubsup 
></mrow><mrow 
><mi 
>B</mi></mrow></mroot></mrow></mfrac><mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">&#x0028;41&#x0029;</td></tr></table>
     <!--l. 997--><p class="noindent" >which minimizes the variance of the quantization
     error. Notice that this value depends proportionally on
     <!--l. 998--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mover accent="false" 
class="mml-overline"><mrow><mi 
>R</mi></mrow><mo 
accent="true">&#x00AF;</mo></mover></mrow></math>
     &#x0028;the target average bits/coe&#xFB00;&#x0029;, logaritmically on
     <!--l. 999--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>&#x03C3;</mi></mrow><mrow 
><msubsup><mrow 
><mi 
>S</mi></mrow><mrow 
><mi 
>u</mi></mrow><mrow 
><mn>2</mn></mrow></msubsup 
></mrow></msub 
></mrow></math>
     &#x0028;the variance of the coe&#xFB00;&#x0029; and log-inversely on the geometric mean of the
                                                                  

                                                                  
     variances of all coe&#xFB00;s.</p></li></ul>
<!--l. 1004--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">35   </span> <a 
 id="x1-4700035"></a>Encoding</h3>
     <ul class="itemize1">
     <li class="itemize">For DCT, usually ZigZag-RLE followed by 0-order entropy coding.
     </li>
     <li class="itemize">For DWT, tree coding or block-based coding.</li></ul>
<!--l. 1013--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">36   </span> <a 
 id="x1-4800036"></a>Code-stream orderings and scalabilities</h3>
     <ul class="itemize1">
     <li class="itemize">The order in which the DWT coe&#xFB03;cients are decoded determines the type
     of scalability &#x0028;example with 2 qualities and 3 resolutions&#x0029;:</li></ul>
<!--l. 1021--><p class="noindent" ><div style="text-align:center;"> <img width=800 src="orderers-and-scalabilities.svg" /> </div> 
   </p><div class="thebibliography">
   <p class="bibitem" ><span class="biblabel">
 &#x005B;1&#x005D;<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xbarr__image"></a>Iain       Barr.                  Image       processing       with       numpy.
   http://www.degeneratestate.org/posts/2016/Oct/23/image-processing-with-numpy/.
   </p>
   <p class="bibitem" ><span class="biblabel">
 &#x005B;2&#x005D;<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xgouillart__scikit"></a>Emmanuelle     Gouillart.            Scikit-image:     image     processing.
   http://www.scipy-lectures.org/packages/scikit-image/.
   </p>
   <p class="bibitem" ><span class="biblabel">
 &#x005B;3&#x005D;<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xhaar1910theorie"></a>Alfred   Haar.      <a 
href="https://scholar.google.es/scholar?hl=es&as_sdt=0%2C5&q=A.+Haar.+Zur+Theorie+der+orthogolanen+Funktionen-Systeme.+Mathematische+Annalen%2C+69%3A331%E2%80%93371%2C+1910&btnG=" >Zur   theorie   der   orthogonalen   funktionensysteme</a>.
   <span 
class="ecti-1000">Mathematische Annalen</span>, 69&#x0028;3&#x0029;:331&#x2013;371, 1910.
   </p>
   <p class="bibitem" ><span class="biblabel">
 &#x005B;4&#x005D;<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xsolem__programming"></a>Jan&#x00A0;Erik  Solem.     Programming  computer  vision  with  python  by.
   https://www.oreilly.com/library/view/programming-computer-vision/9781449341916/ch01.html.
                                                                  

                                                                  
   </p>
   <p class="bibitem" ><span class="biblabel">
 &#x005B;5&#x005D;<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xsovic2012signal"></a>A.&#x00A0;Sovic and D.&#x00A0;Sersic.  <a 
href="https://scholar.google.es/scholar?hl=en&as_sdt=0%2C5&q=Ana+Sovic+and+Damir+Sersic.+Signal+decomposition+methods+for+reducind+drawbacks+of+the+dwt&btnG=" >Signal Decomposition Methods for Reducind
   Drawbacks of the DWT</a>. <span 
class="ecti-1000">Engineering Review</span>, 32&#x0028;2&#x0029;:70&#x2013;77, 2012.
   </p>
   <p class="bibitem" ><span class="biblabel">
 &#x005B;6&#x005D;<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xsweldens1997building"></a>W.&#x00A0;Sweldens and P.&#x00A0;Schr&#x00F6;der. <a 
href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.54.5600&rep=rep1&type=pdf" >Building Your Own Wavelets at Home</a>.
   <span 
class="ecti-1000">Wavelets in Computer Graphics</span>, 1997.
   </p>
   <p class="bibitem" ><span class="biblabel">
 &#x005B;7&#x005D;<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xvetterli1995wavelets"></a>M.&#x00A0;Vetterli  and  J.&#x00A0;Kova&#x010D;evi&#x0107;.     <a 
href="http://waveletsandsubbandcoding.org/Repository/VetterliKovacevic95_Manuscript.pdf" ><span 
class="ecti-1000">Wavelets  and  Subband  Coding</span></a>.
   Prentice-hall, 1995.
</p>
   </div>
<a 
 id="Q1-1-49"></a>
    
</body></html> 

                                                                  


